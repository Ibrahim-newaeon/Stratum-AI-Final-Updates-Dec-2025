import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as i,f as b}from"./vendor-react-Dz7uKsMg.js";import{t as a,c as u,a8 as v,dg as w,a6 as S}from"./index-BQex3859.js";import"./featureFlagsStore-DvEl_DiZ.js";import{u as o,a as k,b as R}from"./vendor-query-BPt-n81V.js";import{F as f}from"./PlusIcon-ByQcgXHI.js";import{F as P}from"./ShoppingBagIcon-CqEE9YMy.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-motion-CR45sdSp.js";function C({title:t,titleId:r,...n},c){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:c,"aria-labelledby":r},n),t?i.createElement("title",{id:r},t):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m6.75 12-3-3m0 0-3 3m3-3v6m-1.5-15H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const O=i.forwardRef(C),l={getProducts:async t=>(await a.get("/profit/products",{params:t})).data.data,getProduct:async t=>(await a.get(`/profit/products/${t}`)).data.data,createProduct:async t=>(await a.post("/profit/products",t)).data.data,updateProduct:async(t,r)=>(await a.patch(`/profit/products/${t}`,r)).data.data,deleteProduct:async t=>(await a.delete(`/profit/products/${t}`)).data,importProducts:async t=>{const r=new FormData;return r.append("file",t),(await a.post("/profit/products/import",r,{headers:{"Content-Type":"multipart/form-data"}})).data.data},getProductMargins:async t=>(await a.get(`/profit/products/${t}/margins`)).data.data,setProductMargin:async(t,r)=>(await a.post(`/profit/products/${t}/margins`,r)).data.data,getMarginRules:async t=>(await a.get("/profit/margin-rules",{params:t})).data.data,getMarginRule:async t=>(await a.get(`/profit/margin-rules/${t}`)).data.data,createMarginRule:async t=>(await a.post("/profit/margin-rules",t)).data.data,updateMarginRule:async(t,r)=>(await a.patch(`/profit/margin-rules/${t}`,r)).data.data,deleteMarginRule:async t=>(await a.delete(`/profit/margin-rules/${t}`)).data,uploadCOGS:async t=>{const r=new FormData;return r.append("file",t),(await a.post("/profit/cogs/upload",r,{headers:{"Content-Type":"multipart/form-data"}})).data.data},getCOGSUploads:async()=>(await a.get("/profit/cogs/uploads")).data.data,getCOGSUpload:async t=>(await a.get(`/profit/cogs/uploads/${t}`)).data.data,getDailyProfitMetrics:async t=>(await a.get("/profit/metrics/daily",{params:t})).data.data,getProfitSummary:async t=>(await a.get("/profit/metrics/summary",{params:t})).data.data,generateProfitReport:async t=>(await a.post("/profit/reports/generate",t)).data.data,getProfitReports:async()=>(await a.get("/profit/reports")).data.data,getProfitReport:async t=>(await a.get(`/profit/reports/${t}`)).data.data,calculateTrueROAS:async t=>(await a.get("/profit/true-roas",{params:t})).data.data};function F(t){return o({queryKey:["profit","products",t],queryFn:()=>l.getProducts(t)})}function A(t){return o({queryKey:["profit","margin-rules",t],queryFn:()=>l.getMarginRules(t)})}function $(){const t=k();return R({mutationFn:l.uploadCOGS,onSuccess:()=>{t.invalidateQueries({queryKey:["profit"]})}})}function M(){return o({queryKey:["profit","cogs","uploads"],queryFn:l.getCOGSUploads})}function D(t){return o({queryKey:["profit","metrics","summary",t],queryFn:()=>l.getProfitSummary(t),enabled:!!t.startDate&&!!t.endDate})}function T(t){return o({queryKey:["profit","true-roas",t],queryFn:()=>l.calculateTrueROAS(t),enabled:!!t.startDate&&!!t.endDate})}function Q(){b();const[t,r]=i.useState("overview"),[n]=i.useState({startDate:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0]}),{data:c}=F(),{data:x}=A(),{data:d}=D(n),{data:m}=T(n),{data:p}=M(),j=$(),y=[{id:"overview",label:"Overview"},{id:"products",label:"Products"},{id:"margins",label:"Margin Rules"},{id:"cogs",label:"COGS Upload"}],N=s=>{var g;const h=(g=s.target.files)==null?void 0:g[0];h&&j.mutate(h)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Profit ROAS"}),e.jsx("p",{className:"text-muted-foreground",children:"Track true profitability with COGS, margins, and profit-based ROAS"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90",children:[e.jsx(f,{className:"h-4 w-4"}),"Add Product"]})]}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex gap-4",children:y.map(s=>e.jsx("button",{onClick:()=>r(s.id),className:u("px-4 py-2 border-b-2 font-medium text-sm transition-colors",t===s.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:s.label},s.id))})}),t==="overview"&&e.jsxs("div",{className:"space-y-6",children:[m&&e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"ROAS Comparison"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 rounded-lg bg-muted/50",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Standard ROAS"}),e.jsxs("p",{className:"text-4xl font-bold",children:[m.standardRoas.toFixed(2),"x"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Revenue / Ad Spend"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-primary/10 border-2 border-primary",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"True ROAS"}),e.jsxs("p",{className:"text-4xl font-bold text-primary",children:[m.trueRoas.toFixed(2),"x"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Gross Profit / Ad Spend"})]}),e.jsxs("div",{className:"text-center p-4 rounded-lg bg-emerald-50 dark:bg-emerald-900/20",children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-1",children:"Profit ROAS"}),e.jsxs("p",{className:"text-4xl font-bold text-emerald-600",children:[m.profitRoas.toFixed(2),"x"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Net Profit / Ad Spend"})]})]})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:e.jsx(v,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Revenue"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",d.totalRevenue.toLocaleString()]})]})]})}),e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-amber-100 dark:bg-amber-900/20",children:e.jsx(P,{className:"h-5 w-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total COGS"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",d.totalCogs.toLocaleString()]})]})]})}),e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/20",children:e.jsx(w,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Gross Profit"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",d.grossProfit.toLocaleString()]})]})]})}),e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/20",children:e.jsx(S,{className:"h-5 w-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Net Profit"}),e.jsxs("p",{className:"text-2xl font-bold",children:["$",d.netProfit.toLocaleString()]})]})]})})]}),d&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Gross Margin"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-full h-full -rotate-90",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",className:"text-muted"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",strokeDasharray:`${d.grossMarginPct/100*351.86} 351.86`,className:"text-primary"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold",children:[d.grossMarginPct.toFixed(1),"%"]})})]})})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:[e.jsx("h3",{className:"font-medium mb-4",children:"Net Margin"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-full h-full -rotate-90",children:[e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",className:"text-muted"}),e.jsx("circle",{cx:"64",cy:"64",r:"56",stroke:"currentColor",strokeWidth:"12",fill:"none",strokeDasharray:`${d.netMarginPct/100*351.86} 351.86`,className:"text-emerald-500"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold",children:[d.netMarginPct.toFixed(1),"%"]})})]})})]})]})]}),t==="products"&&e.jsx("div",{className:"rounded-xl border bg-card shadow-card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"SKU"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Category"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"COGS"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Margin %"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:c==null?void 0:c.items.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"font-medium",children:s.name}),s.brand&&e.jsx("p",{className:"text-sm text-muted-foreground",children:s.brand})]}),e.jsx("td",{className:"px-4 py-3 text-sm font-mono",children:s.sku}),e.jsx("td",{className:"px-4 py-3 text-sm",children:s.category||"-"}),e.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:[s.currency," ",s.defaultCogs.toFixed(2)]}),e.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:[s.defaultMarginPct.toFixed(1),"%"]}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:u("px-2 py-1 rounded-full text-xs",s.status==="active"&&"bg-emerald-100 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300",s.status==="inactive"&&"bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-300",s.status==="discontinued"&&"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300"),children:s.status})})]},s.id))})]})}),t==="margins"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg border hover:bg-muted",children:[e.jsx(f,{className:"h-4 w-4"}),"Add Rule"]})}),e.jsx("div",{className:"rounded-xl border bg-card shadow-card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Rule Name"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Applies To"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Margin Type"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Value"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Priority"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:x==null?void 0:x.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"font-medium",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-muted-foreground truncate max-w-xs",children:s.description})]}),e.jsx("td",{className:"px-4 py-3 text-sm capitalize",children:s.appliesTo}),e.jsx("td",{className:"px-4 py-3 text-sm capitalize",children:s.marginType}),e.jsx("td",{className:"px-4 py-3 text-right font-medium",children:s.marginType==="percentage"?`${s.marginValue}%`:`$${s.marginValue}`}),e.jsx("td",{className:"px-4 py-3 text-center",children:s.priority}),e.jsx("td",{className:"px-4 py-3 text-center",children:s.isActive?e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-emerald-100 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300",children:"Active"}):e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-300",children:"Inactive"})})]},s.id))})]})})]}),t==="cogs"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border border-dashed bg-card p-12 text-center",children:[e.jsx(O,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("h3",{className:"font-medium mb-2",children:"Upload COGS Data"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Upload a CSV file with SKU and COGS columns to update product costs"}),e.jsxs("label",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 cursor-pointer",children:[e.jsx("input",{type:"file",accept:".csv",onChange:N,className:"hidden"}),"Choose File"]})]}),e.jsxs("div",{className:"rounded-xl border bg-card shadow-card overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsx("h3",{className:"font-medium",children:"Upload History"})}),e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Filename"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Uploaded"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Rows"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Success"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Errors"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-medium",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y",children:p==null?void 0:p.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:s.filename}),e.jsx("td",{className:"px-4 py-3 text-sm",children:new Date(s.uploadedAt).toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-right",children:s.rowCount}),e.jsx("td",{className:"px-4 py-3 text-right text-emerald-600",children:s.successCount}),e.jsx("td",{className:"px-4 py-3 text-right text-red-600",children:s.errorCount}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx("span",{className:u("px-2 py-1 rounded-full text-xs",s.status==="completed"&&"bg-emerald-100 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300",s.status==="processing"&&"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300",s.status==="failed"&&"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300",s.status==="pending"&&"bg-gray-100 dark:bg-gray-900/20 text-gray-700 dark:text-gray-300"),children:s.status})})]},s.id))})]})]})]})]})}export{Q as default};
//# sourceMappingURL=ProfitROAS-D53uVqS4.js.map
