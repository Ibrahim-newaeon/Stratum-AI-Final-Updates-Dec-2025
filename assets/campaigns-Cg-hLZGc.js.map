{"version":3,"file":"campaigns-Cg-hLZGc.js","sources":["../../src/api/campaigns.ts"],"sourcesContent":["/**\r\n * Stratum AI - Campaigns API\r\n *\r\n * Campaign management endpoints for CRUD operations and metrics\r\n */\r\n\r\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient, ApiResponse, PaginatedResponse } from './client';\r\n\r\n// Types\r\nexport type Platform = 'meta' | 'google' | 'tiktok' | 'snapchat';\r\nexport type CampaignStatus = 'active' | 'paused' | 'completed' | 'draft' | 'error';\r\nexport type CampaignObjective = 'awareness' | 'consideration' | 'conversion';\r\n\r\nexport interface Campaign {\r\n  id: string;\r\n  tenantId: number;\r\n  platform: Platform;\r\n  platformCampaignId: string;\r\n  name: string;\r\n  status: CampaignStatus;\r\n  objective: CampaignObjective;\r\n  budget: number;\r\n  dailyBudget: number | null;\r\n  currency: string;\r\n  startDate: string;\r\n  endDate: string | null;\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  lastSyncedAt: string | null;\r\n}\r\n\r\nexport interface CampaignMetrics {\r\n  campaignId: string;\r\n  date: string;\r\n  spend: number;\r\n  impressions: number;\r\n  clicks: number;\r\n  conversions: number;\r\n  revenue: number;\r\n  roas: number;\r\n  ctr: number;\r\n  cpc: number;\r\n  cpa: number;\r\n  reach: number | null;\r\n  frequency: number | null;\r\n}\r\n\r\nexport interface CampaignWithMetrics extends Campaign {\r\n  metrics: CampaignMetrics;\r\n  previousMetrics?: CampaignMetrics;\r\n}\r\n\r\nexport interface CampaignFilters {\r\n  platform?: Platform;\r\n  status?: CampaignStatus;\r\n  objective?: CampaignObjective;\r\n  startDate?: string;\r\n  endDate?: string;\r\n  search?: string;\r\n  skip?: number;\r\n  limit?: number;\r\n}\r\n\r\nexport interface CreateCampaignRequest {\r\n  platform: Platform;\r\n  name: string;\r\n  objective: CampaignObjective;\r\n  budget: number;\r\n  dailyBudget?: number;\r\n  currency?: string;\r\n  startDate: string;\r\n  endDate?: string;\r\n  targeting?: Record<string, unknown>;\r\n  creatives?: string[];\r\n}\r\n\r\nexport interface UpdateCampaignRequest {\r\n  name?: string;\r\n  status?: CampaignStatus;\r\n  budget?: number;\r\n  dailyBudget?: number;\r\n  endDate?: string;\r\n  targeting?: Record<string, unknown>;\r\n}\r\n\r\n// API Functions\r\nexport const campaignsApi = {\r\n  /**\r\n   * Get all campaigns with optional filters\r\n   */\r\n  getCampaigns: async (\r\n    filters: CampaignFilters = {}\r\n  ): Promise<PaginatedResponse<CampaignWithMetrics>> => {\r\n    const response = await apiClient.get<ApiResponse<PaginatedResponse<CampaignWithMetrics>>>(\r\n      '/campaigns',\r\n      { params: filters }\r\n    );\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Get a single campaign by ID\r\n   */\r\n  getCampaign: async (id: string): Promise<CampaignWithMetrics> => {\r\n    const response = await apiClient.get<ApiResponse<CampaignWithMetrics>>(`/campaigns/${id}`);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Create a new campaign\r\n   */\r\n  createCampaign: async (data: CreateCampaignRequest): Promise<Campaign> => {\r\n    const response = await apiClient.post<ApiResponse<Campaign>>('/campaigns', data);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Update an existing campaign\r\n   */\r\n  updateCampaign: async (id: string, data: UpdateCampaignRequest): Promise<Campaign> => {\r\n    const response = await apiClient.patch<ApiResponse<Campaign>>(`/campaigns/${id}`, data);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Delete a campaign\r\n   */\r\n  deleteCampaign: async (id: string): Promise<void> => {\r\n    await apiClient.delete(`/campaigns/${id}`);\r\n  },\r\n\r\n  /**\r\n   * Get campaign metrics\r\n   */\r\n  getCampaignMetrics: async (\r\n    id: string,\r\n    startDate: string,\r\n    endDate: string,\r\n    granularity: 'day' | 'week' | 'month' = 'day'\r\n  ): Promise<CampaignMetrics[]> => {\r\n    const response = await apiClient.get<ApiResponse<CampaignMetrics[]>>(\r\n      `/campaigns/${id}/metrics`,\r\n      { params: { start_date: startDate, end_date: endDate, granularity } }\r\n    );\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Sync campaign from platform\r\n   */\r\n  syncCampaign: async (id: string): Promise<Campaign> => {\r\n    const response = await apiClient.post<ApiResponse<Campaign>>(`/campaigns/${id}/sync`);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Bulk update campaign status\r\n   */\r\n  bulkUpdateStatus: async (ids: string[], status: CampaignStatus): Promise<Campaign[]> => {\r\n    const response = await apiClient.post<ApiResponse<Campaign[]>>('/campaigns/bulk/status', {\r\n      ids,\r\n      status,\r\n    });\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Pause a campaign\r\n   */\r\n  pauseCampaign: async (id: string): Promise<Campaign> => {\r\n    const response = await apiClient.post<ApiResponse<Campaign>>(`/campaigns/${id}/pause`);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Activate a campaign\r\n   */\r\n  activateCampaign: async (id: string): Promise<Campaign> => {\r\n    const response = await apiClient.post<ApiResponse<Campaign>>(`/campaigns/${id}/activate`);\r\n    return response.data.data;\r\n  },\r\n};\r\n\r\n// React Query Hooks\r\n\r\nexport function useCampaigns(filters: CampaignFilters = {}) {\r\n  return useQuery({\r\n    queryKey: ['campaigns', filters],\r\n    queryFn: () => campaignsApi.getCampaigns(filters),\r\n    staleTime: 30 * 1000,\r\n  });\r\n}\r\n\r\nexport function useCampaign(id: string) {\r\n  return useQuery({\r\n    queryKey: ['campaigns', id],\r\n    queryFn: () => campaignsApi.getCampaign(id),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function useCreateCampaign() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: campaignsApi.createCampaign,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns'] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useUpdateCampaign() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: UpdateCampaignRequest }) =>\r\n      campaignsApi.updateCampaign(id, data),\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns'] });\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns', variables.id] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useDeleteCampaign() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: campaignsApi.deleteCampaign,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns'] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useCampaignMetrics(\r\n  id: string,\r\n  startDate: string,\r\n  endDate: string,\r\n  granularity: 'day' | 'week' | 'month' = 'day'\r\n) {\r\n  return useQuery({\r\n    queryKey: ['campaigns', id, 'metrics', startDate, endDate, granularity],\r\n    queryFn: () => campaignsApi.getCampaignMetrics(id, startDate, endDate, granularity),\r\n    enabled: !!id && !!startDate && !!endDate,\r\n  });\r\n}\r\n\r\nexport function useSyncCampaign() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: campaignsApi.syncCampaign,\r\n    onSuccess: (_, id) => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns', id] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useBulkUpdateCampaignStatus() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ ids, status }: { ids: string[]; status: CampaignStatus }) =>\r\n      campaignsApi.bulkUpdateStatus(ids, status),\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns'] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function usePauseCampaign() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: campaignsApi.pauseCampaign,\r\n    onSuccess: (_, id) => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns'] });\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns', id] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useActivateCampaign() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: campaignsApi.activateCampaign,\r\n    onSuccess: (_, id) => {\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns'] });\r\n      queryClient.invalidateQueries({ queryKey: ['campaigns', id] });\r\n    },\r\n  });\r\n}\r\n"],"names":["campaignsApi","filters","apiClient","id","data","startDate","endDate","granularity","ids","status","useCampaigns","useQuery","useDeleteCampaign","queryClient","useQueryClient","useMutation","usePauseCampaign","_","useActivateCampaign"],"mappings":"qGAuFO,MAAMA,EAAe,CAI1B,aAAc,MACZC,EAA2B,MAEV,MAAMC,EAAU,IAC/B,aACA,CAAE,OAAQD,CAAA,CAAQ,GAEJ,KAAK,KAMvB,YAAa,MAAOE,IACD,MAAMD,EAAU,IAAsC,cAAcC,CAAE,EAAE,GACzE,KAAK,KAMvB,eAAgB,MAAOC,IACJ,MAAMF,EAAU,KAA4B,aAAcE,CAAI,GAC/D,KAAK,KAMvB,eAAgB,MAAOD,EAAYC,KAChB,MAAMF,EAAU,MAA6B,cAAcC,CAAE,GAAIC,CAAI,GACtE,KAAK,KAMvB,eAAgB,MAAOD,GAA8B,CACnD,MAAMD,EAAU,OAAO,cAAcC,CAAE,EAAE,CAC3C,EAKA,mBAAoB,MAClBA,EACAE,EACAC,EACAC,EAAwC,SAEvB,MAAML,EAAU,IAC/B,cAAcC,CAAE,WAChB,CAAE,OAAQ,CAAE,WAAYE,EAAW,SAAUC,EAAS,YAAAC,EAAY,CAAE,GAEtD,KAAK,KAMvB,aAAc,MAAOJ,IACF,MAAMD,EAAU,KAA4B,cAAcC,CAAE,OAAO,GACpE,KAAK,KAMvB,iBAAkB,MAAOK,EAAeC,KACrB,MAAMP,EAAU,KAA8B,yBAA0B,CACvF,IAAAM,EACA,OAAAC,CAAA,CACD,GACe,KAAK,KAMvB,cAAe,MAAON,IACH,MAAMD,EAAU,KAA4B,cAAcC,CAAE,QAAQ,GACrE,KAAK,KAMvB,iBAAkB,MAAOA,IACN,MAAMD,EAAU,KAA4B,cAAcC,CAAE,WAAW,GACxE,KAAK,IAEzB,EAIO,SAASO,EAAaT,EAA2B,GAAI,CAC1D,OAAOU,EAAS,CACd,SAAU,CAAC,YAAaV,CAAO,EAC/B,QAAS,IAAMD,EAAa,aAAaC,CAAO,EAChD,UAAW,GAAK,GAAA,CACjB,CACH,CAkCO,SAASW,GAAoB,CAClC,MAAMC,EAAcC,EAAA,EAEpB,OAAOC,EAAY,CACjB,WAAYf,EAAa,eACzB,UAAW,IAAM,CACfa,EAAY,kBAAkB,CAAE,SAAU,CAAC,WAAW,EAAG,CAC3D,CAAA,CACD,CACH,CAsCO,SAASG,GAAmB,CACjC,MAAMH,EAAcC,EAAA,EAEpB,OAAOC,EAAY,CACjB,WAAYf,EAAa,cACzB,UAAW,CAACiB,EAAGd,IAAO,CACpBU,EAAY,kBAAkB,CAAE,SAAU,CAAC,WAAW,EAAG,EACzDA,EAAY,kBAAkB,CAAE,SAAU,CAAC,YAAaV,CAAE,EAAG,CAC/D,CAAA,CACD,CACH,CAEO,SAASe,GAAsB,CACpC,MAAML,EAAcC,EAAA,EAEpB,OAAOC,EAAY,CACjB,WAAYf,EAAa,iBACzB,UAAW,CAACiB,EAAGd,IAAO,CACpBU,EAAY,kBAAkB,CAAE,SAAU,CAAC,WAAW,EAAG,EACzDA,EAAY,kBAAkB,CAAE,SAAU,CAAC,YAAaV,CAAE,EAAG,CAC/D,CAAA,CACD,CACH"}