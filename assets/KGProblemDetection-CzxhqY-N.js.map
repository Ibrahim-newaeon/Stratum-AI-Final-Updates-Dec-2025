{"version":3,"file":"KGProblemDetection-CzxhqY-N.js","sources":["../../src/components/shared/ProblemCard.tsx","../../src/views/knowledge-graph/KGProblemDetection.tsx"],"sourcesContent":["/**\r\n * ProblemCard - Color-coded problem display card\r\n *\r\n * Used in KG Problem Detection view to show detected issues\r\n * with severity indicator, impact badge, and action buttons.\r\n */\r\n\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n  ExclamationTriangleIcon,\r\n  ExclamationCircleIcon,\r\n  InformationCircleIcon,\r\n  CheckCircleIcon,\r\n} from '@heroicons/react/24/outline';\r\n\r\nexport type ProblemSeverity = 'critical' | 'warning' | 'info';\r\n\r\ninterface ProblemCardProps {\r\n  severity: ProblemSeverity;\r\n  title: string;\r\n  description: string;\r\n  impact: string;\r\n  affectedCampaigns: number;\r\n  platform: string;\r\n  onResolve?: () => void;\r\n  onReview?: () => void;\r\n  resolved?: boolean;\r\n}\r\n\r\nconst severityConfig = {\r\n  critical: {\r\n    borderColor: 'border-l-red-500',\r\n    bgColor: 'bg-red-500/5',\r\n    iconColor: 'text-red-500',\r\n    badgeColor: 'bg-red-500/10 text-red-500 border-red-500/20',\r\n    Icon: ExclamationCircleIcon,\r\n    label: 'Critical',\r\n  },\r\n  warning: {\r\n    borderColor: 'border-l-amber-500',\r\n    bgColor: 'bg-amber-500/5',\r\n    iconColor: 'text-amber-500',\r\n    badgeColor: 'bg-amber-500/10 text-amber-500 border-amber-500/20',\r\n    Icon: ExclamationTriangleIcon,\r\n    label: 'Warning',\r\n  },\r\n  info: {\r\n    borderColor: 'border-l-blue-500',\r\n    bgColor: 'bg-blue-500/5',\r\n    iconColor: 'text-blue-500',\r\n    badgeColor: 'bg-blue-500/10 text-blue-500 border-blue-500/20',\r\n    Icon: InformationCircleIcon,\r\n    label: 'Info',\r\n  },\r\n};\r\n\r\nexport function ProblemCard({\r\n  severity,\r\n  title,\r\n  description,\r\n  impact,\r\n  affectedCampaigns,\r\n  platform,\r\n  onResolve,\r\n  onReview,\r\n  resolved,\r\n}: ProblemCardProps) {\r\n  const config = severityConfig[severity];\r\n  const Icon = config.Icon;\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        'rounded-xl border border-l-4 p-5 transition-all',\r\n        config.borderColor,\r\n        config.bgColor,\r\n        resolved && 'opacity-60'\r\n      )}\r\n    >\r\n      <div className=\"flex items-start justify-between gap-4\">\r\n        <div className=\"flex items-start gap-3 flex-1\">\r\n          <Icon className={cn('h-6 w-6 mt-0.5 flex-shrink-0', config.iconColor)} />\r\n          <div className=\"flex-1 min-w-0\">\r\n            <div className=\"flex items-center gap-2 mb-1\">\r\n              <h3 className=\"font-semibold\">{title}</h3>\r\n              <span\r\n                className={cn(\r\n                  'px-2 py-0.5 rounded-full text-xs font-medium border',\r\n                  config.badgeColor\r\n                )}\r\n              >\r\n                {config.label}\r\n              </span>\r\n              {resolved && (\r\n                <span className=\"px-2 py-0.5 rounded-full text-xs font-medium bg-green-500/10 text-green-500 border border-green-500/20 flex items-center gap-1\">\r\n                  <CheckCircleIcon className=\"h-3 w-3\" />\r\n                  Resolved\r\n                </span>\r\n              )}\r\n            </div>\r\n            <p className=\"text-sm text-muted-foreground mb-3\">{description}</p>\r\n            <div className=\"flex items-center gap-4 text-sm\">\r\n              <span className=\"font-medium text-red-400\">{impact} impact</span>\r\n              <span className=\"text-muted-foreground\">\r\n                {affectedCampaigns} campaign{affectedCampaigns !== 1 ? 's' : ''} affected\r\n              </span>\r\n              <span className=\"px-2 py-0.5 rounded bg-white/5 text-xs\">{platform}</span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {!resolved && (\r\n          <div className=\"flex items-center gap-2 flex-shrink-0\">\r\n            {severity === 'critical' && onResolve && (\r\n              <button\r\n                onClick={onResolve}\r\n                className=\"px-4 py-2 text-sm font-medium rounded-lg bg-red-500 text-white hover:bg-red-600 transition-colors\"\r\n              >\r\n                Resolve\r\n              </button>\r\n            )}\r\n            {onReview && (\r\n              <button\r\n                onClick={onReview}\r\n                className=\"px-4 py-2 text-sm font-medium rounded-lg border border-white/10 hover:bg-white/5 transition-colors\"\r\n              >\r\n                Review\r\n              </button>\r\n            )}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ProblemCard;\r\n","/**\r\n * KG Problem Detection - Knowledge Graph problem detection view\r\n *\r\n * Displays detected problems across campaigns with severity levels,\r\n * impact estimates, and resolution actions.\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport { Helmet } from 'react-helmet-async';\r\nimport { motion } from 'framer-motion';\r\nimport {\r\n  ExclamationCircleIcon,\r\n  ExclamationTriangleIcon,\r\n  CheckCircleIcon,\r\n  CurrencyDollarIcon,\r\n  FunnelIcon,\r\n} from '@heroicons/react/24/outline';\r\nimport { cn } from '@/lib/utils';\r\nimport { useKGProblems, useResolveKGProblem, type ProblemSeverity } from '@/api/knowledgeGraph';\r\nimport { ProblemCard } from '@/components/shared/ProblemCard';\r\n\r\nconst fadeIn = {\r\n  initial: { opacity: 0, y: 12 },\r\n  animate: { opacity: 1, y: 0 },\r\n  transition: { duration: 0.3 },\r\n};\r\n\r\nexport default function KGProblemDetection() {\r\n  const [severityFilter, setSeverityFilter] = useState<ProblemSeverity | 'all'>('all');\r\n\r\n  const { data, isLoading } = useKGProblems(\r\n    severityFilter !== 'all' ? { severity: severityFilter } : undefined\r\n  );\r\n  const resolveMutation = useResolveKGProblem();\r\n\r\n  const summary = data?.summary;\r\n  const problems = data?.problems || [];\r\n\r\n  const filteredProblems =\r\n    severityFilter === 'all'\r\n      ? problems\r\n      : problems.filter((p) => p.severity === severityFilter);\r\n\r\n  const handleResolve = (problemId: string) => {\r\n    resolveMutation.mutate(problemId);\r\n  };\r\n\r\n  const metricCards = [\r\n    {\r\n      label: 'Critical Issues',\r\n      value: summary?.critical ?? 0,\r\n      icon: ExclamationCircleIcon,\r\n      color: 'text-red-500',\r\n      bgColor: 'bg-red-500/10',\r\n      borderColor: 'border-red-500/20',\r\n    },\r\n    {\r\n      label: 'Warnings',\r\n      value: summary?.warnings ?? 0,\r\n      icon: ExclamationTriangleIcon,\r\n      color: 'text-amber-500',\r\n      bgColor: 'bg-amber-500/10',\r\n      borderColor: 'border-amber-500/20',\r\n    },\r\n    {\r\n      label: 'Resolved (30d)',\r\n      value: summary?.resolved30d ?? 0,\r\n      icon: CheckCircleIcon,\r\n      color: 'text-green-500',\r\n      bgColor: 'bg-green-500/10',\r\n      borderColor: 'border-green-500/20',\r\n    },\r\n    {\r\n      label: 'Revenue at Risk',\r\n      value: `$${((summary?.revenueAtRisk ?? 0) / 1000).toFixed(1)}k`,\r\n      icon: CurrencyDollarIcon,\r\n      color: 'text-red-400',\r\n      bgColor: 'bg-red-500/10',\r\n      borderColor: 'border-red-500/20',\r\n    },\r\n  ];\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"flex items-center justify-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-primary\" />\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Helmet>\r\n        <title>Problem Detection - Knowledge Graph | Stratum AI</title>\r\n      </Helmet>\r\n\r\n      <div className=\"space-y-6 max-w-7xl mx-auto\">\r\n        {/* Header */}\r\n        <motion.div {...fadeIn}>\r\n          <h1 className=\"text-2xl font-bold\">Problem Detection</h1>\r\n          <p className=\"text-muted-foreground\">\r\n            AI-detected issues across your campaigns with revenue impact estimates\r\n          </p>\r\n        </motion.div>\r\n\r\n        {/* Metric Cards */}\r\n        <motion.div\r\n          className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4\"\r\n          {...fadeIn}\r\n          transition={{ delay: 0.1 }}\r\n        >\r\n          {metricCards.map((card) => (\r\n            <div\r\n              key={card.label}\r\n              className={cn(\r\n                'rounded-xl border p-4 backdrop-blur-sm',\r\n                card.borderColor,\r\n                card.bgColor\r\n              )}\r\n            >\r\n              <div className=\"flex items-center gap-3\">\r\n                <div className={cn('p-2 rounded-lg', card.bgColor)}>\r\n                  <card.icon className={cn('h-5 w-5', card.color)} />\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-xs text-muted-foreground\">{card.label}</p>\r\n                  <p className={cn('text-xl font-bold', card.color)}>{card.value}</p>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </motion.div>\r\n\r\n        {/* Filter Bar */}\r\n        <motion.div\r\n          className=\"flex items-center gap-3\"\r\n          {...fadeIn}\r\n          transition={{ delay: 0.15 }}\r\n        >\r\n          <FunnelIcon className=\"h-4 w-4 text-muted-foreground\" />\r\n          <span className=\"text-sm text-muted-foreground\">Filter:</span>\r\n          {(['all', 'critical', 'warning', 'info'] as const).map((filter) => (\r\n            <button\r\n              key={filter}\r\n              onClick={() => setSeverityFilter(filter)}\r\n              className={cn(\r\n                'px-3 py-1.5 text-sm rounded-lg transition-colors capitalize',\r\n                severityFilter === filter\r\n                  ? 'bg-primary/10 text-primary font-medium'\r\n                  : 'hover:bg-white/5 text-muted-foreground'\r\n              )}\r\n            >\r\n              {filter === 'all' ? 'All Issues' : filter}\r\n            </button>\r\n          ))}\r\n        </motion.div>\r\n\r\n        {/* Problem Cards */}\r\n        <motion.div\r\n          className=\"space-y-4\"\r\n          {...fadeIn}\r\n          transition={{ delay: 0.2 }}\r\n        >\r\n          {filteredProblems.length === 0 ? (\r\n            <div className=\"text-center py-12 text-muted-foreground\">\r\n              <CheckCircleIcon className=\"h-12 w-12 mx-auto mb-3 text-green-500\" />\r\n              <p className=\"font-medium\">No issues found</p>\r\n              <p className=\"text-sm\">All campaigns are running smoothly</p>\r\n            </div>\r\n          ) : (\r\n            filteredProblems.map((problem) => (\r\n              <ProblemCard\r\n                key={problem.id}\r\n                severity={problem.severity}\r\n                title={problem.title}\r\n                description={problem.description}\r\n                impact={problem.impact}\r\n                affectedCampaigns={problem.affectedCampaigns}\r\n                platform={problem.platform}\r\n                resolved={problem.status === 'resolved'}\r\n                onResolve={\r\n                  problem.severity === 'critical'\r\n                    ? () => handleResolve(problem.id)\r\n                    : undefined\r\n                }\r\n                onReview={() => handleResolve(problem.id)}\r\n              />\r\n            ))\r\n          )}\r\n        </motion.div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"names":["severityConfig","ExclamationCircleIcon","ExclamationTriangleIcon","InformationCircleIcon","ProblemCard","severity","title","description","impact","affectedCampaigns","platform","onResolve","onReview","resolved","config","Icon","jsx","cn","jsxs","CheckCircleIcon","fadeIn","KGProblemDetection","severityFilter","setSeverityFilter","useState","data","isLoading","useKGProblems","resolveMutation","useResolveKGProblem","summary","problems","filteredProblems","p","handleResolve","problemId","metricCards","CurrencyDollarIcon","Fragment","Helmet","motion","card","FunnelIcon","filter","problem"],"mappings":"seA6BA,MAAMA,EAAiB,CACrB,SAAU,CACR,YAAa,mBACb,QAAS,eACT,UAAW,eACX,WAAY,+CACZ,KAAMC,EACN,MAAO,UAAA,EAET,QAAS,CACP,YAAa,qBACb,QAAS,iBACT,UAAW,iBACX,WAAY,qDACZ,KAAMC,EACN,MAAO,SAAA,EAET,KAAM,CACJ,YAAa,oBACb,QAAS,gBACT,UAAW,gBACX,WAAY,kDACZ,KAAMC,EACN,MAAO,MAAA,CAEX,EAEO,SAASC,EAAY,CAC1B,SAAAC,EACA,MAAAC,EACA,YAAAC,EACA,OAAAC,EACA,kBAAAC,EACA,SAAAC,EACA,UAAAC,EACA,SAAAC,EACA,SAAAC,CACF,EAAqB,CACnB,MAAMC,EAASd,EAAeK,CAAQ,EAChCU,EAAOD,EAAO,KAEpB,OACEE,EAAAA,IAAC,MAAA,CACC,UAAWC,EACT,kDACAH,EAAO,YACPA,EAAO,QACPD,GAAY,YAAA,EAGd,SAAAK,EAAAA,KAAC,MAAA,CAAI,UAAU,yCACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,gCACb,SAAA,CAAAF,MAACD,GAAK,UAAWE,EAAG,+BAAgCH,EAAO,SAAS,EAAG,EACvEI,EAAAA,KAAC,MAAA,CAAI,UAAU,iBACb,SAAA,CAAAA,EAAAA,KAAC,MAAA,CAAI,UAAU,+BACb,SAAA,CAAAF,EAAAA,IAAC,KAAA,CAAG,UAAU,gBAAiB,SAAAV,EAAM,EACrCU,EAAAA,IAAC,OAAA,CACC,UAAWC,EACT,sDACAH,EAAO,UAAA,EAGR,SAAAA,EAAO,KAAA,CAAA,EAETD,GACCK,EAAAA,KAAC,OAAA,CAAK,UAAU,iIACd,SAAA,CAAAF,EAAAA,IAACG,EAAA,CAAgB,UAAU,SAAA,CAAU,EAAE,UAAA,CAAA,CAEzC,CAAA,EAEJ,EACAH,EAAAA,IAAC,IAAA,CAAE,UAAU,qCAAsC,SAAAT,EAAY,EAC/DW,EAAAA,KAAC,MAAA,CAAI,UAAU,kCACb,SAAA,CAAAA,EAAAA,KAAC,OAAA,CAAK,UAAU,2BAA4B,SAAA,CAAAV,EAAO,SAAA,EAAO,EAC1DU,EAAAA,KAAC,OAAA,CAAK,UAAU,wBACb,SAAA,CAAAT,EAAkB,YAAUA,IAAsB,EAAI,IAAM,GAAG,WAAA,EAClE,EACAO,EAAAA,IAAC,OAAA,CAAK,UAAU,yCAA0C,SAAAN,CAAA,CAAS,CAAA,CAAA,CACrE,CAAA,CAAA,CACF,CAAA,EACF,EAEC,CAACG,GACAK,EAAAA,KAAC,MAAA,CAAI,UAAU,wCACZ,SAAA,CAAAb,IAAa,YAAcM,GAC1BK,EAAAA,IAAC,SAAA,CACC,QAASL,EACT,UAAU,oGACX,SAAA,SAAA,CAAA,EAIFC,GACCI,EAAAA,IAAC,SAAA,CACC,QAASJ,EACT,UAAU,qGACX,SAAA,QAAA,CAAA,CAED,CAAA,CAEJ,CAAA,CAAA,CAEJ,CAAA,CAAA,CAGN,CCjHA,MAAMQ,EAAS,CACb,QAAS,CAAE,QAAS,EAAG,EAAG,EAAA,EAC1B,QAAS,CAAE,QAAS,EAAG,EAAG,CAAA,EAC1B,WAAY,CAAE,SAAU,EAAA,CAC1B,EAEA,SAAwBC,GAAqB,CAC3C,KAAM,CAACC,EAAgBC,CAAiB,EAAIC,EAAAA,SAAkC,KAAK,EAE7E,CAAE,KAAAC,EAAM,UAAAC,CAAA,EAAcC,EAC1BL,IAAmB,MAAQ,CAAE,SAAUA,GAAmB,MAAA,EAEtDM,EAAkBC,EAAA,EAElBC,EAAUL,GAAA,YAAAA,EAAM,QAChBM,GAAWN,GAAA,YAAAA,EAAM,WAAY,CAAA,EAE7BO,EACJV,IAAmB,MACfS,EACAA,EAAS,OAAQE,GAAMA,EAAE,WAAaX,CAAc,EAEpDY,EAAiBC,GAAsB,CAC3CP,EAAgB,OAAOO,CAAS,CAClC,EAEMC,EAAc,CAClB,CACE,MAAO,kBACP,OAAON,GAAA,YAAAA,EAAS,WAAY,EAC5B,KAAM7B,EACN,MAAO,eACP,QAAS,gBACT,YAAa,mBAAA,EAEf,CACE,MAAO,WACP,OAAO6B,GAAA,YAAAA,EAAS,WAAY,EAC5B,KAAM5B,EACN,MAAO,iBACP,QAAS,kBACT,YAAa,qBAAA,EAEf,CACE,MAAO,iBACP,OAAO4B,GAAA,YAAAA,EAAS,cAAe,EAC/B,KAAMX,EACN,MAAO,iBACP,QAAS,kBACT,YAAa,qBAAA,EAEf,CACE,MAAO,kBACP,MAAO,OAAMW,GAAA,YAAAA,EAAS,gBAAiB,GAAK,KAAM,QAAQ,CAAC,CAAC,IAC5D,KAAMO,EACN,MAAO,eACP,QAAS,gBACT,YAAa,mBAAA,CACf,EAGF,OAAIX,EAEAV,MAAC,OAAI,UAAU,wCACb,eAAC,MAAA,CAAI,UAAU,8DAA8D,CAAA,CAC/E,EAKFE,EAAAA,KAAAoB,WAAA,CACE,SAAA,CAAAtB,MAACuB,EAAA,CACC,SAAAvB,EAAAA,IAAC,QAAA,CAAM,SAAA,kDAAA,CAAgD,EACzD,EAEAE,EAAAA,KAAC,MAAA,CAAI,UAAU,8BAEb,SAAA,CAAAA,EAAAA,KAACsB,EAAO,IAAP,CAAY,GAAGpB,EACd,SAAA,CAAAJ,EAAAA,IAAC,KAAA,CAAG,UAAU,qBAAqB,SAAA,oBAAiB,EACpDA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,wEAAA,CAErC,CAAA,EACF,EAGAA,EAAAA,IAACwB,EAAO,IAAP,CACC,UAAU,uDACT,GAAGpB,EACJ,WAAY,CAAE,MAAO,EAAA,EAEpB,SAAAgB,EAAY,IAAKK,GAChBzB,EAAAA,IAAC,MAAA,CAEC,UAAWC,EACT,yCACAwB,EAAK,YACLA,EAAK,OAAA,EAGP,SAAAvB,EAAAA,KAAC,MAAA,CAAI,UAAU,0BACb,SAAA,CAAAF,MAAC,OAAI,UAAWC,EAAG,iBAAkBwB,EAAK,OAAO,EAC/C,SAAAzB,EAAAA,IAACyB,EAAK,KAAL,CAAU,UAAWxB,EAAG,UAAWwB,EAAK,KAAK,EAAG,EACnD,SACC,MAAA,CACC,SAAA,CAAAzB,EAAAA,IAAC,IAAA,CAAE,UAAU,gCAAiC,SAAAyB,EAAK,MAAM,EACzDzB,EAAAA,IAAC,KAAE,UAAWC,EAAG,oBAAqBwB,EAAK,KAAK,EAAI,SAAAA,EAAK,KAAA,CAAM,CAAA,CAAA,CACjE,CAAA,CAAA,CACF,CAAA,EAfKA,EAAK,KAAA,CAiBb,CAAA,CAAA,EAIHvB,EAAAA,KAACsB,EAAO,IAAP,CACC,UAAU,0BACT,GAAGpB,EACJ,WAAY,CAAE,MAAO,GAAA,EAErB,SAAA,CAAAJ,EAAAA,IAAC0B,EAAA,CAAW,UAAU,+BAAA,CAAgC,EACtD1B,EAAAA,IAAC,OAAA,CAAK,UAAU,gCAAgC,SAAA,UAAO,EACrD,CAAC,MAAO,WAAY,UAAW,MAAM,EAAY,IAAK2B,GACtD3B,EAAAA,IAAC,SAAA,CAEC,QAAS,IAAMO,EAAkBoB,CAAM,EACvC,UAAW1B,EACT,8DACAK,IAAmBqB,EACf,yCACA,wCAAA,EAGL,SAAAA,IAAW,MAAQ,aAAeA,CAAA,EAT9BA,CAAA,CAWR,CAAA,CAAA,CAAA,EAIH3B,EAAAA,IAACwB,EAAO,IAAP,CACC,UAAU,YACT,GAAGpB,EACJ,WAAY,CAAE,MAAO,EAAA,EAEpB,WAAiB,SAAW,EAC3BF,EAAAA,KAAC,MAAA,CAAI,UAAU,0CACb,SAAA,CAAAF,EAAAA,IAACG,EAAA,CAAgB,UAAU,uCAAA,CAAwC,EACnEH,EAAAA,IAAC,IAAA,CAAE,UAAU,cAAc,SAAA,kBAAe,EAC1CA,EAAAA,IAAC,IAAA,CAAE,UAAU,UAAU,SAAA,oCAAA,CAAkC,CAAA,CAAA,CAC3D,EAEAgB,EAAiB,IAAKY,GACpB5B,EAAAA,IAACZ,EAAA,CAEC,SAAUwC,EAAQ,SAClB,MAAOA,EAAQ,MACf,YAAaA,EAAQ,YACrB,OAAQA,EAAQ,OAChB,kBAAmBA,EAAQ,kBAC3B,SAAUA,EAAQ,SAClB,SAAUA,EAAQ,SAAW,WAC7B,UACEA,EAAQ,WAAa,WACjB,IAAMV,EAAcU,EAAQ,EAAE,EAC9B,OAEN,SAAU,IAAMV,EAAcU,EAAQ,EAAE,CAAA,EAbnCA,EAAQ,EAAA,CAehB,CAAA,CAAA,CAEL,CAAA,CACF,CAAA,EACF,CAEJ"}