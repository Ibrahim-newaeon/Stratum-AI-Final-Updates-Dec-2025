import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as g}from"./vendor-react-Dz7uKsMg.js";import{t as i,F,c as S,a7 as T}from"./index-BQex3859.js";import{u as y,a as h,b}from"./vendor-query-BPt-n81V.js";import"./featureFlagsStore-DvEl_DiZ.js";import{F as $}from"./CheckIcon-DQQhceDd.js";import{F as f}from"./ArrowTopRightOnSquareIcon-Cr7jBqzy.js";import{F as M}from"./PlusIcon-ByQcgXHI.js";const m={getCompetitors:async(t={})=>(await i.get("/competitors",{params:t})).data.data,getCompetitor:async t=>(await i.get(`/competitors/${t}`)).data.data,createCompetitor:async t=>(await i.post("/competitors",t)).data.data,updateCompetitor:async(t,o)=>(await i.patch(`/competitors/${t}`,o)).data.data,deleteCompetitor:async t=>{await i.delete(`/competitors/${t}`)},getShareOfVoice:async(t,o,s)=>{const c={start_date:t,end_date:o};return s&&(c.platform=s),(await i.get("/competitors/share-of-voice",{params:c})).data.data},getCompetitorKeywords:async t=>(await i.get(`/competitors/${t}/keywords`)).data.data,getCompetitorMetrics:async(t,o,s)=>(await i.get(`/competitors/${t}/metrics`,{params:{start_date:o,end_date:s}})).data.data,refreshCompetitor:async t=>(await i.post(`/competitors/${t}/refresh`)).data.data};function R(t={}){return y({queryKey:["competitors",t],queryFn:()=>m.getCompetitors(t),staleTime:5*60*1e3})}function q(){const t=h();return b({mutationFn:m.createCompetitor,onSuccess:()=>{t.invalidateQueries({queryKey:["competitors"]})}})}function Q(){const t=h();return b({mutationFn:m.deleteCompetitor,onSuccess:()=>{t.invalidateQueries({queryKey:["competitors"]})}})}function B(t,o,s){return y({queryKey:["competitors","sov",t,o,s],queryFn:()=>m.getShareOfVoice(t,o,s),enabled:!!t&&!!o,staleTime:5*60*1e3})}const x=[{code:"SA",name:"Saudi Arabia",flag:"ðŸ‡¸ðŸ‡¦"},{code:"AE",name:"United Arab Emirates",flag:"ðŸ‡¦ðŸ‡ª"},{code:"EG",name:"Egypt",flag:"ðŸ‡ªðŸ‡¬"},{code:"KW",name:"Kuwait",flag:"ðŸ‡°ðŸ‡¼"},{code:"QA",name:"Qatar",flag:"ðŸ‡¶ðŸ‡¦"},{code:"BH",name:"Bahrain",flag:"ðŸ‡§ðŸ‡­"},{code:"OM",name:"Oman",flag:"ðŸ‡´ðŸ‡²"},{code:"JO",name:"Jordan",flag:"ðŸ‡¯ðŸ‡´"},{code:"LB",name:"Lebanon",flag:"ðŸ‡±ðŸ‡§"},{code:"US",name:"United States",flag:"ðŸ‡ºðŸ‡¸"},{code:"GB",name:"United Kingdom",flag:"ðŸ‡¬ðŸ‡§"},{code:"DE",name:"Germany",flag:"ðŸ‡©ðŸ‡ª"},{code:"FR",name:"France",flag:"ðŸ‡«ðŸ‡·"},{code:"IN",name:"India",flag:"ðŸ‡®ðŸ‡³"},{code:"PK",name:"Pakistan",flag:"ðŸ‡µðŸ‡°"},{code:"TR",name:"Turkey",flag:"ðŸ‡¹ðŸ‡·"}],L=[{id:"meta",name:"Meta (Facebook/Instagram)",icon:"M"},{id:"google",name:"Google Ads",icon:"G"},{id:"tiktok",name:"TikTok",icon:"T"},{id:"snapchat",name:"Snapchat",icon:"S"}];function V({isOpen:t,onClose:o,onSuccess:s}){var u;const[c,l]=g.useState(!1),[r,d]=g.useState({name:"",domain:"",country:"SA",platforms:["meta","google"]}),j=q(),{refetch:w}=R(),C=(a,n)=>`https://www.facebook.com/ads/library/?active_status=active&ad_type=all&country=${n}&q=${encodeURIComponent(a)}&search_type=keyword_unordered`,N=a=>`https://adstransparency.google.com/?query=${encodeURIComponent(a)}`,v=a=>{d(n=>({...n,platforms:n.platforms.includes(a)?n.platforms.filter(A=>A!==a):[...n.platforms,a]}))},k=async()=>{if(!(!r.name||!r.domain)){l(!0);try{await j.mutateAsync({name:r.name,domain:r.domain,country:r.country,platforms:r.platforms}),d({name:"",domain:"",country:"SA",platforms:["meta","google"]}),w(),s==null||s(),o()}catch(a){console.error("Failed to add competitor:",a)}finally{l(!1)}}},p=()=>{d({name:"",domain:"",country:"SA",platforms:["meta","google"]}),o()};return t?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:p}),e.jsxs("div",{className:"relative w-full max-w-lg mx-4 bg-card rounded-2xl shadow-2xl border overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Add Competitor"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track competitor ads via Meta Ads Library & Google Transparency"})]}),e.jsx("button",{onClick:p,className:"p-2 rounded-lg hover:bg-muted transition-colors",children:e.jsx(F,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Competitor Name *"}),e.jsx("input",{type:"text",value:r.name,onChange:a=>d(n=>({...n,name:a.target.value})),placeholder:"e.g., Competitor Inc",className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Website / Domain *"}),e.jsx("input",{type:"text",value:r.domain,onChange:a=>d(n=>({...n,domain:a.target.value})),placeholder:"e.g., competitor.com",className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Used to search ads in Meta Ads Library and Google Transparency"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Competitor's Country *"}),e.jsx("select",{value:r.country,onChange:a=>d(n=>({...n,country:a.target.value})),className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/50",children:x.map(a=>e.jsxs("option",{value:a.code,children:[a.flag," ",a.name]},a.code))}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select the country where competitor runs ads (for Meta Ads Library filter)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Platforms to Track"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(a=>e.jsxs("button",{type:"button",onClick:()=>v(a.id),className:S("flex items-center gap-2 px-3 py-2 rounded-lg border transition-all",r.platforms.includes(a.id)?"border-primary bg-primary/10 text-primary":"border-border hover:border-primary/50"),children:[e.jsx("span",{className:"w-5 h-5 rounded bg-muted flex items-center justify-center text-xs font-bold",children:a.icon}),e.jsx("span",{className:"text-sm",children:a.name}),r.platforms.includes(a.id)&&e.jsx($,{className:"w-4 h-4"})]},a.id))})]}),r.name&&e.jsxs("div",{className:"p-4 rounded-lg bg-muted/50 space-y-3",children:[e.jsxs("p",{className:"text-sm font-medium",children:['Preview Ad Library Links for "',r.name,'":']}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("a",{href:C(r.name,r.country),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary hover:underline",children:[e.jsx(f,{className:"w-4 h-4"}),'Search "',r.name,'" in Meta Ads Library (',(u=x.find(a=>a.code===r.country))==null?void 0:u.name,")"]}),e.jsxs("a",{href:N(r.name),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm text-primary hover:underline",children:[e.jsx(f,{className:"w-4 h-4"}),'Search "',r.name,'" in Google Ads Transparency']})]})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 p-6 border-t bg-muted/30",children:[e.jsx("button",{onClick:p,className:"px-4 py-2 rounded-lg border hover:bg-muted transition-colors",children:"Cancel"}),e.jsx("button",{onClick:k,disabled:!r.name||!r.domain||c,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 animate-spin"}),"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4"}),"Add Competitor"]})})]})]})]}):null}export{V as A,B as a,Q as b,R as u};
//# sourceMappingURL=AddCompetitorModal-Dt--nfpl.js.map
