import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as s}from"./vendor-react-Dz7uKsMg.js";import{c as g,ai as B,a9 as R,d6 as z,af as K,d5 as q}from"./index-BQex3859.js";import{d as Q}from"./hooks-B2vGXtE6.js";import{F as J}from"./ArrowDownTrayIcon-BpDtmKr2.js";import{F as V}from"./MagnifyingGlassIcon-3MUvqIvj.js";import{F as k}from"./UserIcon-LeInSHgb.js";import{F as X}from"./ServerIcon-DWm3Ovkz.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";import"./featureFlagsStore-DvEl_DiZ.js";function G({title:d,titleId:f,...i},N){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:N,"aria-labelledby":f},i),d?s.createElement("title",{id:f},d):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const H=s.forwardRef(G);function me(){var L;const[d,f]=s.useState(""),[i,N]=s.useState("all"),[y,P]=s.useState("all"),[b,E]=s.useState(null),[l,D]=s.useState({start:new Date(Date.now()-7*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]}),[n,A]=s.useState(1),[S,w]=s.useState(null),m=10,{data:C,isLoading:I}=Q({startDate:l.start,endDate:l.end,action:i!=="all"?i:void 0}),u=((L=C==null?void 0:C.items)==null?void 0:L.map(t=>({id:t.id,timestamp:new Date(t.timestamp),category:t.severity==="critical"||t.severity==="error"?"security":"user",severity:t.severity,action:t.action,description:t.details,actor:{type:"user",id:t.userId,name:t.userName??"User"},target:t.tenantId?{type:"tenant",id:String(t.tenantId),name:t.tenantName??"Unknown"}:null,metadata:t.metadata??{},ipAddress:t.ipAddress??null,userAgent:t.userAgent??null})))??[{id:"1",timestamp:new Date(Date.now()-5*60*1e3),category:"user",severity:"info",action:"user.login",description:"User logged in successfully",actor:{type:"user",id:"u1",name:"john@example.com"},target:null,metadata:{method:"email",mfaUsed:!1},ipAddress:"192.168.1.100",userAgent:"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"},{id:"2",timestamp:new Date(Date.now()-15*60*1e3),category:"security",severity:"warning",action:"auth.failed_login",description:"Failed login attempt - invalid password",actor:{type:"user",id:"unknown",name:"admin@example.com"},target:null,metadata:{attempts:3},ipAddress:"203.0.113.45",userAgent:"curl/7.64.1"},{id:"3",timestamp:new Date(Date.now()-30*60*1e3),category:"system",severity:"info",action:"autopilot.mode_change",description:"Autopilot mode changed from normal to limited",actor:{type:"system",id:"autopilot",name:"Autopilot Engine"},target:{type:"tenant",id:"t1",name:"Fashion Forward"},metadata:{previousMode:"normal",newMode:"limited",reason:"emq_degraded"},ipAddress:null,userAgent:null},{id:"4",timestamp:new Date(Date.now()-45*60*1e3),category:"api",severity:"error",action:"api.rate_limit",description:"API rate limit exceeded",actor:{type:"api",id:"api-key-123",name:"Integration API Key"},target:{type:"endpoint",id:"/api/v1/campaigns",name:"Campaigns API"},metadata:{limit:1e3,period:"1h",exceeded_by:150},ipAddress:"10.0.0.50",userAgent:"StratumSDK/1.0"},{id:"5",timestamp:new Date(Date.now()-60*60*1e3),category:"user",severity:"info",action:"campaign.update",description:"Campaign budget updated",actor:{type:"user",id:"u2",name:"sarah@example.com"},target:{type:"campaign",id:"c123",name:"Summer Sale 2024"},metadata:{previousBudget:5e3,newBudget:7500},ipAddress:"192.168.1.101",userAgent:"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7)"},{id:"6",timestamp:new Date(Date.now()-2*60*60*1e3),category:"security",severity:"critical",action:"auth.suspicious_activity",description:"Multiple failed login attempts from different locations",actor:{type:"user",id:"unknown",name:"admin@company.com"},target:null,metadata:{locations:["US","RU","CN"],attemptCount:15,timeWindow:"10m"},ipAddress:"Multiple",userAgent:"Various"},{id:"7",timestamp:new Date(Date.now()-3*60*60*1e3),category:"system",severity:"info",action:"sync.completed",description:"Platform data sync completed successfully",actor:{type:"system",id:"sync-engine",name:"Data Sync Engine"},target:{type:"platform",id:"meta",name:"Meta"},metadata:{recordsProcessed:15420,duration:"45s"},ipAddress:null,userAgent:null}],o=u.filter(t=>{var r;if(i!=="all"&&t.category!==i||y!=="all"&&t.severity!==y)return!1;if(d){const c=d.toLowerCase();return t.action.toLowerCase().includes(c)||t.description.toLowerCase().includes(c)||t.actor.name.toLowerCase().includes(c)||((r=t.target)==null?void 0:r.name.toLowerCase().includes(c))}return!0}),$=t=>{switch(t){case"user":return e.jsx(k,{className:"w-4 h-4"});case"system":return e.jsx(X,{className:"w-4 h-4"});case"security":return e.jsx(q,{className:"w-4 h-4"});case"api":return e.jsx(K,{className:"w-4 h-4"});default:return e.jsx(R,{className:"w-4 h-4"})}},M=t=>{switch(t){case"info":return"text-text-muted bg-surface-tertiary";case"warning":return"text-warning bg-warning/10";case"error":return"text-danger bg-danger/10";case"critical":return"text-danger bg-danger/20 animate-pulse"}},U=t=>{const c=new Date().getTime()-t.getTime(),x=Math.floor(c/6e4);if(x<60)return`${x}m ago`;const p=Math.floor(x/60);return p<24?`${p}h ago`:t.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})},T=()=>{try{const r=[["Timestamp","Category","Severity","Action","Description","Actor","Target","IP Address","User Agent"].join(",")];o.forEach(a=>{const W=[a.timestamp.toISOString(),a.category,a.severity,a.action,`"${a.description.replace(/"/g,'""')}"`,`"${a.actor.name}"`,a.target?`"${a.target.type}: ${a.target.name}"`:"",a.ipAddress||"",`"${(a.userAgent||"").replace(/"/g,'""')}"`];r.push(W.join(","))});const c=r.join(`
`),x=new Blob([c],{type:"text/csv;charset=utf-8;"}),p=URL.createObjectURL(x),h=document.createElement("a");h.href=p,h.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(p),w(`Successfully exported ${o.length} logs`),setTimeout(()=>w(null),3e3)}catch{w("Failed to export logs. Please try again."),setTimeout(()=>w(null),3e3)}},v=Math.ceil(o.length/m),F=o.slice((n-1)*m,n*m),O=()=>{A(t=>Math.max(1,t-1))},_=()=>{A(t=>Math.min(v,t+1))};s.useEffect(()=>{A(1)},[d,i,y,l.start,l.end]);const j={total:u.length,warnings:u.filter(t=>t.severity==="warning").length,errors:u.filter(t=>t.severity==="error").length,critical:u.filter(t=>t.severity==="critical").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Audit Logs"}),e.jsx("p",{className:"text-text-muted",children:"System-wide activity and security logs"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[S&&e.jsx("span",{className:g("text-sm px-3 py-1 rounded-lg",S.includes("Successfully")?"text-success bg-success/10":"text-danger bg-danger/10"),children:S}),e.jsxs("button",{onClick:T,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors",children:[e.jsx(J,{className:"w-4 h-4"}),"Export"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsx("div",{className:"text-text-muted text-sm mb-1",children:"Total Events"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:j.total})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsx("div",{className:"text-text-muted text-sm mb-1",children:"Warnings"}),e.jsx("div",{className:"text-2xl font-bold text-warning",children:j.warnings})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsx("div",{className:"text-text-muted text-sm mb-1",children:"Errors"}),e.jsx("div",{className:"text-2xl font-bold text-danger",children:j.errors})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsx("div",{className:"text-text-muted text-sm mb-1",children:"Critical"}),e.jsx("div",{className:"text-2xl font-bold text-danger",children:j.critical})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px] max-w-md",children:[e.jsx(V,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-text-muted"}),e.jsx("input",{type:"text",placeholder:"Search logs...",value:d,onChange:t=>f(t.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white placeholder-text-muted focus:outline-none focus:ring-2 focus:ring-stratum-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",value:l.start,onChange:t=>D(r=>({...r,start:t.target.value})),className:"px-3 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white focus:outline-none focus:ring-2 focus:ring-stratum-500"}),e.jsx("span",{className:"text-text-muted",children:"to"}),e.jsx("input",{type:"date",value:l.end,onChange:t=>D(r=>({...r,end:t.target.value})),className:"px-3 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white focus:outline-none focus:ring-2 focus:ring-stratum-500"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-text-muted"}),e.jsxs("select",{value:i,onChange:t=>N(t.target.value),className:"px-3 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white focus:outline-none focus:ring-2 focus:ring-stratum-500",children:[e.jsx("option",{value:"all",children:"All Categories"}),e.jsx("option",{value:"user",children:"User Actions"}),e.jsx("option",{value:"system",children:"System Events"}),e.jsx("option",{value:"security",children:"Security"}),e.jsx("option",{value:"api",children:"API Activity"})]})]}),e.jsxs("select",{value:y,onChange:t=>P(t.target.value),className:"px-3 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white focus:outline-none focus:ring-2 focus:ring-stratum-500",children:[e.jsx("option",{value:"all",children:"All Severities"}),e.jsx("option",{value:"info",children:"Info"}),e.jsx("option",{value:"warning",children:"Warning"}),e.jsx("option",{value:"error",children:"Error"}),e.jsx("option",{value:"critical",children:"Critical"})]})]}),e.jsx("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:I?e.jsx("div",{className:"p-8 text-center text-text-muted",children:"Loading audit logs..."}):o.length===0?e.jsx("div",{className:"p-8 text-center text-text-muted",children:"No logs found matching your filters."}):e.jsx("div",{className:"divide-y divide-white/5",children:F.map(t=>e.jsxs("div",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("button",{onClick:()=>E(b===t.id?null:t.id),className:"w-full p-4 text-left",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:g("p-2 rounded-lg",t.category==="security"?"bg-warning/10 text-warning":"bg-surface-tertiary text-text-muted"),children:$(t.category)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-mono text-sm text-stratum-400",children:t.action}),e.jsx("span",{className:g("px-2 py-0.5 rounded-full text-xs font-medium",M(t.severity)),children:t.severity})]}),e.jsx("p",{className:"text-white",children:t.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-sm text-text-muted",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"w-3 h-3"}),t.actor.name]}),t.target&&e.jsxs("span",{children:["â†’ ",t.target.type,": ",t.target.name]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),U(t.timestamp)]})]})]}),e.jsx("div",{className:"text-text-muted",children:b===t.id?e.jsx(H,{className:"w-5 h-5"}):e.jsx(z,{className:"w-5 h-5"})})]})}),b===t.id&&e.jsx("div",{className:"px-4 pb-4 ml-14",children:e.jsxs("div",{className:"p-4 rounded-lg bg-surface-tertiary space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Timestamp:"}),e.jsx("span",{className:"text-white ml-2",children:t.timestamp.toLocaleString()})]}),t.ipAddress&&e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"IP Address:"}),e.jsx("span",{className:"text-white ml-2 font-mono",children:t.ipAddress})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Actor Type:"}),e.jsx("span",{className:"text-white ml-2 capitalize",children:t.actor.type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-text-muted",children:"Actor ID:"}),e.jsx("span",{className:"text-white ml-2 font-mono",children:t.actor.id})]})]}),t.userAgent&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-text-muted",children:"User Agent:"}),e.jsx("p",{className:"text-white font-mono text-xs mt-1 break-all",children:t.userAgent})]}),Object.keys(t.metadata).length>0&&e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-text-muted",children:"Metadata:"}),e.jsx("pre",{className:"text-white font-mono text-xs mt-1 p-2 rounded bg-surface-primary overflow-x-auto",children:JSON.stringify(t.metadata,null,2)})]})]})})]},t.id))})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-text-muted",children:[e.jsxs("span",{children:["Showing ",F.length>0?(n-1)*m+1:0,"-",Math.min(n*m,o.length)," of ",o.length," logs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:O,disabled:n===1,className:g("px-3 py-1 rounded bg-surface-secondary transition-colors",n===1?"opacity-50 cursor-not-allowed":"hover:bg-surface-tertiary"),children:"Previous"}),e.jsxs("span",{className:"px-2",children:["Page ",n," of ",v||1]}),e.jsx("button",{onClick:_,disabled:n>=v,className:g("px-3 py-1 rounded bg-surface-secondary transition-colors",n>=v?"opacity-50 cursor-not-allowed":"hover:bg-surface-tertiary"),children:"Next"})]})]})]})}export{me as default};
//# sourceMappingURL=Audit-Dg6pdYHE.js.map
