{"version":3,"file":"TenantNarrative-CrfA4OUY.js","sources":["../../src/views/am/TenantNarrative.tsx"],"sourcesContent":["/**\r\n * Tenant Narrative (Account Manager Client Story View)\r\n *\r\n * Detailed view of a specific tenant for client communication\r\n * Shows \"what changed\", timeline, blocked actions, and fix playbook\r\n */\r\n\r\nimport { useCallback, useState } from 'react';\r\nimport { Link, useParams } from 'react-router-dom';\r\nimport { useToast } from '@/components/ui/use-toast';\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n  type AutopilotMode,\r\n  EmqFixPlaybookPanel,\r\n  EmqScoreCard,\r\n  EmqTimeline,\r\n  type Kpi,\r\n  KpiStrip,\r\n  type PlaybookItem,\r\n  type TimelineEvent,\r\n  TrustStatusHeader,\r\n} from '@/components/shared';\r\nimport {\r\n  useAutopilotState,\r\n  useEmqIncidents,\r\n  useEmqPlaybook,\r\n  useEmqScore,\r\n  useTenant,\r\n} from '@/api/hooks';\r\nimport {\r\n  ArrowLeftIcon,\r\n  ArrowTrendingDownIcon,\r\n  ArrowTrendingUpIcon,\r\n  CalendarIcon,\r\n  ClockIcon,\r\n  DocumentArrowDownIcon,\r\n  EnvelopeIcon,\r\n  PhoneIcon,\r\n  ShieldCheckIcon,\r\n  XCircleIcon,\r\n} from '@heroicons/react/24/outline';\r\n\r\ninterface BlockedAction {\r\n  id: string;\r\n  type: 'opportunity' | 'risk' | 'fix';\r\n  title: string;\r\n  reason: string;\r\n  estimatedImpact: string;\r\n  blockedAt: Date;\r\n}\r\n\r\ninterface RecoveryMetric {\r\n  label: string;\r\n  value: number;\r\n  unit: string;\r\n  trend: number;\r\n  isPositive: boolean;\r\n}\r\n\r\nexport default function TenantNarrative() {\r\n  const { tenantId } = useParams<{ tenantId: string }>();\r\n  const tid = parseInt(tenantId || '1', 10);\r\n  const { toast } = useToast();\r\n  const [selectedPlaybookItem, setSelectedPlaybookItem] = useState<PlaybookItem | null>(null);\r\n\r\n  const [activeTab, setActiveTab] = useState<'summary' | 'timeline' | 'blocked' | 'playbook'>(\r\n    'summary'\r\n  );\r\n\r\n  // Date range\r\n  const dateRange = {\r\n    start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\r\n    end: new Date().toISOString().split('T')[0],\r\n  };\r\n\r\n  // Fetch data\r\n  const { data: tenantData } = useTenant(Number(tenantId) || 0);\r\n  const { data: emqData } = useEmqScore(tid);\r\n  const { data: autopilotData } = useAutopilotState(tid);\r\n  const { data: playbookData } = useEmqPlaybook(tid);\r\n  const { data: incidentsData } = useEmqIncidents(tid, dateRange.start, dateRange.end);\r\n\r\n  const emqScore = emqData?.score ?? 65;\r\n  const autopilotMode: AutopilotMode = autopilotData?.mode ?? 'cuts_only';\r\n  const budgetAtRisk = autopilotData?.budgetAtRisk ?? 12000;\r\n\r\n  // Sample tenant details\r\n  const tenant = {\r\n    id: tenantId,\r\n    name: tenantData?.name ?? 'Fashion Forward',\r\n    industry: (tenantData as { industry?: string } | undefined)?.industry ?? 'Retail',\r\n    plan: 'Pro',\r\n    primaryContact: {\r\n      name: 'Jennifer Smith',\r\n      email: 'jennifer@fashionforward.com',\r\n      phone: '+1 (555) 123-4567',\r\n    },\r\n    lastContact: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000),\r\n    renewalDate: new Date(Date.now() + 30 * 24 * 60 * 60 * 1000),\r\n  };\r\n\r\n  const kpis: Kpi[] = [\r\n    {\r\n      id: 'spend',\r\n      label: 'Monthly Spend',\r\n      value: 120000,\r\n      format: 'currency',\r\n      previousValue: 115000,\r\n      confidence: emqScore,\r\n    },\r\n    {\r\n      id: 'revenue',\r\n      label: 'Revenue',\r\n      value: 336000,\r\n      format: 'currency',\r\n      previousValue: 380000,\r\n      confidence: emqScore,\r\n    },\r\n    {\r\n      id: 'roas',\r\n      label: 'ROAS',\r\n      value: 2.8,\r\n      format: 'multiplier',\r\n      previousValue: 3.3,\r\n      confidence: emqScore,\r\n    },\r\n    {\r\n      id: 'cpa',\r\n      label: 'CPA',\r\n      value: 42,\r\n      format: 'currency',\r\n      previousValue: 35,\r\n      trendIsPositive: false,\r\n      confidence: emqScore,\r\n    },\r\n  ];\r\n\r\n  const recoveryMetrics: RecoveryMetric[] = [\r\n    { label: 'EMQ Recovery', value: 8, unit: 'pts', trend: 12, isPositive: true },\r\n    { label: 'ROAS Impact', value: -15, unit: '%', trend: -15, isPositive: false },\r\n    { label: 'MTTR', value: 18, unit: 'hrs', trend: -25, isPositive: true },\r\n    { label: 'Blocked Actions', value: 5, unit: '', trend: 0, isPositive: false },\r\n  ];\r\n\r\n  const blockedActions: BlockedAction[] = [\r\n    {\r\n      id: '1',\r\n      type: 'opportunity',\r\n      title: 'Scale Summer Sale campaign by 25%',\r\n      reason: 'EMQ below threshold - data quality uncertain',\r\n      estimatedImpact: '+$18,000 revenue',\r\n      blockedAt: new Date(Date.now() - 18 * 60 * 60 * 1000),\r\n    },\r\n    {\r\n      id: '2',\r\n      type: 'opportunity',\r\n      title: 'Activate new lookalike audience',\r\n      reason: 'Autopilot in cuts_only mode',\r\n      estimatedImpact: '+45% reach',\r\n      blockedAt: new Date(Date.now() - 12 * 60 * 60 * 1000),\r\n    },\r\n    {\r\n      id: '3',\r\n      type: 'opportunity',\r\n      title: 'Launch TikTok retargeting campaign',\r\n      reason: 'Platform signal degraded',\r\n      estimatedImpact: '+$8,500 revenue',\r\n      blockedAt: new Date(Date.now() - 6 * 60 * 60 * 1000),\r\n    },\r\n  ];\r\n\r\n  const playbook: PlaybookItem[] = playbookData ?? [\r\n    {\r\n      id: '1',\r\n      title: 'Fix TikTok conversion tracking',\r\n      description: 'TikTok reporting 22% lower conversions than GA4. Primary driver of EMQ drop.',\r\n      priority: 'critical',\r\n      owner: 'Data Team',\r\n      estimatedImpact: 12,\r\n      estimatedTime: '2 hours',\r\n      platform: 'TikTok',\r\n      status: 'in_progress',\r\n      actionUrl: null,\r\n    },\r\n    {\r\n      id: '2',\r\n      title: 'Resolve Meta pixel data loss',\r\n      description: '8% event loss detected on purchase events.',\r\n      priority: 'high',\r\n      owner: null,\r\n      estimatedImpact: 6,\r\n      estimatedTime: '1 hour',\r\n      platform: 'Meta',\r\n      status: 'pending',\r\n      actionUrl: null,\r\n    },\r\n    {\r\n      id: '3',\r\n      title: 'Validate Snapchat API connection',\r\n      description: 'Intermittent 504 errors causing freshness issues.',\r\n      priority: 'medium',\r\n      owner: 'Engineering',\r\n      estimatedImpact: 4,\r\n      estimatedTime: '30 min',\r\n      platform: 'Snapchat',\r\n      status: 'pending',\r\n      actionUrl: null,\r\n    },\r\n  ];\r\n\r\n  const timeline: TimelineEvent[] = incidentsData?.map((i) => ({\r\n    id: i.id,\r\n    type: i.type,\r\n    title: i.title,\r\n    description: i.description ?? undefined,\r\n    timestamp: new Date(i.timestamp),\r\n    platform: i.platform ?? undefined,\r\n    severity: i.severity,\r\n    recoveryHours: i.recoveryHours ?? undefined,\r\n    emqImpact: i.emqImpact ?? undefined,\r\n  })) ?? [\r\n    {\r\n      id: '1',\r\n      type: 'incident_opened',\r\n      title: 'TikTok conversion tracking degraded',\r\n      description: '22% variance from GA4 detected',\r\n      timestamp: new Date(Date.now() - 18 * 60 * 60 * 1000),\r\n      platform: 'TikTok',\r\n      severity: 'high',\r\n      emqImpact: 12,\r\n    },\r\n    {\r\n      id: '2',\r\n      type: 'mode_change',\r\n      title: 'Autopilot mode â†’ cuts_only',\r\n      description: 'Automatic protection triggered',\r\n      timestamp: new Date(Date.now() - 16 * 60 * 60 * 1000),\r\n      severity: 'medium',\r\n    },\r\n    {\r\n      id: '3',\r\n      type: 'incident_opened',\r\n      title: 'Meta pixel data loss detected',\r\n      description: '8% purchase events missing',\r\n      timestamp: new Date(Date.now() - 12 * 60 * 60 * 1000),\r\n      platform: 'Meta',\r\n      severity: 'medium',\r\n      emqImpact: 6,\r\n    },\r\n    {\r\n      id: '4',\r\n      type: 'action_blocked',\r\n      title: '3 scaling actions blocked',\r\n      description: 'Protected $12,000 budget at risk',\r\n      timestamp: new Date(Date.now() - 8 * 60 * 60 * 1000),\r\n      severity: 'low',\r\n    },\r\n  ];\r\n\r\n  const tabs = [\r\n    { id: 'summary' as const, label: 'Client Summary' },\r\n    { id: 'timeline' as const, label: 'What Changed' },\r\n    { id: 'blocked' as const, label: 'What We Blocked' },\r\n    { id: 'playbook' as const, label: 'Fix Playbook' },\r\n  ];\r\n\r\n  const handleExportPDF = useCallback(() => {\r\n    const lines: string[] = [];\r\n    lines.push('CLIENT NARRATIVE REPORT');\r\n    lines.push(`Generated: ${new Date().toLocaleDateString()}`);\r\n    lines.push('');\r\n    lines.push(`Client: ${tenant.name}`);\r\n    lines.push(`Industry: ${tenant.industry}`);\r\n    lines.push(`Plan: ${tenant.plan}`);\r\n    lines.push(`Primary Contact: ${tenant.primaryContact.name} (${tenant.primaryContact.email})`);\r\n    lines.push('');\r\n\r\n    lines.push('--- TRUST STATUS ---');\r\n    lines.push(`EMQ Score: ${emqScore}/100`);\r\n    lines.push(`Autopilot Mode: ${autopilotMode}`);\r\n    lines.push(`Budget at Risk: $${budgetAtRisk.toLocaleString()}`);\r\n    lines.push('');\r\n\r\n    lines.push('--- KEY PERFORMANCE INDICATORS ---');\r\n    kpis.forEach((kpi) => {\r\n      const val = typeof kpi.value === 'number' ? kpi.value : parseFloat(kpi.value) || 0;\r\n      const prev = kpi.previousValue ?? 0;\r\n      const change = prev ? (((val - prev) / prev) * 100).toFixed(1) : 'N/A';\r\n      const prefix = kpi.format === 'currency' ? '$' : '';\r\n      const suffix = kpi.format === 'multiplier' ? 'x' : '';\r\n      lines.push(`${kpi.label}: ${prefix}${val.toLocaleString()}${suffix} (${change}% vs prior)`);\r\n    });\r\n    lines.push('');\r\n\r\n    lines.push('--- RECOVERY METRICS ---');\r\n    recoveryMetrics.forEach((m) => {\r\n      lines.push(`${m.label}: ${m.value >= 0 ? '+' : ''}${m.value}${m.unit}`);\r\n    });\r\n    lines.push('');\r\n\r\n    lines.push('--- BLOCKED ACTIONS ---');\r\n    blockedActions.forEach((a) => {\r\n      lines.push(`[${a.type.toUpperCase()}] ${a.title}`);\r\n      lines.push(`  Reason: ${a.reason}`);\r\n      lines.push(`  Estimated Impact: ${a.estimatedImpact}`);\r\n    });\r\n    lines.push('');\r\n\r\n    lines.push('--- FIX PLAYBOOK ---');\r\n    playbook.forEach((item) => {\r\n      lines.push(`[${item.priority.toUpperCase()}] ${item.title} - ${item.status}`);\r\n      lines.push(`  ${item.description}`);\r\n      lines.push(`  Owner: ${item.owner || 'Unassigned'} | Est. Impact: +${item.estimatedImpact} EMQ pts | Time: ${item.estimatedTime}`);\r\n    });\r\n\r\n    const blob = new Blob([lines.join('\\n')], { type: 'text/plain;charset=utf-8' });\r\n    const url = URL.createObjectURL(blob);\r\n    const a = document.createElement('a');\r\n    a.href = url;\r\n    a.download = `narrative-${tenant.name.replace(/\\s+/g, '-').toLowerCase()}-${new Date().toISOString().split('T')[0]}.txt`;\r\n    document.body.appendChild(a);\r\n    a.click();\r\n    document.body.removeChild(a);\r\n    URL.revokeObjectURL(url);\r\n  }, [tenant, emqScore, autopilotMode, budgetAtRisk, kpis, recoveryMetrics, blockedActions, playbook]);\r\n\r\n  const handleScheduleCall = useCallback(() => {\r\n    const subject = encodeURIComponent(`Stratum AI - ${tenant.name} Account Review`);\r\n    const body = encodeURIComponent(\r\n      `Hi ${tenant.primaryContact.name},\\n\\nI'd like to schedule a call to review your account performance.\\n\\nKey topics:\\n- EMQ Score: ${emqScore}/100\\n- ${blockedActions.length} blocked actions to discuss\\n- Recovery playbook status\\n\\nPlease let me know your availability.\\n\\nBest regards`\r\n    );\r\n    window.open(`mailto:${tenant.primaryContact.email}?subject=${subject}&body=${body}`, '_blank');\r\n  }, [tenant, emqScore, blockedActions.length]);\r\n\r\n  return (\r\n    <div data-tour=\"tenant-narrative\" className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Link\r\n            to=\"/dashboard/am/portfolio\"\r\n            className=\"p-2 rounded-lg bg-surface-secondary border border-white/10 text-text-muted hover:text-white transition-colors\"\r\n          >\r\n            <ArrowLeftIcon className=\"w-5 h-5\" />\r\n          </Link>\r\n          <div>\r\n            <div className=\"flex items-center gap-3\">\r\n              <h1 className=\"text-2xl font-bold text-white\">{tenant.name}</h1>\r\n              <span className=\"px-2 py-1 rounded-full text-xs bg-stratum-500/10 text-stratum-400\">\r\n                {tenant.plan}\r\n              </span>\r\n            </div>\r\n            <p className=\"text-text-muted\">{tenant.industry}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <button\r\n            onClick={handleScheduleCall}\r\n            className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors\"\r\n          >\r\n            <CalendarIcon className=\"w-4 h-4\" />\r\n            Schedule Call\r\n          </button>\r\n          <button\r\n            data-tour=\"export-pdf\"\r\n            onClick={handleExportPDF}\r\n            className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-gradient-stratum text-white font-medium hover:shadow-glow transition-all\"\r\n          >\r\n            <DocumentArrowDownIcon className=\"w-4 h-4\" />\r\n            Export PDF\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Contact Info */}\r\n      <div className=\"flex items-center gap-6 p-4 rounded-xl bg-surface-secondary border border-white/10\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"w-10 h-10 rounded-full bg-stratum-500/20 flex items-center justify-center\">\r\n            <span className=\"text-stratum-400 font-semibold\">\r\n              {tenant.primaryContact.name\r\n                .split(' ')\r\n                .map((n) => n[0])\r\n                .join('')}\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <div className=\"text-white font-medium\">{tenant.primaryContact.name}</div>\r\n            <div className=\"text-sm text-text-muted\">Primary Contact</div>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center gap-2 text-text-muted\">\r\n          <EnvelopeIcon className=\"w-4 h-4\" />\r\n          <span>{tenant.primaryContact.email}</span>\r\n        </div>\r\n        <div className=\"flex items-center gap-2 text-text-muted\">\r\n          <PhoneIcon className=\"w-4 h-4\" />\r\n          <span>{tenant.primaryContact.phone}</span>\r\n        </div>\r\n        <div className=\"ml-auto flex items-center gap-4 text-sm\">\r\n          <div>\r\n            <span className=\"text-text-muted\">Last Contact:</span>\r\n            <span className=\"text-white ml-2\">\r\n              {Math.floor((Date.now() - tenant.lastContact.getTime()) / (24 * 60 * 60 * 1000))} days\r\n              ago\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <span className=\"text-text-muted\">Renewal:</span>\r\n            <span className=\"text-warning ml-2\">\r\n              {Math.floor((tenant.renewalDate.getTime() - Date.now()) / (24 * 60 * 60 * 1000))} days\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Trust Status */}\r\n      <TrustStatusHeader\r\n        emqScore={emqScore}\r\n        autopilotMode={autopilotMode}\r\n        budgetAtRisk={budgetAtRisk}\r\n        svi={35}\r\n        onViewDetails={() => setActiveTab('timeline')}\r\n      />\r\n\r\n      {/* Recovery Metrics */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n        {recoveryMetrics.map((metric) => (\r\n          <div\r\n            key={metric.label}\r\n            className=\"p-4 rounded-xl bg-surface-secondary border border-white/10\"\r\n          >\r\n            <div className=\"text-text-muted text-sm mb-1\">{metric.label}</div>\r\n            <div className=\"flex items-center gap-2\">\r\n              <span\r\n                className={cn(\r\n                  'text-2xl font-bold',\r\n                  metric.isPositive ? 'text-success' : 'text-danger'\r\n                )}\r\n              >\r\n                {metric.value >= 0 ? (metric.value > 0 ? '+' : '') : ''}\r\n                {metric.value}\r\n                {metric.unit}\r\n              </span>\r\n              {metric.trend !== 0 && (\r\n                <span\r\n                  className={cn(\r\n                    'flex items-center text-xs',\r\n                    metric.isPositive ? 'text-success' : 'text-danger'\r\n                  )}\r\n                >\r\n                  {metric.isPositive ? (\r\n                    <ArrowTrendingUpIcon className=\"w-3 h-3\" />\r\n                  ) : (\r\n                    <ArrowTrendingDownIcon className=\"w-3 h-3\" />\r\n                  )}\r\n                  {Math.abs(metric.trend)}%\r\n                </span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {/* KPI Strip */}\r\n      <KpiStrip kpis={kpis} emqScore={emqScore} />\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex items-center gap-2 border-b border-white/10 pb-4\">\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id)}\r\n            className={cn(\r\n              'px-4 py-2 rounded-lg transition-colors',\r\n              activeTab === tab.id\r\n                ? 'bg-stratum-500/10 text-stratum-400'\r\n                : 'text-text-muted hover:text-white hover:bg-white/5'\r\n            )}\r\n          >\r\n            {tab.label}\r\n            {tab.id === 'blocked' && blockedActions.length > 0 && (\r\n              <span className=\"ml-2 px-2 py-0.5 rounded-full bg-warning/20 text-warning text-xs\">\r\n                {blockedActions.length}\r\n              </span>\r\n            )}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      {activeTab === 'summary' && (\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          <div className=\"lg:col-span-2\">\r\n            <EmqScoreCard\r\n              score={emqScore}\r\n              previousScore={emqData?.previousScore ?? 78}\r\n              showDrivers\r\n            />\r\n          </div>\r\n          <div>\r\n            <EmqTimeline events={timeline} maxEvents={6} />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === 'timeline' && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-lg font-semibold text-white\">What Changed (Last 30 Days)</h2>\r\n          </div>\r\n          <EmqTimeline events={timeline} maxEvents={20} />\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === 'blocked' && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <div>\r\n              <h2 className=\"text-lg font-semibold text-white\">What We Blocked</h2>\r\n              <p className=\"text-sm text-text-muted\">\r\n                Actions blocked to protect performance during signal degradation\r\n              </p>\r\n            </div>\r\n            <div className=\"flex items-center gap-2 px-4 py-2 rounded-xl bg-success/10 border border-success/20\">\r\n              <ShieldCheckIcon className=\"w-5 h-5 text-success\" />\r\n              <span className=\"text-success font-medium\">${budgetAtRisk.toLocaleString()}</span>\r\n              <span className=\"text-success/80\">protected</span>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"space-y-3\">\r\n            {blockedActions.map((action) => (\r\n              <div\r\n                key={action.id}\r\n                className=\"p-4 rounded-xl bg-surface-secondary border border-white/10\"\r\n              >\r\n                <div className=\"flex items-start justify-between\">\r\n                  <div className=\"flex items-start gap-3\">\r\n                    <div className=\"p-2 rounded-lg bg-warning/10\">\r\n                      <XCircleIcon className=\"w-5 h-5 text-warning\" />\r\n                    </div>\r\n                    <div>\r\n                      <h3 className=\"font-medium text-white\">{action.title}</h3>\r\n                      <p className=\"text-sm text-text-muted mt-1\">{action.reason}</p>\r\n                      <div className=\"flex items-center gap-4 mt-2 text-sm\">\r\n                        <span className=\"text-success\">{action.estimatedImpact} missed</span>\r\n                        <span className=\"flex items-center gap-1 text-text-muted\">\r\n                          <ClockIcon className=\"w-3 h-3\" />\r\n                          Blocked{' '}\r\n                          {Math.floor((Date.now() - action.blockedAt.getTime()) / (60 * 60 * 1000))}\r\n                          h ago\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  <span\r\n                    className={cn(\r\n                      'px-2 py-1 rounded text-xs',\r\n                      action.type === 'opportunity' && 'bg-success/10 text-success',\r\n                      action.type === 'risk' && 'bg-warning/10 text-warning',\r\n                      action.type === 'fix' && 'bg-stratum-500/10 text-stratum-400'\r\n                    )}\r\n                  >\r\n                    {action.type}\r\n                  </span>\r\n                </div>\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          <div className=\"p-4 rounded-xl bg-surface-tertiary border border-white/5 text-center\">\r\n            <p className=\"text-text-muted\">\r\n              These actions will automatically resume once EMQ recovers above 75 and autopilot\r\n              returns to normal mode.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === 'playbook' && (\r\n        <div data-tour=\"fix-playbook\" className=\"space-y-4\">\r\n          <EmqFixPlaybookPanel\r\n            items={playbook}\r\n            onItemClick={(item) => setSelectedPlaybookItem(item)}\r\n            onAssign={(item) => {\r\n              toast({\r\n                title: 'Assignment requested',\r\n                description: `\"${item.title}\" has been flagged for assignment. The ${item.owner || 'team'} will be notified.`,\r\n              });\r\n            }}\r\n            maxItems={10}\r\n          />\r\n\r\n          {/* Playbook Item Detail Panel */}\r\n          {selectedPlaybookItem && (\r\n            <div className=\"p-5 rounded-xl bg-surface-secondary border border-white/10\">\r\n              <div className=\"flex items-center justify-between mb-3\">\r\n                <h3 className=\"text-lg font-semibold text-white\">{selectedPlaybookItem.title}</h3>\r\n                <button\r\n                  onClick={() => setSelectedPlaybookItem(null)}\r\n                  className=\"text-text-muted hover:text-white transition-colors text-sm\"\r\n                >\r\n                  Close\r\n                </button>\r\n              </div>\r\n              <p className=\"text-text-secondary mb-4\">{selectedPlaybookItem.description}</p>\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm\">\r\n                <div>\r\n                  <span className=\"text-text-muted\">Priority</span>\r\n                  <p className={cn(\r\n                    'font-medium capitalize',\r\n                    selectedPlaybookItem.priority === 'critical' && 'text-danger',\r\n                    selectedPlaybookItem.priority === 'high' && 'text-warning',\r\n                    selectedPlaybookItem.priority === 'medium' && 'text-stratum-400',\r\n                  )}>\r\n                    {selectedPlaybookItem.priority}\r\n                  </p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-text-muted\">Owner</span>\r\n                  <p className=\"text-white font-medium\">{selectedPlaybookItem.owner || 'Unassigned'}</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-text-muted\">Est. Impact</span>\r\n                  <p className=\"text-success font-medium\">+{selectedPlaybookItem.estimatedImpact} EMQ pts</p>\r\n                </div>\r\n                <div>\r\n                  <span className=\"text-text-muted\">Est. Time</span>\r\n                  <p className=\"text-white font-medium\">{selectedPlaybookItem.estimatedTime}</p>\r\n                </div>\r\n              </div>\r\n              {selectedPlaybookItem.platform && (\r\n                <div className=\"mt-3 text-sm\">\r\n                  <span className=\"text-text-muted\">Platform: </span>\r\n                  <span className=\"text-white\">{selectedPlaybookItem.platform}</span>\r\n                </div>\r\n              )}\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["TenantNarrative","tenantId","useParams","tid","toast","useToast","selectedPlaybookItem","setSelectedPlaybookItem","useState","activeTab","setActiveTab","dateRange","tenantData","useTenant","emqData","useEmqScore","autopilotData","useAutopilotState","playbookData","useEmqPlaybook","incidentsData","useEmqIncidents","emqScore","autopilotMode","budgetAtRisk","tenant","kpis","recoveryMetrics","blockedActions","playbook","timeline","i","tabs","handleExportPDF","useCallback","lines","kpi","val","prev","change","prefix","suffix","m","a","item","blob","url","handleScheduleCall","subject","body","jsxs","jsx","Link","ArrowLeftIcon","CalendarIcon","DocumentArrowDownIcon","n","EnvelopeIcon","PhoneIcon","TrustStatusHeader","metric","cn","ArrowTrendingUpIcon","ArrowTrendingDownIcon","KpiStrip","tab","EmqScoreCard","EmqTimeline","ShieldCheckIcon","action","XCircleIcon","ClockIcon","EmqFixPlaybookPanel"],"mappings":"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"}