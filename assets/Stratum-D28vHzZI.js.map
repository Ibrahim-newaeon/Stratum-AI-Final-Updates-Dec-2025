{"version":3,"file":"Stratum-D28vHzZI.js","sources":["../../src/api/insights.ts","../../src/components/widgets/SimulateSlider.tsx","../../src/views/Stratum.tsx"],"sourcesContent":["/**\r\n * Stratum AI - Insights API Hooks\r\n *\r\n * React Query hooks for Intelligence Layer features:\r\n * - Insights (aggregated daily view)\r\n * - Recommendations\r\n * - Anomaly alerts\r\n * - KPIs\r\n */\r\n\r\nimport { useQuery } from '@tanstack/react-query';\r\nimport { apiClient } from './client';\r\n\r\n// =============================================================================\r\n// Types\r\n// =============================================================================\r\n\r\nexport interface AutopilotStatus {\r\n  level: number;\r\n  level_name: string;\r\n  blocked: boolean;\r\n  reason: string | null;\r\n}\r\n\r\nexport interface ActionRecommendation {\r\n  type: string;\r\n  priority: 'critical' | 'high' | 'medium' | 'low' | 'info';\r\n  title: string;\r\n  description: string;\r\n  entity_id?: string;\r\n  entity_name?: string;\r\n  entity_type?: string;\r\n  expected_impact?: Record<string, unknown>;\r\n  action_params?: Record<string, unknown>;\r\n  confidence?: number;\r\n  guardrails?: {\r\n    max_budget_change_pct: number;\r\n    max_daily_budget_change: number;\r\n    requires_approval: boolean;\r\n  };\r\n}\r\n\r\nexport interface RiskAlert {\r\n  type: string;\r\n  severity: string;\r\n  message: string;\r\n  metric?: string;\r\n  current_value?: number;\r\n  baseline?: number;\r\n}\r\n\r\nexport interface Opportunity {\r\n  type: string;\r\n  entity_id?: string;\r\n  entity_name?: string;\r\n  title: string;\r\n  score?: number;\r\n  recommendations?: string[];\r\n}\r\n\r\nexport interface InsightsData {\r\n  date: string;\r\n  kpis: {\r\n    total_spend: number;\r\n    total_revenue: number;\r\n    roas: number;\r\n    cpa: number;\r\n    trend_vs_yesterday: number;\r\n    trend_vs_last_week: number;\r\n  };\r\n  actions: ActionRecommendation[];\r\n  risks: RiskAlert[];\r\n  opportunities: Opportunity[];\r\n  autopilot: AutopilotStatus;\r\n  signal_health_status: string;\r\n  scaling_summary: {\r\n    scale_candidates: number;\r\n    fix_candidates: number;\r\n    watch_candidates: number;\r\n  };\r\n}\r\n\r\nexport interface RecommendationsData {\r\n  date: string;\r\n  recommendations: ActionRecommendation[];\r\n  total: number;\r\n  filters_applied: {\r\n    entity_type: string | null;\r\n    priority: string | null;\r\n  };\r\n}\r\n\r\nexport interface Anomaly {\r\n  id: string;\r\n  detected_at: string;\r\n  metric: string;\r\n  entity_type: string;\r\n  entity_id: string;\r\n  entity_name: string;\r\n  severity: 'critical' | 'high' | 'medium' | 'low';\r\n  direction: 'spike' | 'drop';\r\n  current_value: number;\r\n  expected_value: number;\r\n  zscore: number;\r\n  description: string;\r\n  possible_causes: string[];\r\n  recommended_actions: string[];\r\n}\r\n\r\nexport interface AnomaliesData {\r\n  date: string;\r\n  lookback_days: number;\r\n  anomalies: Anomaly[];\r\n  total: number;\r\n  by_severity: {\r\n    critical: number;\r\n    high: number;\r\n    medium: number;\r\n    low: number;\r\n  };\r\n}\r\n\r\nexport interface MetricTrend {\r\n  value: number;\r\n  previous: number;\r\n  change_pct: number;\r\n  trend: 'up' | 'down' | 'neutral';\r\n}\r\n\r\nexport interface KPIsData {\r\n  date: string;\r\n  comparison_date: string;\r\n  comparison_type: string;\r\n  metrics: {\r\n    spend: MetricTrend;\r\n    revenue: MetricTrend;\r\n    roas: MetricTrend;\r\n    cpa: MetricTrend;\r\n    conversions: MetricTrend;\r\n    ctr: MetricTrend;\r\n  };\r\n  by_platform: Record<string, unknown>;\r\n}\r\n\r\n// =============================================================================\r\n// Hooks\r\n// =============================================================================\r\n\r\n/**\r\n * Fetch insights for a tenant.\r\n */\r\nexport function useInsights(tenantId: number, date?: string) {\r\n  return useQuery({\r\n    queryKey: ['insights', tenantId, date],\r\n    queryFn: async () => {\r\n      const params = date ? `?date=${date}` : '';\r\n      const response = await apiClient.get<{ data: InsightsData }>(\r\n        `/insights/tenant/${tenantId}/insights${params}`\r\n      );\r\n      return response.data.data;\r\n    },\r\n    enabled: !!tenantId,\r\n    staleTime: 60 * 1000, // 1 minute\r\n    refetchInterval: 5 * 60 * 1000, // Refetch every 5 minutes\r\n  });\r\n}\r\n\r\n/**\r\n * Fetch detailed recommendations.\r\n */\r\nexport function useRecommendations(\r\n  tenantId: number,\r\n  options?: {\r\n    date?: string;\r\n    entity_type?: string;\r\n    priority?: string;\r\n    limit?: number;\r\n  }\r\n) {\r\n  return useQuery({\r\n    queryKey: ['recommendations', tenantId, options],\r\n    queryFn: async () => {\r\n      const params = new URLSearchParams();\r\n      if (options?.date) params.append('date', options.date);\r\n      if (options?.entity_type) params.append('entity_type', options.entity_type);\r\n      if (options?.priority) params.append('priority', options.priority);\r\n      if (options?.limit) params.append('limit', options.limit.toString());\r\n\r\n      const response = await apiClient.get<{ data: RecommendationsData }>(\r\n        `/insights/tenant/${tenantId}/recommendations?${params}`\r\n      );\r\n      return response.data.data;\r\n    },\r\n    enabled: !!tenantId,\r\n    staleTime: 60 * 1000,\r\n  });\r\n}\r\n\r\n/**\r\n * Fetch anomaly alerts.\r\n */\r\nexport function useAnomalies(\r\n  tenantId: number,\r\n  options?: {\r\n    date?: string;\r\n    days?: number;\r\n    severity?: string;\r\n  }\r\n) {\r\n  return useQuery({\r\n    queryKey: ['anomalies', tenantId, options],\r\n    queryFn: async () => {\r\n      const params = new URLSearchParams();\r\n      if (options?.date) params.append('date', options.date);\r\n      if (options?.days) params.append('days', options.days.toString());\r\n      if (options?.severity) params.append('severity', options.severity);\r\n\r\n      const response = await apiClient.get<{ data: AnomaliesData }>(\r\n        `/insights/tenant/${tenantId}/anomalies?${params}`\r\n      );\r\n      return response.data.data;\r\n    },\r\n    enabled: !!tenantId,\r\n    staleTime: 60 * 1000,\r\n  });\r\n}\r\n\r\n/**\r\n * Fetch KPIs with trends.\r\n */\r\nexport function useKPIs(\r\n  tenantId: number,\r\n  options?: {\r\n    date?: string;\r\n    comparison?: 'yesterday' | 'last_week' | 'last_month';\r\n  }\r\n) {\r\n  return useQuery({\r\n    queryKey: ['kpis', tenantId, options],\r\n    queryFn: async () => {\r\n      const params = new URLSearchParams();\r\n      if (options?.date) params.append('date', options.date);\r\n      if (options?.comparison) params.append('comparison', options.comparison);\r\n\r\n      const response = await apiClient.get<{ data: KPIsData }>(\r\n        `/insights/tenant/${tenantId}/kpis?${params}`\r\n      );\r\n      return response.data.data;\r\n    },\r\n    enabled: !!tenantId,\r\n    staleTime: 60 * 1000,\r\n  });\r\n}\r\n\r\n// =============================================================================\r\n// Utility Functions\r\n// =============================================================================\r\n\r\n/**\r\n * Get priority color.\r\n */\r\nexport function getPriorityColor(priority: string): string {\r\n  const colors: Record<string, string> = {\r\n    critical: 'red',\r\n    high: 'orange',\r\n    medium: 'yellow',\r\n    low: 'blue',\r\n    info: 'gray',\r\n  };\r\n  return colors[priority] || 'gray';\r\n}\r\n\r\n/**\r\n * Get priority label.\r\n */\r\nexport function getPriorityLabel(priority: string): string {\r\n  const labels: Record<string, string> = {\r\n    critical: 'Critical',\r\n    high: 'High Priority',\r\n    medium: 'Medium Priority',\r\n    low: 'Low Priority',\r\n    info: 'Info',\r\n  };\r\n  return labels[priority] || priority;\r\n}\r\n\r\n/**\r\n * Get action type icon.\r\n */\r\nexport function getActionTypeIcon(type: string): string {\r\n  const icons: Record<string, string> = {\r\n    budget_shift: 'üí∞',\r\n    creative_refresh: 'üé®',\r\n    fix_campaign: 'üîß',\r\n    anomaly_investigation: 'üîç',\r\n    signal_health: 'üìä',\r\n    scaling_opportunity: 'üìà',\r\n  };\r\n  return icons[type] || 'üìã';\r\n}\r\n\r\n/**\r\n * Get trend icon.\r\n */\r\nexport function getTrendIcon(trend: string): string {\r\n  const icons: Record<string, string> = {\r\n    up: 'üìà',\r\n    down: 'üìâ',\r\n    neutral: '‚û°Ô∏è',\r\n  };\r\n  return icons[trend] || '‚û°Ô∏è';\r\n}\r\n\r\n/**\r\n * Format currency.\r\n */\r\nexport function formatCurrency(value: number): string {\r\n  return new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency: 'USD',\r\n    minimumFractionDigits: 0,\r\n    maximumFractionDigits: 0,\r\n  }).format(value);\r\n}\r\n\r\n/**\r\n * Format percentage.\r\n */\r\nexport function formatPercentage(value: number, decimals: number = 1): string {\r\n  return `${value >= 0 ? '+' : ''}${value.toFixed(decimals)}%`;\r\n}\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport {\r\n  Calculator,\r\n  DollarSign,\r\n  Info,\r\n  RefreshCw,\r\n  Target,\r\n  TrendingDown,\r\n  TrendingUp,\r\n} from 'lucide-react';\r\nimport { cn, formatCompactNumber, formatCurrency, formatPercent } from '@/lib/utils';\r\nimport { SmartTooltip } from '../guide/SmartTooltip';\r\n\r\ninterface SimulationInput {\r\n  budgetChange: number; // -50 to +100 percent\r\n  bidChange: number; // -30 to +50 percent\r\n  targetAudienceChange: number; // -50 to +100 percent\r\n}\r\n\r\ninterface SimulationResult {\r\n  estimatedSpend: number;\r\n  estimatedRevenue: number;\r\n  estimatedROAS: number;\r\n  estimatedImpressions: number;\r\n  estimatedClicks: number;\r\n  estimatedConversions: number;\r\n  confidence: number;\r\n}\r\n\r\ninterface CampaignBaseline {\r\n  name: string;\r\n  currentSpend: number;\r\n  currentRevenue: number;\r\n  currentROAS: number;\r\n  currentImpressions: number;\r\n  currentClicks: number;\r\n  currentConversions: number;\r\n}\r\n\r\ninterface SimulateSliderProps {\r\n  campaign?: CampaignBaseline;\r\n  onSimulate?: (input: SimulationInput, result: SimulationResult) => void;\r\n  className?: string;\r\n}\r\n\r\nconst DEFAULT_CAMPAIGN: CampaignBaseline = {\r\n  name: 'All Campaigns',\r\n  currentSpend: 15000,\r\n  currentRevenue: 52500,\r\n  currentROAS: 3.5,\r\n  currentImpressions: 2500000,\r\n  currentClicks: 75000,\r\n  currentConversions: 1875,\r\n};\r\n\r\nexport function SimulateSlider({\r\n  campaign = DEFAULT_CAMPAIGN,\r\n  onSimulate,\r\n  className,\r\n}: SimulateSliderProps) {\r\n  const { t } = useTranslation();\r\n  const [inputs, setInputs] = useState<SimulationInput>({\r\n    budgetChange: 0,\r\n    bidChange: 0,\r\n    targetAudienceChange: 0,\r\n  });\r\n  const [result, setResult] = useState<SimulationResult | null>(null);\r\n  const [isSimulating, setIsSimulating] = useState(false);\r\n\r\n  // Simulate effect of changes using a simplified model\r\n  const runSimulation = useCallback(() => {\r\n    setIsSimulating(true);\r\n\r\n    // Simulated delay for realism\r\n    setTimeout(() => {\r\n      const { budgetChange, bidChange, targetAudienceChange } = inputs;\r\n\r\n      // Calculate multipliers\r\n      const budgetMultiplier = 1 + budgetChange / 100;\r\n      const bidMultiplier = 1 + bidChange / 100;\r\n      const audienceMultiplier = 1 + targetAudienceChange / 100;\r\n\r\n      // Budget increases spend linearly\r\n      const newSpend = campaign.currentSpend * budgetMultiplier;\r\n\r\n      // Impressions scale with budget and audience, diminishing returns\r\n      const impressionGrowth = Math.pow(budgetMultiplier, 0.7) * Math.pow(audienceMultiplier, 0.5);\r\n      const newImpressions = campaign.currentImpressions * impressionGrowth;\r\n\r\n      // Higher bids improve position but have diminishing returns\r\n      const bidEfficiency = bidMultiplier > 1 ? Math.pow(bidMultiplier, 0.6) : bidMultiplier;\r\n      const ctrImprovement = bidEfficiency;\r\n\r\n      // Clicks depend on impressions and CTR (influenced by bid)\r\n      const newClicks =\r\n        newImpressions * (campaign.currentClicks / campaign.currentImpressions) * ctrImprovement;\r\n\r\n      // Conversions scale with clicks and slight efficiency loss at higher volumes\r\n      const conversionEfficiency = Math.pow(budgetMultiplier, -0.1); // diminishing returns\r\n      const newConversions =\r\n        newClicks * (campaign.currentConversions / campaign.currentClicks) * conversionEfficiency;\r\n\r\n      // Revenue scales with conversions\r\n      const newRevenue = newConversions * (campaign.currentRevenue / campaign.currentConversions);\r\n\r\n      // Calculate new ROAS\r\n      const newROAS = newSpend > 0 ? newRevenue / newSpend : 0;\r\n\r\n      // Confidence decreases with larger changes\r\n      const changesMagnitude =\r\n        Math.abs(budgetChange) + Math.abs(bidChange) + Math.abs(targetAudienceChange);\r\n      const confidence = Math.max(60, 95 - changesMagnitude * 0.3);\r\n\r\n      const simulationResult: SimulationResult = {\r\n        estimatedSpend: newSpend,\r\n        estimatedRevenue: newRevenue,\r\n        estimatedROAS: newROAS,\r\n        estimatedImpressions: Math.round(newImpressions),\r\n        estimatedClicks: Math.round(newClicks),\r\n        estimatedConversions: Math.round(newConversions),\r\n        confidence: Math.round(confidence),\r\n      };\r\n\r\n      setResult(simulationResult);\r\n      onSimulate?.(inputs, simulationResult);\r\n      setIsSimulating(false);\r\n    }, 500);\r\n  }, [inputs, campaign, onSimulate]);\r\n\r\n  // Run simulation when inputs change\r\n  useEffect(() => {\r\n    const hasChanges =\r\n      inputs.budgetChange !== 0 || inputs.bidChange !== 0 || inputs.targetAudienceChange !== 0;\r\n    if (hasChanges) {\r\n      const timer = setTimeout(runSimulation, 300);\r\n      return () => clearTimeout(timer);\r\n    } else {\r\n      setResult(null);\r\n    }\r\n  }, [inputs, runSimulation]);\r\n\r\n  const resetInputs = () => {\r\n    setInputs({\r\n      budgetChange: 0,\r\n      bidChange: 0,\r\n      targetAudienceChange: 0,\r\n    });\r\n    setResult(null);\r\n  };\r\n\r\n  const renderSlider = (\r\n    label: string,\r\n    value: number,\r\n    min: number,\r\n    max: number,\r\n    onChange: (value: number) => void,\r\n    tooltip: string\r\n  ) => (\r\n    <div className=\"space-y-2\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <SmartTooltip content={tooltip} position=\"right\">\r\n          <span className=\"text-sm font-medium flex items-center gap-1\">\r\n            {label}\r\n            <Info className=\"w-3.5 h-3.5 text-muted-foreground\" />\r\n          </span>\r\n        </SmartTooltip>\r\n        <span\r\n          className={cn(\r\n            'text-sm font-semibold',\r\n            value > 0 && 'text-green-500',\r\n            value < 0 && 'text-red-500'\r\n          )}\r\n        >\r\n          {value > 0 ? '+' : ''}\r\n          {value}%\r\n        </span>\r\n      </div>\r\n      <input\r\n        type=\"range\"\r\n        min={min}\r\n        max={max}\r\n        value={value}\r\n        onChange={(e) => onChange(Number(e.target.value))}\r\n        className=\"w-full h-2 bg-muted rounded-lg appearance-none cursor-pointer accent-primary\"\r\n      />\r\n      <div className=\"flex justify-between text-xs text-muted-foreground\">\r\n        <span>{min}%</span>\r\n        <span>{max}%</span>\r\n      </div>\r\n    </div>\r\n  );\r\n\r\n  const getChangeIndicator = (current: number, estimated: number) => {\r\n    const change = ((estimated - current) / current) * 100;\r\n    if (Math.abs(change) < 0.5) return null;\r\n\r\n    return (\r\n      <span\r\n        className={cn(\r\n          'flex items-center gap-0.5 text-xs',\r\n          change > 0 ? 'text-green-500' : 'text-red-500'\r\n        )}\r\n      >\r\n        {change > 0 ? <TrendingUp className=\"w-3 h-3\" /> : <TrendingDown className=\"w-3 h-3\" />}\r\n        {change > 0 ? '+' : ''}\r\n        {formatPercent(change)}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div id=\"simulator-widget\" className={cn('rounded-xl border bg-card p-5', className)}>\r\n      {/* Header */}\r\n      <div className=\"flex items-center justify-between mb-5\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"p-2 rounded-lg bg-primary/10\">\r\n            <Calculator className=\"w-5 h-5 text-primary\" />\r\n          </div>\r\n          <div>\r\n            <h3 className=\"font-semibold\">{t('simulator.title')}</h3>\r\n            <p className=\"text-xs text-muted-foreground\">{campaign.name}</p>\r\n          </div>\r\n        </div>\r\n        <button\r\n          onClick={resetInputs}\r\n          className=\"p-2 rounded-lg hover:bg-muted transition-colors\"\r\n          title=\"Reset\"\r\n        >\r\n          <RefreshCw className=\"w-4 h-4\" />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Sliders */}\r\n      <div className=\"space-y-5 mb-6\">\r\n        {renderSlider(\r\n          t('simulator.budget'),\r\n          inputs.budgetChange,\r\n          -50,\r\n          100,\r\n          (value) => setInputs((prev) => ({ ...prev, budgetChange: value })),\r\n          t('simulator.budgetTooltip')\r\n        )}\r\n        {renderSlider(\r\n          t('simulator.bid'),\r\n          inputs.bidChange,\r\n          -30,\r\n          50,\r\n          (value) => setInputs((prev) => ({ ...prev, bidChange: value })),\r\n          t('simulator.bidTooltip')\r\n        )}\r\n        {renderSlider(\r\n          t('simulator.audience'),\r\n          inputs.targetAudienceChange,\r\n          -50,\r\n          100,\r\n          (value) => setInputs((prev) => ({ ...prev, targetAudienceChange: value })),\r\n          t('simulator.audienceTooltip')\r\n        )}\r\n      </div>\r\n\r\n      {/* Results */}\r\n      {(result || isSimulating) && (\r\n        <div className=\"border-t pt-4\">\r\n          <div className=\"flex items-center justify-between mb-3\">\r\n            <span className=\"text-sm font-medium\">{t('simulator.projectedResults')}</span>\r\n            {result && (\r\n              <span className=\"text-xs text-muted-foreground\">\r\n                {result.confidence}% {t('simulator.confidence')}\r\n              </span>\r\n            )}\r\n          </div>\r\n\r\n          {isSimulating ? (\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              {[1, 2, 3].map((i) => (\r\n                <div key={i} className=\"p-3 rounded-lg bg-muted/50 animate-pulse\">\r\n                  <div className=\"h-3 w-12 bg-muted rounded mb-2\" />\r\n                  <div className=\"h-5 w-16 bg-muted rounded\" />\r\n                </div>\r\n              ))}\r\n            </div>\r\n          ) : result ? (\r\n            <div className=\"grid grid-cols-3 gap-3\">\r\n              <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                <div className=\"flex items-center gap-1 text-xs text-muted-foreground mb-1\">\r\n                  <DollarSign className=\"w-3 h-3\" />\r\n                  {t('simulator.spend')}\r\n                </div>\r\n                <div className=\"font-semibold\">{formatCurrency(result.estimatedSpend)}</div>\r\n                {getChangeIndicator(campaign.currentSpend, result.estimatedSpend)}\r\n              </div>\r\n\r\n              <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                <div className=\"flex items-center gap-1 text-xs text-muted-foreground mb-1\">\r\n                  <TrendingUp className=\"w-3 h-3\" />\r\n                  {t('simulator.revenue')}\r\n                </div>\r\n                <div className=\"font-semibold\">{formatCurrency(result.estimatedRevenue)}</div>\r\n                {getChangeIndicator(campaign.currentRevenue, result.estimatedRevenue)}\r\n              </div>\r\n\r\n              <div className=\"p-3 rounded-lg bg-muted/50\">\r\n                <div className=\"flex items-center gap-1 text-xs text-muted-foreground mb-1\">\r\n                  <Target className=\"w-3 h-3\" />\r\n                  ROAS\r\n                </div>\r\n                <div className=\"font-semibold\">{result.estimatedROAS.toFixed(2)}x</div>\r\n                {getChangeIndicator(campaign.currentROAS, result.estimatedROAS)}\r\n              </div>\r\n            </div>\r\n          ) : null}\r\n\r\n          {result && (\r\n            <div className=\"mt-3 grid grid-cols-3 gap-3 text-center\">\r\n              <div>\r\n                <div className=\"text-xs text-muted-foreground\">{t('simulator.impressions')}</div>\r\n                <div className=\"text-sm font-medium\">\r\n                  {formatCompactNumber(result.estimatedImpressions)}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-xs text-muted-foreground\">{t('simulator.clicks')}</div>\r\n                <div className=\"text-sm font-medium\">\r\n                  {formatCompactNumber(result.estimatedClicks)}\r\n                </div>\r\n              </div>\r\n              <div>\r\n                <div className=\"text-xs text-muted-foreground\">{t('simulator.conversions')}</div>\r\n                <div className=\"text-sm font-medium\">\r\n                  {formatCompactNumber(result.estimatedConversions)}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {/* No changes message */}\r\n      {!result && !isSimulating && (\r\n        <div className=\"border-t pt-4 text-center text-sm text-muted-foreground\">\r\n          <p>{t('simulator.adjustSliders')}</p>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default SimulateSlider;\r\n","import { useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport { useToast } from '@/components/ui/use-toast';\r\nimport {\r\n  Area,\r\n  AreaChart,\r\n  CartesianGrid,\r\n  Cell,\r\n  Line,\r\n  LineChart,\r\n  Pie,\r\n  PieChart,\r\n  ResponsiveContainer,\r\n  Tooltip,\r\n  XAxis,\r\n  YAxis,\r\n} from 'recharts';\r\nimport {\r\n  AlertTriangle,\r\n  ArrowRight,\r\n  BarChart3,\r\n  Bell,\r\n  Brain,\r\n  CheckCircle2,\r\n  Clock,\r\n  Lightbulb,\r\n  Loader2,\r\n  Mail,\r\n  MessageSquare,\r\n  RefreshCw,\r\n  Settings,\r\n  Sparkles,\r\n  Target,\r\n  TrendingUp,\r\n  X,\r\n  Zap,\r\n} from 'lucide-react';\r\nimport { cn, formatCompactNumber, formatCurrency } from '@/lib/utils';\r\nimport { SimulateSlider } from '@/components/widgets/SimulateSlider';\r\nimport { useAnomalies, useInsights, useLivePredictions, useRecommendations } from '@/api/hooks';\r\nimport { useTenantStore } from '@/stores/tenantStore';\r\n\r\n// Type for insight - defined early for mock data typing\r\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\r\ninterface Insight {\r\n  id: number;\r\n  type: string;\r\n  priority: string;\r\n  title: string;\r\n  description: string;\r\n  impact: string;\r\n  campaign: string;\r\n  fullDescription?: string;\r\n  metrics?: Record<string, any>;\r\n  recommendations?: string[];\r\n  historicalData?: Array<{ date: string; performance: number }>;\r\n  confidence?: number;\r\n  detectedAt?: string;\r\n}\r\n\r\n// Mock AI insights with extended details\r\nconst mockInsights: Insight[] = [\r\n  {\r\n    id: 1,\r\n    type: 'opportunity',\r\n    priority: 'high',\r\n    title: 'High-performing audience segment identified',\r\n    description:\r\n      'Users aged 25-34 in urban areas show 45% higher conversion rate. Consider increasing budget allocation.',\r\n    impact: '+$12,500 estimated monthly revenue',\r\n    campaign: 'Summer Sale 2024',\r\n    // Extended details for modal\r\n    fullDescription:\r\n      'Our AI analysis has identified a high-value audience segment that is significantly outperforming other demographics. Users aged 25-34 in urban metropolitan areas are converting at 4.2% compared to the campaign average of 2.9%. This segment also shows higher average order values ($127 vs $89) and lower cost per acquisition ($18 vs $31).',\r\n    metrics: {\r\n      conversionRate: { current: 4.2, average: 2.9, change: 45 },\r\n      avgOrderValue: { current: 127, average: 89, change: 43 },\r\n      cpa: { current: 18, average: 31, change: -42 },\r\n      audienceSize: 245000,\r\n      potentialReach: 890000,\r\n    },\r\n    recommendations: [\r\n      'Increase budget allocation by 30% for this segment',\r\n      'Create dedicated ad creatives for urban millennials',\r\n      'Test lookalike audiences based on this segment',\r\n      'Implement retargeting campaigns for non-converters',\r\n    ],\r\n    historicalData: [\r\n      { date: 'Week 1', performance: 2.8 },\r\n      { date: 'Week 2', performance: 3.1 },\r\n      { date: 'Week 3', performance: 3.6 },\r\n      { date: 'Week 4', performance: 4.2 },\r\n    ],\r\n    confidence: 92,\r\n    detectedAt: '2 hours ago',\r\n  },\r\n  {\r\n    id: 2,\r\n    type: 'warning',\r\n    priority: 'medium',\r\n    title: 'Creative fatigue detected',\r\n    description:\r\n      'Banner \"Summer_v3\" has been shown 2.3M times. CTR dropped 23% in the last 7 days.',\r\n    impact: '-$3,200 estimated loss if unchanged',\r\n    campaign: 'Brand Awareness Q4',\r\n    fullDescription:\r\n      'The creative asset \"Summer_v3\" has reached saturation with your target audience. Frequency has exceeded optimal levels (7.2 vs recommended 4.0), and engagement metrics are declining rapidly. Immediate creative refresh is recommended to prevent further performance degradation.',\r\n    metrics: {\r\n      impressions: { current: 2300000, threshold: 1500000, change: 53 },\r\n      ctr: { current: 1.8, previous: 2.3, change: -23 },\r\n      frequency: { current: 7.2, optimal: 4.0, change: 80 },\r\n      estimatedLoss: 3200,\r\n    },\r\n    recommendations: [\r\n      'Pause current creative immediately',\r\n      'Rotate in 2-3 new creative variants',\r\n      'A/B test new creatives with fresh audiences',\r\n      'Set up automated creative rotation rules',\r\n    ],\r\n    historicalData: [\r\n      { date: 'Week 1', performance: 2.4 },\r\n      { date: 'Week 2', performance: 2.3 },\r\n      { date: 'Week 3', performance: 2.1 },\r\n      { date: 'Week 4', performance: 1.8 },\r\n    ],\r\n    confidence: 88,\r\n    detectedAt: '6 hours ago',\r\n  },\r\n  {\r\n    id: 3,\r\n    type: 'suggestion',\r\n    priority: 'low',\r\n    title: 'Optimal bidding time identified',\r\n    description:\r\n      'Historical data shows 18% better CPC between 6-9 PM. Consider dayparting adjustments.',\r\n    impact: '+$890 estimated monthly savings',\r\n    campaign: 'All campaigns',\r\n    fullDescription:\r\n      'Analysis of 90 days of bidding data reveals consistent patterns in cost efficiency. Evening hours (6-9 PM local time) show significantly lower competition and better conversion rates. Implementing dayparting could reduce your overall CPC while maintaining conversion volume.',\r\n    metrics: {\r\n      cpcPeak: { current: 2.45, offPeak: 2.01, savings: 18 },\r\n      conversionsPeak: { current: 312, projected: 298, change: -4 },\r\n      monthlySavings: 890,\r\n      optimalHours: '6PM - 9PM',\r\n    },\r\n    recommendations: [\r\n      'Increase bids by 15% during 6-9 PM',\r\n      'Reduce bids by 20% during 2-5 AM',\r\n      'Set up automated dayparting rules',\r\n      'Monitor for 2 weeks before full rollout',\r\n    ],\r\n    historicalData: [\r\n      { date: '6AM', performance: 2.8 },\r\n      { date: '12PM', performance: 2.4 },\r\n      { date: '6PM', performance: 2.0 },\r\n      { date: '9PM', performance: 2.1 },\r\n    ],\r\n    confidence: 76,\r\n    detectedAt: '1 day ago',\r\n  },\r\n];\r\n\r\n// Mock prediction data\r\nconst mockPredictionData = Array.from({ length: 14 }, (_, i) => {\r\n  const date = new Date();\r\n  date.setDate(date.getDate() + i - 7);\r\n  const isPast = i < 7;\r\n  return {\r\n    date: date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),\r\n    actual: isPast ? 4500 + Math.random() * 1500 + i * 100 : null,\r\n    predicted: 4200 + Math.random() * 800 + i * 150,\r\n    lowerBound: 3800 + Math.random() * 500 + i * 120,\r\n    upperBound: 4800 + Math.random() * 800 + i * 180,\r\n  };\r\n});\r\n\r\n// Mock attribution data\r\nconst mockAttributionData = [\r\n  { name: 'First Touch', value: 35, color: '#0ea5e9' },\r\n  { name: 'Last Touch', value: 28, color: '#10b981' },\r\n  { name: 'Linear', value: 22, color: '#f59e0b' },\r\n  { name: 'Time Decay', value: 15, color: '#8b5cf6' },\r\n];\r\n\r\n// Type for anomaly - defined early for mock data typing\r\ninterface Anomaly {\r\n  id: number;\r\n  date: string;\r\n  metric: string;\r\n  value: number;\r\n  expected: number;\r\n  deviation: string;\r\n  type: string;\r\n  fullDescription?: string;\r\n  campaign?: string;\r\n  adGroup?: string;\r\n  platform?: string;\r\n  severity?: string;\r\n  historicalData?: Array<{ date: string; value: number }>;\r\n  possibleCauses?: string[];\r\n  suggestedActions?: string[];\r\n  relatedMetrics?: Record<string, { value: number; change: number }>;\r\n  detectedAt?: string;\r\n  confidence?: number;\r\n}\r\n\r\n// Mock anomaly data with extended details\r\nconst mockAnomalies: Anomaly[] = [\r\n  {\r\n    id: 1,\r\n    date: 'Nov 28',\r\n    metric: 'CTR',\r\n    value: 4.2,\r\n    expected: 2.8,\r\n    deviation: '+50%',\r\n    type: 'positive',\r\n    // Extended details\r\n    fullDescription:\r\n      'Click-through rate spiked significantly above the expected baseline. This anomaly was detected across multiple ad groups in your \"Summer Sale 2024\" campaign. The spike correlates with a viral social media mention of your brand.',\r\n    campaign: 'Summer Sale 2024',\r\n    adGroup: 'Urban Millennials',\r\n    platform: 'Meta',\r\n    severity: 'high',\r\n    historicalData: [\r\n      { date: 'Nov 22', value: 2.6 },\r\n      { date: 'Nov 23', value: 2.7 },\r\n      { date: 'Nov 24', value: 2.9 },\r\n      { date: 'Nov 25', value: 2.8 },\r\n      { date: 'Nov 26', value: 3.1 },\r\n      { date: 'Nov 27', value: 3.4 },\r\n      { date: 'Nov 28', value: 4.2 },\r\n    ],\r\n    possibleCauses: [\r\n      'Viral social media mention detected on Twitter/X',\r\n      'Competitor went offline during this period',\r\n      'New creative variant showing strong engagement',\r\n      'Seasonal trend alignment',\r\n    ],\r\n    suggestedActions: [\r\n      'Scale budget by 25% to capitalize on momentum',\r\n      'Create lookalike audience from engaged users',\r\n      'Document successful creative for future campaigns',\r\n      'Set up automated scaling rules for similar events',\r\n    ],\r\n    relatedMetrics: {\r\n      impressions: { value: 125000, change: 12 },\r\n      clicks: { value: 5250, change: 68 },\r\n      conversions: { value: 312, change: 45 },\r\n      spend: { value: 2450, change: 15 },\r\n    },\r\n    detectedAt: '2 hours ago',\r\n    confidence: 94,\r\n  },\r\n  {\r\n    id: 2,\r\n    date: 'Nov 26',\r\n    metric: 'CPA',\r\n    value: 28.5,\r\n    expected: 18.2,\r\n    deviation: '+56%',\r\n    type: 'negative',\r\n    fullDescription:\r\n      'Cost per acquisition increased sharply, indicating potential issues with audience targeting or ad relevance. This spike occurred primarily in the \"Brand Awareness Q4\" campaign, specifically in the retargeting ad group.',\r\n    campaign: 'Brand Awareness Q4',\r\n    adGroup: 'Retargeting - Cart Abandoners',\r\n    platform: 'Google Ads',\r\n    severity: 'critical',\r\n    historicalData: [\r\n      { date: 'Nov 20', value: 17.8 },\r\n      { date: 'Nov 21', value: 18.1 },\r\n      { date: 'Nov 22', value: 18.5 },\r\n      { date: 'Nov 23', value: 19.2 },\r\n      { date: 'Nov 24', value: 22.1 },\r\n      { date: 'Nov 25', value: 25.3 },\r\n      { date: 'Nov 26', value: 28.5 },\r\n    ],\r\n    possibleCauses: [\r\n      'Audience fatigue in retargeting segment',\r\n      'Increased competition during Black Friday period',\r\n      'Landing page performance degradation detected',\r\n      'Ad relevance score dropped from 8 to 5',\r\n    ],\r\n    suggestedActions: [\r\n      'Pause underperforming ad groups immediately',\r\n      'Refresh creative assets in retargeting campaigns',\r\n      'Review and optimize landing page load time',\r\n      'Adjust bid strategy to target CPA mode',\r\n    ],\r\n    relatedMetrics: {\r\n      impressions: { value: 89000, change: -5 },\r\n      clicks: { value: 1890, change: -18 },\r\n      conversions: { value: 66, change: -34 },\r\n      spend: { value: 1881, change: 8 },\r\n    },\r\n    detectedAt: '1 day ago',\r\n    confidence: 89,\r\n  },\r\n  {\r\n    id: 3,\r\n    date: 'Nov 24',\r\n    metric: 'Conversions',\r\n    value: 156,\r\n    expected: 89,\r\n    deviation: '+75%',\r\n    type: 'positive',\r\n    fullDescription:\r\n      'Conversion volume exceeded expectations by a significant margin. This surge was driven by strong performance in the \"Holiday Promotions\" campaign, particularly from email retargeting and organic search traffic.',\r\n    campaign: 'Holiday Promotions',\r\n    adGroup: 'Email Retargeting',\r\n    platform: 'Multi-channel',\r\n    severity: 'medium',\r\n    historicalData: [\r\n      { date: 'Nov 18', value: 78 },\r\n      { date: 'Nov 19', value: 82 },\r\n      { date: 'Nov 20', value: 85 },\r\n      { date: 'Nov 21', value: 91 },\r\n      { date: 'Nov 22', value: 112 },\r\n      { date: 'Nov 23', value: 134 },\r\n      { date: 'Nov 24', value: 156 },\r\n    ],\r\n    possibleCauses: [\r\n      'Black Friday early access promotion launched',\r\n      'Email campaign achieved 45% open rate',\r\n      'Organic search rankings improved for key terms',\r\n      'Referral traffic spike from partner website',\r\n    ],\r\n    suggestedActions: [\r\n      'Extend promotion period by 48 hours',\r\n      'Increase inventory allocation for top products',\r\n      'Send follow-up email to engaged non-converters',\r\n      'Document winning email subject lines',\r\n    ],\r\n    relatedMetrics: {\r\n      impressions: { value: 234000, change: 28 },\r\n      clicks: { value: 12400, change: 42 },\r\n      revenue: { value: 18720, change: 82 },\r\n      roas: { value: 4.8, change: 35 },\r\n    },\r\n    detectedAt: '3 days ago',\r\n    confidence: 91,\r\n  },\r\n];\r\n\r\n// Insight Detail Modal Component\r\nfunction InsightDetailModal({\r\n  insight,\r\n  onClose,\r\n  onApply,\r\n}: {\r\n  insight: Insight | null;\r\n  onClose: () => void;\r\n  onApply: (insight: Insight) => void;\r\n}) {\r\n  const [isApplying, setIsApplying] = useState(false);\r\n\r\n  if (!insight) return null;\r\n\r\n  const handleApply = async () => {\r\n    setIsApplying(true);\r\n    // Simulate API call\r\n    await new Promise((resolve) => setTimeout(resolve, 1500));\r\n    onApply(insight);\r\n    setIsApplying(false);\r\n  };\r\n\r\n  const getTypeColor = (type: string) => {\r\n    switch (type) {\r\n      case 'opportunity':\r\n        return 'text-green-500 bg-green-500/10';\r\n      case 'warning':\r\n        return 'text-amber-500 bg-amber-500/10';\r\n      case 'suggestion':\r\n        return 'text-blue-500 bg-blue-500/10';\r\n      default:\r\n        return 'text-primary bg-primary/10';\r\n    }\r\n  };\r\n\r\n  const getTypeIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'opportunity':\r\n        return <Lightbulb className=\"w-5 h-5\" />;\r\n      case 'warning':\r\n        return <AlertTriangle className=\"w-5 h-5\" />;\r\n      case 'suggestion':\r\n        return <Sparkles className=\"w-5 h-5\" />;\r\n      default:\r\n        return <Brain className=\"w-5 h-5\" />;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-end\">\r\n      {/* Backdrop */}\r\n      <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" onClick={onClose} />\r\n\r\n      {/* Slide-over Panel */}\r\n      <div className=\"relative w-full max-w-xl h-full bg-background shadow-2xl overflow-y-auto animate-in slide-in-from-right duration-300\">\r\n        {/* Header */}\r\n        <div className=\"sticky top-0 bg-background border-b px-6 py-4 flex items-start justify-between\">\r\n          <div className=\"flex items-start gap-3\">\r\n            <div className={cn('p-2 rounded-lg', getTypeColor(insight.type))}>\r\n              {getTypeIcon(insight.type)}\r\n            </div>\r\n            <div>\r\n              <h2 className=\"font-semibold text-lg\">{insight.title}</h2>\r\n              <div className=\"flex items-center gap-2 mt-1\">\r\n                <span\r\n                  className={cn(\r\n                    'px-2 py-0.5 rounded-full text-xs font-medium',\r\n                    insight.priority === 'high'\r\n                      ? 'bg-red-500/10 text-red-500'\r\n                      : insight.priority === 'medium'\r\n                        ? 'bg-amber-500/10 text-amber-500'\r\n                        : 'bg-blue-500/10 text-blue-500'\r\n                  )}\r\n                >\r\n                  {insight.priority.charAt(0).toUpperCase() + insight.priority.slice(1)} Priority\r\n                </span>\r\n                <span className=\"text-xs text-muted-foreground flex items-center gap-1\">\r\n                  <Clock className=\"w-3 h-3\" />\r\n                  {insight.detectedAt || 'Recently'}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <button onClick={onClose} className=\"p-2 rounded-lg hover:bg-muted transition-colors\">\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Campaign Badge */}\r\n          <div className=\"flex items-center gap-2 p-3 rounded-lg bg-muted/50\">\r\n            <Target className=\"w-4 h-4 text-muted-foreground\" />\r\n            <span className=\"text-sm\">\r\n              Campaign: <span className=\"font-medium\">{insight.campaign}</span>\r\n            </span>\r\n          </div>\r\n\r\n          {/* Full Description */}\r\n          <div>\r\n            <h3 className=\"font-medium mb-2 flex items-center gap-2\">\r\n              <Brain className=\"w-4 h-4 text-primary\" />\r\n              AI Analysis\r\n            </h3>\r\n            <p className=\"text-sm text-muted-foreground leading-relaxed\">\r\n              {insight.fullDescription || insight.description}\r\n            </p>\r\n          </div>\r\n\r\n          {/* Impact */}\r\n          <div className=\"p-4 rounded-lg border bg-card\">\r\n            <div className=\"flex items-center justify-between\">\r\n              <span className=\"text-sm text-muted-foreground\">Estimated Impact</span>\r\n              <span\r\n                className={cn(\r\n                  'text-lg font-bold',\r\n                  insight.impact.startsWith('+') ? 'text-green-500' : 'text-red-500'\r\n                )}\r\n              >\r\n                {insight.impact}\r\n              </span>\r\n            </div>\r\n            {insight.confidence && (\r\n              <div className=\"mt-3 pt-3 border-t\">\r\n                <div className=\"flex items-center justify-between text-sm\">\r\n                  <span className=\"text-muted-foreground\">AI Confidence</span>\r\n                  <span className=\"font-medium\">{insight.confidence}%</span>\r\n                </div>\r\n                <div className=\"mt-2 h-2 rounded-full bg-muted overflow-hidden\">\r\n                  <div\r\n                    className=\"h-full bg-primary rounded-full transition-all\"\r\n                    style={{ width: `${insight.confidence}%` }}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Key Metrics */}\r\n          {insight.metrics && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <BarChart3 className=\"w-4 h-4 text-primary\" />\r\n                Key Metrics\r\n              </h3>\r\n              <div className=\"grid grid-cols-2 gap-3\">\r\n                {insight.type === 'opportunity' && insight.metrics.conversionRate && (\r\n                  <>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Conversion Rate</p>\r\n                      <p className=\"text-lg font-semibold\">\r\n                        {insight.metrics.conversionRate.current}%\r\n                      </p>\r\n                      <p className=\"text-xs text-green-500\">\r\n                        +{insight.metrics.conversionRate.change}% vs avg\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Avg Order Value</p>\r\n                      <p className=\"text-lg font-semibold\">\r\n                        ${insight.metrics.avgOrderValue.current}\r\n                      </p>\r\n                      <p className=\"text-xs text-green-500\">\r\n                        +{insight.metrics.avgOrderValue.change}% vs avg\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Cost Per Acquisition</p>\r\n                      <p className=\"text-lg font-semibold\">${insight.metrics.cpa.current}</p>\r\n                      <p className=\"text-xs text-green-500\">{insight.metrics.cpa.change}% vs avg</p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Audience Size</p>\r\n                      <p className=\"text-lg font-semibold\">\r\n                        {formatCompactNumber(insight.metrics.audienceSize)}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {formatCompactNumber(insight.metrics.potentialReach)} potential\r\n                      </p>\r\n                    </div>\r\n                  </>\r\n                )}\r\n                {insight.type === 'warning' && insight.metrics.ctr && (\r\n                  <>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Current CTR</p>\r\n                      <p className=\"text-lg font-semibold\">{insight.metrics.ctr.current}%</p>\r\n                      <p className=\"text-xs text-red-500\">{insight.metrics.ctr.change}% decline</p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Frequency</p>\r\n                      <p className=\"text-lg font-semibold\">{insight.metrics.frequency.current}x</p>\r\n                      <p className=\"text-xs text-amber-500\">\r\n                        Optimal: {insight.metrics.frequency.optimal}x\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Total Impressions</p>\r\n                      <p className=\"text-lg font-semibold\">\r\n                        {formatCompactNumber(insight.metrics.impressions.current)}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        Threshold: {formatCompactNumber(insight.metrics.impressions.threshold)}\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Est. Weekly Loss</p>\r\n                      <p className=\"text-lg font-semibold text-red-500\">\r\n                        -${formatCompactNumber(insight.metrics.estimatedLoss)}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground\">If unchanged</p>\r\n                    </div>\r\n                  </>\r\n                )}\r\n                {insight.type === 'suggestion' && insight.metrics.cpcPeak && (\r\n                  <>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Peak CPC</p>\r\n                      <p className=\"text-lg font-semibold\">${insight.metrics.cpcPeak.current}</p>\r\n                      <p className=\"text-xs text-muted-foreground\">During busy hours</p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Off-Peak CPC</p>\r\n                      <p className=\"text-lg font-semibold\">${insight.metrics.cpcPeak.offPeak}</p>\r\n                      <p className=\"text-xs text-green-500\">\r\n                        {insight.metrics.cpcPeak.savings}% savings\r\n                      </p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Optimal Hours</p>\r\n                      <p className=\"text-lg font-semibold\">{insight.metrics.optimalHours}</p>\r\n                      <p className=\"text-xs text-muted-foreground\">Local time</p>\r\n                    </div>\r\n                    <div className=\"p-3 rounded-lg border bg-card\">\r\n                      <p className=\"text-xs text-muted-foreground\">Monthly Savings</p>\r\n                      <p className=\"text-lg font-semibold text-green-500\">\r\n                        +${insight.metrics.monthlySavings}\r\n                      </p>\r\n                      <p className=\"text-xs text-muted-foreground\">Estimated</p>\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Performance Trend */}\r\n          {insight.historicalData && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <TrendingUp className=\"w-4 h-4 text-primary\" />\r\n                Performance Trend\r\n              </h3>\r\n              <div className=\"h-[120px]\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                  <LineChart data={insight.historicalData}>\r\n                    <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\r\n                    <XAxis\r\n                      dataKey=\"date\"\r\n                      tick={{ fontSize: 11 }}\r\n                      tickLine={false}\r\n                      axisLine={false}\r\n                    />\r\n                    <YAxis tick={{ fontSize: 11 }} tickLine={false} axisLine={false} />\r\n                    <Tooltip\r\n                      contentStyle={{\r\n                        backgroundColor: 'hsl(var(--card))',\r\n                        border: '1px solid hsl(var(--border))',\r\n                        borderRadius: '0.5rem',\r\n                      }}\r\n                    />\r\n                    <Line\r\n                      type=\"monotone\"\r\n                      dataKey=\"performance\"\r\n                      stroke={insight.type === 'warning' ? '#ef4444' : '#10b981'}\r\n                      strokeWidth={2}\r\n                      dot={{\r\n                        fill: insight.type === 'warning' ? '#ef4444' : '#10b981',\r\n                        strokeWidth: 0,\r\n                        r: 4,\r\n                      }}\r\n                    />\r\n                  </LineChart>\r\n                </ResponsiveContainer>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Recommendations */}\r\n          {insight.recommendations && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <Zap className=\"w-4 h-4 text-primary\" />\r\n                Recommended Actions\r\n              </h3>\r\n              <ul className=\"space-y-2\">\r\n                {insight.recommendations.map((rec, idx) => (\r\n                  <li key={idx} className=\"flex items-start gap-2 text-sm\">\r\n                    <CheckCircle2 className=\"w-4 h-4 text-green-500 mt-0.5 flex-shrink-0\" />\r\n                    <span>{rec}</span>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer Actions */}\r\n        <div className=\"sticky bottom-0 bg-background border-t px-6 py-4 flex items-center gap-3\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"flex-1 px-4 py-2.5 rounded-lg border hover:bg-muted transition-colors\"\r\n          >\r\n            Dismiss\r\n          </button>\r\n          <button\r\n            onClick={handleApply}\r\n            disabled={isApplying}\r\n            className={cn(\r\n              'flex-1 px-4 py-2.5 rounded-lg font-medium transition-colors flex items-center justify-center gap-2',\r\n              insight.type === 'warning'\r\n                ? 'bg-amber-500 hover:bg-amber-600 text-white'\r\n                : 'bg-primary hover:bg-primary/90 text-primary-foreground'\r\n            )}\r\n          >\r\n            {isApplying ? (\r\n              <>\r\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                Applying...\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Zap className=\"w-4 h-4\" />\r\n                {insight.type === 'warning' ? 'Fix Issue' : 'Apply Recommendation'}\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Anomaly Detail Modal Component\r\nfunction AnomalyDetailModal({\r\n  anomaly,\r\n  onClose,\r\n  onAction,\r\n}: {\r\n  anomaly: Anomaly | null;\r\n  onClose: () => void;\r\n  onAction: (anomaly: Anomaly, action: string) => void;\r\n}) {\r\n  const [selectedAction, setSelectedAction] = useState<string | null>(null);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  if (!anomaly) return null;\r\n\r\n  const handleAction = async (action: string) => {\r\n    setSelectedAction(action);\r\n    setIsProcessing(true);\r\n    // Simulate API call\r\n    await new Promise((resolve) => setTimeout(resolve, 1500));\r\n    onAction(anomaly, action);\r\n    setIsProcessing(false);\r\n    setSelectedAction(null);\r\n  };\r\n\r\n  const isPositive = anomaly.type === 'positive';\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-end\">\r\n      {/* Backdrop */}\r\n      <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" onClick={onClose} />\r\n\r\n      {/* Slide-over Panel */}\r\n      <div className=\"relative w-full max-w-xl h-full bg-background shadow-2xl overflow-y-auto animate-in slide-in-from-right duration-300\">\r\n        {/* Header */}\r\n        <div\r\n          className={cn(\r\n            'sticky top-0 border-b px-6 py-4 flex items-start justify-between',\r\n            isPositive ? 'bg-green-500/5' : 'bg-red-500/5'\r\n          )}\r\n        >\r\n          <div className=\"flex items-start gap-3\">\r\n            <div\r\n              className={cn(\r\n                'p-2 rounded-lg',\r\n                isPositive ? 'bg-green-500/10 text-green-500' : 'bg-red-500/10 text-red-500'\r\n              )}\r\n            >\r\n              {isPositive ? (\r\n                <TrendingUp className=\"w-5 h-5\" />\r\n              ) : (\r\n                <AlertTriangle className=\"w-5 h-5\" />\r\n              )}\r\n            </div>\r\n            <div>\r\n              <h2 className=\"font-semibold text-lg\">{anomaly.metric} Anomaly Detected</h2>\r\n              <div className=\"flex items-center gap-2 mt-1\">\r\n                <span\r\n                  className={cn(\r\n                    'px-2 py-0.5 rounded-full text-xs font-medium',\r\n                    isPositive ? 'bg-green-500/10 text-green-500' : 'bg-red-500/10 text-red-500'\r\n                  )}\r\n                >\r\n                  {isPositive ? 'Positive' : 'Negative'} Anomaly\r\n                </span>\r\n                <span\r\n                  className={cn(\r\n                    'px-2 py-0.5 rounded-full text-xs font-medium',\r\n                    anomaly.severity === 'critical'\r\n                      ? 'bg-red-500/10 text-red-500'\r\n                      : anomaly.severity === 'high'\r\n                        ? 'bg-amber-500/10 text-amber-500'\r\n                        : 'bg-blue-500/10 text-blue-500'\r\n                  )}\r\n                >\r\n                  {anomaly.severity?.charAt(0).toUpperCase()}\r\n                  {anomaly.severity?.slice(1)} Severity\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <button onClick={onClose} className=\"p-2 rounded-lg hover:bg-muted transition-colors\">\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6 space-y-6\">\r\n          {/* Detection Info */}\r\n          <div className=\"grid grid-cols-2 gap-3\">\r\n            <div className=\"p-3 rounded-lg bg-muted/50\">\r\n              <p className=\"text-xs text-muted-foreground\">Detected</p>\r\n              <p className=\"font-medium flex items-center gap-1\">\r\n                <Clock className=\"w-3 h-3\" />\r\n                {anomaly.detectedAt || anomaly.date}\r\n              </p>\r\n            </div>\r\n            <div className=\"p-3 rounded-lg bg-muted/50\">\r\n              <p className=\"text-xs text-muted-foreground\">Platform</p>\r\n              <p className=\"font-medium\">{anomaly.platform || 'Multi-channel'}</p>\r\n            </div>\r\n            <div className=\"p-3 rounded-lg bg-muted/50\">\r\n              <p className=\"text-xs text-muted-foreground\">Campaign</p>\r\n              <p className=\"font-medium\">{anomaly.campaign || 'All Campaigns'}</p>\r\n            </div>\r\n            <div className=\"p-3 rounded-lg bg-muted/50\">\r\n              <p className=\"text-xs text-muted-foreground\">Ad Group</p>\r\n              <p className=\"font-medium\">{anomaly.adGroup || 'All Ad Groups'}</p>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Metric Comparison */}\r\n          <div\r\n            className={cn(\r\n              'p-4 rounded-lg border',\r\n              isPositive ? 'border-green-500/30 bg-green-500/5' : 'border-red-500/30 bg-red-500/5'\r\n            )}\r\n          >\r\n            <div className=\"flex items-center justify-between mb-3\">\r\n              <span className=\"text-sm font-medium\">{anomaly.metric} Value</span>\r\n              <span\r\n                className={cn('text-2xl font-bold', isPositive ? 'text-green-500' : 'text-red-500')}\r\n              >\r\n                {anomaly.deviation}\r\n              </span>\r\n            </div>\r\n            <div className=\"grid grid-cols-2 gap-4\">\r\n              <div>\r\n                <p className=\"text-xs text-muted-foreground\">Actual</p>\r\n                <p className=\"text-lg font-semibold\">{anomaly.value}</p>\r\n              </div>\r\n              <div>\r\n                <p className=\"text-xs text-muted-foreground\">Expected</p>\r\n                <p className=\"text-lg font-semibold text-muted-foreground\">{anomaly.expected}</p>\r\n              </div>\r\n            </div>\r\n            {anomaly.confidence && (\r\n              <div className=\"mt-3 pt-3 border-t border-current/10\">\r\n                <div className=\"flex items-center justify-between text-sm\">\r\n                  <span className=\"text-muted-foreground\">Detection Confidence</span>\r\n                  <span className=\"font-medium\">{anomaly.confidence}%</span>\r\n                </div>\r\n                <div className=\"mt-2 h-2 rounded-full bg-background overflow-hidden\">\r\n                  <div\r\n                    className={cn(\r\n                      'h-full rounded-full transition-all',\r\n                      isPositive ? 'bg-green-500' : 'bg-red-500'\r\n                    )}\r\n                    style={{ width: `${anomaly.confidence}%` }}\r\n                  />\r\n                </div>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Full Description */}\r\n          <div>\r\n            <h3 className=\"font-medium mb-2 flex items-center gap-2\">\r\n              <Brain className=\"w-4 h-4 text-primary\" />\r\n              AI Analysis\r\n            </h3>\r\n            <p className=\"text-sm text-muted-foreground leading-relaxed\">\r\n              {anomaly.fullDescription ||\r\n                `${anomaly.metric} showed a ${anomaly.deviation} deviation from expected values.`}\r\n            </p>\r\n          </div>\r\n\r\n          {/* Historical Trend */}\r\n          {anomaly.historicalData && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <BarChart3 className=\"w-4 h-4 text-primary\" />\r\n                7-Day Trend\r\n              </h3>\r\n              <div className=\"h-[140px]\">\r\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                  <AreaChart data={anomaly.historicalData}>\r\n                    <defs>\r\n                      <linearGradient id={`gradient-${anomaly.id}`} x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                        <stop\r\n                          offset=\"5%\"\r\n                          stopColor={isPositive ? '#10b981' : '#ef4444'}\r\n                          stopOpacity={0.3}\r\n                        />\r\n                        <stop\r\n                          offset=\"95%\"\r\n                          stopColor={isPositive ? '#10b981' : '#ef4444'}\r\n                          stopOpacity={0}\r\n                        />\r\n                      </linearGradient>\r\n                    </defs>\r\n                    <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\r\n                    <XAxis\r\n                      dataKey=\"date\"\r\n                      tick={{ fontSize: 11 }}\r\n                      tickLine={false}\r\n                      axisLine={false}\r\n                    />\r\n                    <YAxis tick={{ fontSize: 11 }} tickLine={false} axisLine={false} />\r\n                    <Tooltip\r\n                      contentStyle={{\r\n                        backgroundColor: 'hsl(var(--card))',\r\n                        border: '1px solid hsl(var(--border))',\r\n                        borderRadius: '0.5rem',\r\n                      }}\r\n                    />\r\n                    <Area\r\n                      type=\"monotone\"\r\n                      dataKey=\"value\"\r\n                      stroke={isPositive ? '#10b981' : '#ef4444'}\r\n                      strokeWidth={2}\r\n                      fill={`url(#gradient-${anomaly.id})`}\r\n                    />\r\n                  </AreaChart>\r\n                </ResponsiveContainer>\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Related Metrics */}\r\n          {anomaly.relatedMetrics && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <Target className=\"w-4 h-4 text-primary\" />\r\n                Related Metrics\r\n              </h3>\r\n              <div className=\"grid grid-cols-2 gap-3\">\r\n                {Object.entries(anomaly.relatedMetrics).map(([key, data]) => (\r\n                  <div key={key} className=\"p-3 rounded-lg border bg-card\">\r\n                    <p className=\"text-xs text-muted-foreground capitalize\">{key}</p>\r\n                    <p className=\"text-lg font-semibold\">\r\n                      {key === 'spend' || key === 'revenue' ? '$' : ''}\r\n                      {formatCompactNumber(data.value)}\r\n                    </p>\r\n                    <p\r\n                      className={cn('text-xs', data.change > 0 ? 'text-green-500' : 'text-red-500')}\r\n                    >\r\n                      {data.change > 0 ? '+' : ''}\r\n                      {data.change}%\r\n                    </p>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </div>\r\n          )}\r\n\r\n          {/* Possible Causes */}\r\n          {anomaly.possibleCauses && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <AlertTriangle className=\"w-4 h-4 text-amber-500\" />\r\n                Possible Causes\r\n              </h3>\r\n              <ul className=\"space-y-2\">\r\n                {anomaly.possibleCauses.map((cause, idx) => (\r\n                  <li key={idx} className=\"flex items-start gap-2 text-sm\">\r\n                    <span className=\"w-5 h-5 rounded-full bg-muted flex items-center justify-center text-xs flex-shrink-0\">\r\n                      {idx + 1}\r\n                    </span>\r\n                    <span>{cause}</span>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n\r\n          {/* Suggested Actions */}\r\n          {anomaly.suggestedActions && (\r\n            <div>\r\n              <h3 className=\"font-medium mb-3 flex items-center gap-2\">\r\n                <Zap className=\"w-4 h-4 text-primary\" />\r\n                Suggested Actions\r\n              </h3>\r\n              <ul className=\"space-y-2\">\r\n                {anomaly.suggestedActions.map((action, idx) => (\r\n                  <li key={idx} className=\"flex items-start gap-2 text-sm\">\r\n                    <CheckCircle2\r\n                      className={cn(\r\n                        'w-4 h-4 mt-0.5 flex-shrink-0',\r\n                        isPositive ? 'text-green-500' : 'text-amber-500'\r\n                      )}\r\n                    />\r\n                    <span>{action}</span>\r\n                  </li>\r\n                ))}\r\n              </ul>\r\n            </div>\r\n          )}\r\n        </div>\r\n\r\n        {/* Footer Actions */}\r\n        <div className=\"sticky bottom-0 bg-background border-t px-6 py-4 flex items-center gap-3\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"flex-1 px-4 py-2.5 rounded-lg border hover:bg-muted transition-colors\"\r\n          >\r\n            Dismiss\r\n          </button>\r\n          <button\r\n            onClick={() => handleAction('reviewed')}\r\n            disabled={isProcessing}\r\n            className=\"flex-1 px-4 py-2.5 rounded-lg border hover:bg-muted transition-colors flex items-center justify-center gap-2\"\r\n          >\r\n            {isProcessing && selectedAction === 'reviewed' ? (\r\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n            ) : (\r\n              <CheckCircle2 className=\"w-4 h-4\" />\r\n            )}\r\n            Mark Reviewed\r\n          </button>\r\n          <button\r\n            onClick={() => handleAction('alert')}\r\n            disabled={isProcessing}\r\n            className={cn(\r\n              'flex-1 px-4 py-2.5 rounded-lg font-medium transition-colors flex items-center justify-center gap-2',\r\n              isPositive\r\n                ? 'bg-green-500 hover:bg-green-600 text-white'\r\n                : 'bg-amber-500 hover:bg-amber-600 text-white'\r\n            )}\r\n          >\r\n            {isProcessing && selectedAction === 'alert' ? (\r\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n            ) : (\r\n              <Zap className=\"w-4 h-4\" />\r\n            )}\r\n            Create Alert Rule\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Alert Rule interface\r\ninterface AlertRule {\r\n  id?: string;\r\n  name: string;\r\n  metric: string;\r\n  condition: 'above' | 'below' | 'change_above' | 'change_below';\r\n  threshold: number;\r\n  frequency: 'realtime' | 'hourly' | 'daily';\r\n  channels: {\r\n    email: boolean;\r\n    whatsapp: boolean;\r\n    inApp: boolean;\r\n    slack: boolean;\r\n  };\r\n  enabled: boolean;\r\n}\r\n\r\n// Alert Configuration Modal Component\r\nfunction AlertConfigurationModal({\r\n  anomaly,\r\n  existingAlert,\r\n  mode = 'create',\r\n  onClose,\r\n  onSave,\r\n}: {\r\n  anomaly?: Anomaly | null;\r\n  existingAlert?: AlertRule | null;\r\n  mode?: 'create' | 'edit' | 'duplicate';\r\n  onClose: () => void;\r\n  onSave: (rule: AlertRule, isEdit: boolean) => void;\r\n}) {\r\n  const [isSaving, setIsSaving] = useState(false);\r\n  const [hasChanges, setHasChanges] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // Initialize alert rule based on mode\r\n  const getInitialAlertRule = (): AlertRule => {\r\n    if (existingAlert) {\r\n      if (mode === 'duplicate') {\r\n        return {\r\n          ...existingAlert,\r\n          id: undefined, // Remove ID for duplicate\r\n          name: `Copy of ${existingAlert.name}`,\r\n        };\r\n      }\r\n      return { ...existingAlert };\r\n    }\r\n    if (anomaly) {\r\n      return {\r\n        name: `${anomaly.metric} Alert`,\r\n        metric: anomaly.metric || 'CTR',\r\n        condition: anomaly.type === 'negative' ? 'below' : 'above',\r\n        threshold: anomaly.expected || 0,\r\n        frequency: 'realtime',\r\n        channels: {\r\n          email: true,\r\n          whatsapp: false,\r\n          inApp: true,\r\n          slack: false,\r\n        },\r\n        enabled: true,\r\n      };\r\n    }\r\n    return {\r\n      name: 'New Alert',\r\n      metric: 'CTR',\r\n      condition: 'above',\r\n      threshold: 0,\r\n      frequency: 'realtime',\r\n      channels: {\r\n        email: true,\r\n        whatsapp: false,\r\n        inApp: true,\r\n        slack: false,\r\n      },\r\n      enabled: true,\r\n    };\r\n  };\r\n\r\n  const [alertRule, setAlertRule] = useState<AlertRule>(getInitialAlertRule());\r\n  const [originalName] = useState(existingAlert?.name || '');\r\n\r\n  if (!anomaly && !existingAlert) return null;\r\n\r\n  const handleSave = async () => {\r\n    // Validate duplicate - must have changes\r\n    if (mode === 'duplicate' && !hasChanges) {\r\n      setError('Please modify the alert before saving. Duplicate rules are not allowed.');\r\n      return;\r\n    }\r\n\r\n    // Check if name is still the same as original for duplicates\r\n    if (mode === 'duplicate' && alertRule.name === `Copy of ${originalName}`) {\r\n      setError('Please change the alert name before saving.');\r\n      return;\r\n    }\r\n\r\n    setError(null);\r\n    setIsSaving(true);\r\n    // Simulate API call\r\n    await new Promise((resolve) => setTimeout(resolve, 1500));\r\n    onSave(alertRule, mode === 'edit');\r\n    setIsSaving(false);\r\n  };\r\n\r\n  // Track changes for duplicate validation\r\n  const handleFieldChange = (updates: Partial<AlertRule>) => {\r\n    setAlertRule((prev) => ({ ...prev, ...updates }));\r\n    setHasChanges(true);\r\n    setError(null);\r\n  };\r\n\r\n  const updateChannel = (channel: keyof AlertRule['channels']) => {\r\n    setAlertRule((prev) => ({\r\n      ...prev,\r\n      channels: {\r\n        ...prev.channels,\r\n        [channel]: !prev.channels[channel],\r\n      },\r\n    }));\r\n    setHasChanges(true);\r\n    setError(null);\r\n  };\r\n\r\n  const getModalTitle = () => {\r\n    switch (mode) {\r\n      case 'edit':\r\n        return 'Edit Alert Rule';\r\n      case 'duplicate':\r\n        return 'Duplicate Alert Rule';\r\n      default:\r\n        return 'Create Alert Rule';\r\n    }\r\n  };\r\n\r\n  const getButtonText = () => {\r\n    switch (mode) {\r\n      case 'edit':\r\n        return 'Save Changes';\r\n      case 'duplicate':\r\n        return 'Create Duplicate';\r\n      default:\r\n        return 'Create Alert Rule';\r\n    }\r\n  };\r\n\r\n  const metrics = [\r\n    'CTR',\r\n    'CPA',\r\n    'CPC',\r\n    'CPM',\r\n    'ROAS',\r\n    'Conversions',\r\n    'Impressions',\r\n    'Clicks',\r\n    'Spend',\r\n    'Revenue',\r\n  ];\r\n\r\n  const conditions = [\r\n    { value: 'above', label: 'Goes above' },\r\n    { value: 'below', label: 'Goes below' },\r\n    { value: 'change_above', label: 'Changes by more than +' },\r\n    { value: 'change_below', label: 'Changes by more than -' },\r\n  ];\r\n\r\n  const frequencies = [\r\n    { value: 'realtime', label: 'Real-time', description: 'Instant notification' },\r\n    { value: 'hourly', label: 'Hourly', description: 'Digest every hour' },\r\n    { value: 'daily', label: 'Daily', description: 'Daily summary' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n      {/* Backdrop */}\r\n      <div className=\"absolute inset-0 bg-black/50 backdrop-blur-sm\" onClick={onClose} />\r\n\r\n      {/* Modal Panel */}\r\n      <div className=\"relative w-full max-w-lg bg-background rounded-xl shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200\">\r\n        {/* Header */}\r\n        <div className=\"border-b px-6 py-4 flex items-center justify-between bg-primary/5\">\r\n          <div className=\"flex items-center gap-3\">\r\n            <div className=\"p-2 rounded-lg bg-primary/10 text-primary\">\r\n              <Bell className=\"w-5 h-5\" />\r\n            </div>\r\n            <div>\r\n              <h2 className=\"font-semibold text-lg\">{getModalTitle()}</h2>\r\n              <p className=\"text-xs text-muted-foreground\">\r\n                {mode === 'duplicate'\r\n                  ? 'Modify the alert before saving'\r\n                  : 'Get notified when metrics exceed thresholds'}\r\n              </p>\r\n            </div>\r\n          </div>\r\n          <button onClick={onClose} className=\"p-2 rounded-lg hover:bg-muted transition-colors\">\r\n            <X className=\"w-5 h-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-6 space-y-5 max-h-[60vh] overflow-y-auto\">\r\n          {/* Error Message */}\r\n          {error && (\r\n            <div className=\"p-3 rounded-lg bg-red-500/10 border border-red-500/30 text-red-500 text-sm\">\r\n              {error}\r\n            </div>\r\n          )}\r\n\r\n          {/* Duplicate Warning */}\r\n          {mode === 'duplicate' && (\r\n            <div className=\"p-3 rounded-lg bg-amber-500/10 border border-amber-500/30 text-amber-600 text-sm\">\r\n              You must modify the alert name or settings before saving to avoid duplicate rules.\r\n            </div>\r\n          )}\r\n\r\n          {/* Alert Name */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">Alert Name</label>\r\n            <input\r\n              type=\"text\"\r\n              value={alertRule.name}\r\n              onChange={(e) => handleFieldChange({ name: e.target.value })}\r\n              className=\"w-full px-3 py-2 rounded-lg border bg-background focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all\"\r\n              placeholder=\"e.g., CTR Drop Alert\"\r\n            />\r\n          </div>\r\n\r\n          {/* Metric Selection */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">Metric to Monitor</label>\r\n            <select\r\n              value={alertRule.metric}\r\n              onChange={(e) => handleFieldChange({ metric: e.target.value })}\r\n              className=\"w-full px-3 py-2 rounded-lg border bg-background focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all\"\r\n            >\r\n              {metrics.map((metric) => (\r\n                <option key={metric} value={metric}>\r\n                  {metric}\r\n                </option>\r\n              ))}\r\n            </select>\r\n          </div>\r\n\r\n          {/* Condition and Threshold */}\r\n          <div className=\"grid grid-cols-2 gap-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-2\">Condition</label>\r\n              <select\r\n                value={alertRule.condition}\r\n                onChange={(e) =>\r\n                  handleFieldChange({\r\n                    condition: e.target.value as AlertRule['condition'],\r\n                  })\r\n                }\r\n                className=\"w-full px-3 py-2 rounded-lg border bg-background focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all\"\r\n              >\r\n                {conditions.map((cond) => (\r\n                  <option key={cond.value} value={cond.value}>\r\n                    {cond.label}\r\n                  </option>\r\n                ))}\r\n              </select>\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-2\">\r\n                Threshold {alertRule.condition.includes('change') ? '(%)' : ''}\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n                value={alertRule.threshold}\r\n                onChange={(e) =>\r\n                  handleFieldChange({\r\n                    threshold: parseFloat(e.target.value) || 0,\r\n                  })\r\n                }\r\n                className=\"w-full px-3 py-2 rounded-lg border bg-background focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all\"\r\n                step={alertRule.condition.includes('change') ? '1' : '0.1'}\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Alert Preview */}\r\n          <div className=\"p-4 rounded-lg border bg-muted/50\">\r\n            <p className=\"text-sm text-muted-foreground mb-1\">Alert will trigger when:</p>\r\n            <p className=\"font-medium\">\r\n              {alertRule.metric}{' '}\r\n              <span className=\"text-primary\">\r\n                {conditions.find((c) => c.value === alertRule.condition)?.label.toLowerCase()}\r\n              </span>{' '}\r\n              <span className=\"text-primary font-bold\">\r\n                {alertRule.threshold}\r\n                {alertRule.condition.includes('change') ? '%' : ''}\r\n              </span>\r\n            </p>\r\n          </div>\r\n\r\n          {/* Notification Frequency */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">Check Frequency</label>\r\n            <div className=\"grid grid-cols-3 gap-2\">\r\n              {frequencies.map((freq) => (\r\n                <button\r\n                  key={freq.value}\r\n                  onClick={() => {\r\n                    handleFieldChange({ frequency: freq.value as AlertRule['frequency'] });\r\n                  }}\r\n                  className={cn(\r\n                    'p-3 rounded-lg border text-center transition-all',\r\n                    alertRule.frequency === freq.value\r\n                      ? 'border-primary bg-primary/10 text-primary'\r\n                      : 'hover:bg-muted'\r\n                  )}\r\n                >\r\n                  <p className=\"font-medium text-sm\">{freq.label}</p>\r\n                  <p className=\"text-xs text-muted-foreground\">{freq.description}</p>\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Notification Channels */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">Notification Channels</label>\r\n            <div className=\"grid grid-cols-2 gap-3\">\r\n              <button\r\n                onClick={() => updateChannel('email')}\r\n                className={cn(\r\n                  'flex items-center gap-3 p-3 rounded-lg border transition-all',\r\n                  alertRule.channels.email ? 'border-primary bg-primary/10' : 'hover:bg-muted'\r\n                )}\r\n              >\r\n                <div\r\n                  className={cn(\r\n                    'p-2 rounded-lg',\r\n                    alertRule.channels.email ? 'bg-primary text-primary-foreground' : 'bg-muted'\r\n                  )}\r\n                >\r\n                  <Mail className=\"w-4 h-4\" />\r\n                </div>\r\n                <div className=\"text-left\">\r\n                  <p className=\"font-medium text-sm\">Email</p>\r\n                  <p className=\"text-xs text-muted-foreground\">Get email alerts</p>\r\n                </div>\r\n                {alertRule.channels.email && (\r\n                  <CheckCircle2 className=\"w-4 h-4 text-primary ml-auto\" />\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => updateChannel('whatsapp')}\r\n                className={cn(\r\n                  'flex items-center gap-3 p-3 rounded-lg border transition-all',\r\n                  alertRule.channels.whatsapp ? 'border-primary bg-primary/10' : 'hover:bg-muted'\r\n                )}\r\n              >\r\n                <div\r\n                  className={cn(\r\n                    'p-2 rounded-lg',\r\n                    alertRule.channels.whatsapp ? 'bg-green-500 text-white' : 'bg-muted'\r\n                  )}\r\n                >\r\n                  <MessageSquare className=\"w-4 h-4\" />\r\n                </div>\r\n                <div className=\"text-left\">\r\n                  <p className=\"font-medium text-sm\">WhatsApp</p>\r\n                  <p className=\"text-xs text-muted-foreground\">WhatsApp messages</p>\r\n                </div>\r\n                {alertRule.channels.whatsapp && (\r\n                  <CheckCircle2 className=\"w-4 h-4 text-green-500 ml-auto\" />\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => updateChannel('inApp')}\r\n                className={cn(\r\n                  'flex items-center gap-3 p-3 rounded-lg border transition-all',\r\n                  alertRule.channels.inApp ? 'border-primary bg-primary/10' : 'hover:bg-muted'\r\n                )}\r\n              >\r\n                <div\r\n                  className={cn(\r\n                    'p-2 rounded-lg',\r\n                    alertRule.channels.inApp ? 'bg-primary text-primary-foreground' : 'bg-muted'\r\n                  )}\r\n                >\r\n                  <Bell className=\"w-4 h-4\" />\r\n                </div>\r\n                <div className=\"text-left\">\r\n                  <p className=\"font-medium text-sm\">In-App</p>\r\n                  <p className=\"text-xs text-muted-foreground\">Push notifications</p>\r\n                </div>\r\n                {alertRule.channels.inApp && (\r\n                  <CheckCircle2 className=\"w-4 h-4 text-primary ml-auto\" />\r\n                )}\r\n              </button>\r\n\r\n              <button\r\n                onClick={() => updateChannel('slack')}\r\n                className={cn(\r\n                  'flex items-center gap-3 p-3 rounded-lg border transition-all',\r\n                  alertRule.channels.slack ? 'border-primary bg-primary/10' : 'hover:bg-muted'\r\n                )}\r\n              >\r\n                <div\r\n                  className={cn(\r\n                    'p-2 rounded-lg',\r\n                    alertRule.channels.slack ? 'bg-primary text-primary-foreground' : 'bg-muted'\r\n                  )}\r\n                >\r\n                  <MessageSquare className=\"w-4 h-4\" />\r\n                </div>\r\n                <div className=\"text-left\">\r\n                  <p className=\"font-medium text-sm\">Slack</p>\r\n                  <p className=\"text-xs text-muted-foreground\">Channel alerts</p>\r\n                </div>\r\n                {alertRule.channels.slack && (\r\n                  <CheckCircle2 className=\"w-4 h-4 text-primary ml-auto\" />\r\n                )}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Footer Actions */}\r\n        <div className=\"border-t px-6 py-4 flex items-center gap-3 bg-muted/30\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"flex-1 px-4 py-2.5 rounded-lg border hover:bg-muted transition-colors\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            disabled={isSaving || !alertRule.name.trim()}\r\n            className=\"flex-1 px-4 py-2.5 rounded-lg bg-primary hover:bg-primary/90 text-primary-foreground font-medium transition-colors flex items-center justify-center gap-2 disabled:opacity-50\"\r\n          >\r\n            {isSaving ? (\r\n              <>\r\n                <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                {mode === 'edit' ? 'Saving...' : 'Creating...'}\r\n              </>\r\n            ) : (\r\n              <>\r\n                <Bell className=\"w-4 h-4\" />\r\n                {getButtonText()}\r\n              </>\r\n            )}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport function Stratum() {\r\n  const { t } = useTranslation();\r\n  const { toast } = useToast();\r\n  const [selectedTimeframe, setSelectedTimeframe] = useState('7d');\r\n  const [selectedInsight, setSelectedInsight] = useState<Insight | null>(null);\r\n  const [appliedInsights, setAppliedInsights] = useState<number[]>([]);\r\n  const [selectedAnomaly, setSelectedAnomaly] = useState<Anomaly | null>(null);\r\n  const [reviewedAnomalies, setReviewedAnomalies] = useState<number[]>([]);\r\n  const [alertConfigAnomaly, setAlertConfigAnomaly] = useState<Anomaly | null>(null);\r\n  const [editingAlert, setEditingAlert] = useState<AlertRule | null>(null);\r\n  const [alertModalMode, setAlertModalMode] = useState<'create' | 'edit' | 'duplicate'>('create');\r\n  const [createdAlerts, setCreatedAlerts] = useState<AlertRule[]>([]);\r\n\r\n  // Get tenant ID from tenant store\r\n  const tenantId = useTenantStore((state) => state.tenantId) ?? 1;\r\n\r\n  // Fetch data from API\r\n  const {\r\n    data: insightsData,\r\n    isLoading: insightsLoading,\r\n    refetch: refetchInsights,\r\n  } = useInsights(tenantId);\r\n  const { data: _recommendationsData } = useRecommendations(tenantId);\r\n  const { data: anomaliesData, isLoading: _anomaliesLoading } = useAnomalies(tenantId);\r\n  const { data: _predictionsData } = useLivePredictions();\r\n\r\n  // Transform API insights or fall back to mock\r\n  const insights = useMemo(() => {\r\n    if (insightsData?.actions && insightsData.actions.length > 0) {\r\n      return insightsData.actions.slice(0, 3).map((i, idx) => ({\r\n        id: idx + 1,\r\n        type: i.type || 'suggestion',\r\n        priority: i.priority || 'medium',\r\n        title: i.title || '',\r\n        description: i.description || '',\r\n        impact: i.expected_impact ? `+${JSON.stringify(i.expected_impact)}` : '+$0 estimated',\r\n        campaign: i.entity_name || 'All campaigns',\r\n      }));\r\n    }\r\n    return mockInsights;\r\n  }, [insightsData]);\r\n\r\n  // Transform API anomalies or fall back to mock\r\n  const anomalies = useMemo(() => {\r\n    if (anomaliesData?.anomalies && anomaliesData.anomalies.length > 0) {\r\n      return anomaliesData.anomalies.slice(0, 3).map((a, idx) => ({\r\n        id: idx + 1,\r\n        date: new Date(a.detected_at).toLocaleDateString('en-US', {\r\n          month: 'short',\r\n          day: 'numeric',\r\n        }),\r\n        metric: a.metric || 'Unknown',\r\n        value: a.current_value || 0,\r\n        expected: a.expected_value || 0,\r\n        deviation: a.zscore ? `${a.zscore > 0 ? '+' : ''}${(a.zscore * 100).toFixed(0)}%` : '0%',\r\n        type: a.direction === 'spike' ? 'positive' : 'negative',\r\n      }));\r\n    }\r\n    return mockAnomalies;\r\n  }, [anomaliesData]);\r\n\r\n  // Handle refresh\r\n  const handleRefresh = () => {\r\n    refetchInsights();\r\n  };\r\n\r\n  // Handle insight card click\r\n  const handleInsightClick = (insight: Insight) => {\r\n    setSelectedInsight(insight);\r\n  };\r\n\r\n  // Handle apply recommendation\r\n  const handleApplyRecommendation = (insight: Insight) => {\r\n    setAppliedInsights((prev) => [...prev, insight.id]);\r\n    setSelectedInsight(null);\r\n    // Here you would typically make an API call to apply the recommendation\r\n    // For now, we just track it locally\r\n  };\r\n\r\n  // Handle anomaly card click\r\n  const handleAnomalyClick = (anomaly: Anomaly) => {\r\n    setSelectedAnomaly(anomaly);\r\n  };\r\n\r\n  // Handle anomaly action\r\n  const handleAnomalyAction = (anomaly: Anomaly, action: string) => {\r\n    if (action === 'reviewed') {\r\n      setReviewedAnomalies((prev) => [...prev, anomaly.id]);\r\n      setSelectedAnomaly(null);\r\n    } else if (action === 'alert') {\r\n      // Close anomaly modal and open alert configuration modal\r\n      setSelectedAnomaly(null);\r\n      setAlertConfigAnomaly(anomaly);\r\n    }\r\n  };\r\n\r\n  // Handle alert rule save\r\n  const handleSaveAlertRule = (rule: AlertRule, isEdit: boolean) => {\r\n    if (isEdit && rule.id) {\r\n      setCreatedAlerts((prev) => prev.map((alert) => (alert.id === rule.id ? rule : alert)));\r\n      toast({ title: 'Alert updated', description: `Alert rule \"${rule.name}\" has been updated.` });\r\n    } else {\r\n      const ruleWithId = { ...rule, id: `alert-${Date.now()}` };\r\n      setCreatedAlerts((prev) => [...prev, ruleWithId]);\r\n      toast({ title: 'Alert created', description: `Alert rule \"${rule.name}\" has been created.` });\r\n    }\r\n    setAlertConfigAnomaly(null);\r\n    setEditingAlert(null);\r\n    setAlertModalMode('create');\r\n  };\r\n\r\n  // Handle edit alert\r\n  const handleEditAlert = (alert: AlertRule) => {\r\n    setEditingAlert(alert);\r\n    setAlertModalMode('edit');\r\n  };\r\n\r\n  // Handle duplicate alert\r\n  const handleDuplicateAlert = (alert: AlertRule) => {\r\n    setEditingAlert(alert);\r\n    setAlertModalMode('duplicate');\r\n  };\r\n\r\n  // Handle toggle alert enabled/disabled\r\n  const handleToggleAlert = (alertId: string) => {\r\n    setCreatedAlerts((prev) =>\r\n      prev.map((alert) => (alert.id === alertId ? { ...alert, enabled: !alert.enabled } : alert))\r\n    );\r\n  };\r\n\r\n  // Handle delete alert\r\n  const handleDeleteAlert = (alertId: string) => {\r\n    setCreatedAlerts((prev) => prev.filter((alert) => alert.id !== alertId));\r\n  };\r\n\r\n  const getInsightIcon = (type: string) => {\r\n    switch (type) {\r\n      case 'opportunity':\r\n        return <Lightbulb className=\"w-5 h-5 text-green-500\" />;\r\n      case 'warning':\r\n        return <AlertTriangle className=\"w-5 h-5 text-amber-500\" />;\r\n      case 'suggestion':\r\n        return <Sparkles className=\"w-5 h-5 text-primary\" />;\r\n      default:\r\n        return <Brain className=\"w-5 h-5\" />;\r\n    }\r\n  };\r\n\r\n  const getPriorityBadge = (priority: string) => {\r\n    const styles = {\r\n      high: 'bg-red-500/10 text-red-500',\r\n      medium: 'bg-amber-500/10 text-amber-500',\r\n      low: 'bg-blue-500/10 text-blue-500',\r\n    };\r\n    return (\r\n      <span\r\n        className={cn(\r\n          'px-2 py-0.5 rounded-full text-xs font-medium',\r\n          styles[priority as keyof typeof styles]\r\n        )}\r\n      >\r\n        {priority.charAt(0).toUpperCase() + priority.slice(1)}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Page Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\r\n            <Brain className=\"w-7 h-7 text-primary\" />\r\n            {t('stratum.title')}\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">{t('stratum.subtitle')}</p>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"flex rounded-lg border overflow-hidden\">\r\n            {['24h', '7d', '30d', '90d'].map((tf) => (\r\n              <button\r\n                key={tf}\r\n                onClick={() => setSelectedTimeframe(tf)}\r\n                className={cn(\r\n                  'px-4 py-2 text-sm transition-colors',\r\n                  selectedTimeframe === tf ? 'bg-primary text-primary-foreground' : 'hover:bg-muted'\r\n                )}\r\n              >\r\n                {tf}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <button\r\n            onClick={handleRefresh}\r\n            disabled={insightsLoading}\r\n            className=\"p-2 rounded-lg border hover:bg-muted transition-colors disabled:opacity-50\"\r\n          >\r\n            {insightsLoading ? (\r\n              <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n            ) : (\r\n              <RefreshCw className=\"w-4 h-4\" />\r\n            )}\r\n          </button>\r\n          <button className=\"p-2 rounded-lg border hover:bg-muted transition-colors\">\r\n            <Settings className=\"w-4 h-4\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* AI Insights */}\r\n      <div className=\"rounded-xl border bg-card p-5\">\r\n        <div className=\"flex items-center justify-between mb-4\">\r\n          <h3 className=\"font-semibold flex items-center gap-2\">\r\n            <Sparkles className=\"w-5 h-5 text-primary\" />\r\n            {t('stratum.aiInsights')}\r\n          </h3>\r\n          <button className=\"text-sm text-primary hover:underline\">{t('common.viewAll')}</button>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n          {insights.map((insight) => {\r\n            const isApplied = appliedInsights.includes(insight.id);\r\n            return (\r\n              <div\r\n                key={insight.id}\r\n                onClick={() => !isApplied && handleInsightClick(insight as Insight)}\r\n                className={cn(\r\n                  'p-4 rounded-lg border bg-background transition-all cursor-pointer',\r\n                  isApplied\r\n                    ? 'opacity-60 cursor-default border-green-500/50'\r\n                    : 'hover:shadow-md hover:border-primary/50'\r\n                )}\r\n              >\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  {isApplied ? (\r\n                    <CheckCircle2 className=\"w-5 h-5 text-green-500\" />\r\n                  ) : (\r\n                    getInsightIcon(insight.type)\r\n                  )}\r\n                  {isApplied ? (\r\n                    <span className=\"px-2 py-0.5 rounded-full text-xs font-medium bg-green-500/10 text-green-500\">\r\n                      Applied\r\n                    </span>\r\n                  ) : (\r\n                    getPriorityBadge(insight.priority)\r\n                  )}\r\n                </div>\r\n                <h4 className=\"font-medium text-sm mb-1\">{insight.title}</h4>\r\n                <p className=\"text-xs text-muted-foreground mb-3 line-clamp-2\">\r\n                  {insight.description}\r\n                </p>\r\n                <div className=\"flex items-center justify-between\">\r\n                  <span\r\n                    className={cn(\r\n                      'text-xs font-medium',\r\n                      insight.impact.startsWith('+') ? 'text-green-500' : 'text-red-500'\r\n                    )}\r\n                  >\r\n                    {insight.impact}\r\n                  </span>\r\n                  {!isApplied && <ArrowRight className=\"w-4 h-4 text-muted-foreground\" />}\r\n                </div>\r\n              </div>\r\n            );\r\n          })}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content Grid */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        {/* Revenue Forecast */}\r\n        <div className=\"lg:col-span-2 rounded-xl border bg-card p-5\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <div>\r\n              <h3 className=\"font-semibold\">{t('stratum.revenueForecast')}</h3>\r\n              <p className=\"text-xs text-muted-foreground\">{t('stratum.forecastDescription')}</p>\r\n            </div>\r\n            <div className=\"flex items-center gap-4 text-xs\">\r\n              <div className=\"flex items-center gap-1\">\r\n                <div className=\"w-2 h-2 rounded-full bg-primary\" />\r\n                <span className=\"text-muted-foreground\">Actual</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-1\">\r\n                <div className=\"w-2 h-2 rounded-full bg-green-500\" />\r\n                <span className=\"text-muted-foreground\">Predicted</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"h-[300px]\">\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n              <AreaChart data={mockPredictionData}>\r\n                <defs>\r\n                  <linearGradient id=\"colorPredicted\" x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\r\n                    <stop offset=\"5%\" stopColor=\"#10b981\" stopOpacity={0.2} />\r\n                    <stop offset=\"95%\" stopColor=\"#10b981\" stopOpacity={0} />\r\n                  </linearGradient>\r\n                </defs>\r\n                <CartesianGrid strokeDasharray=\"3 3\" className=\"stroke-muted\" />\r\n                <XAxis dataKey=\"date\" tick={{ fontSize: 12 }} tickLine={false} axisLine={false} />\r\n                <YAxis\r\n                  tick={{ fontSize: 12 }}\r\n                  tickLine={false}\r\n                  axisLine={false}\r\n                  tickFormatter={(value) => `$${formatCompactNumber(value)}`}\r\n                />\r\n                <Tooltip\r\n                  contentStyle={{\r\n                    backgroundColor: 'hsl(var(--card))',\r\n                    border: '1px solid hsl(var(--border))',\r\n                    borderRadius: '0.5rem',\r\n                  }}\r\n                  formatter={((value: number) => [formatCurrency(value), '']) as any}\r\n                />\r\n                {/* Confidence interval */}\r\n                <Area\r\n                  type=\"monotone\"\r\n                  dataKey=\"upperBound\"\r\n                  stroke=\"transparent\"\r\n                  fill=\"#10b981\"\r\n                  fillOpacity={0.1}\r\n                />\r\n                <Area\r\n                  type=\"monotone\"\r\n                  dataKey=\"lowerBound\"\r\n                  stroke=\"transparent\"\r\n                  fill=\"#fff\"\r\n                  fillOpacity={1}\r\n                />\r\n                {/* Predicted line */}\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"predicted\"\r\n                  stroke=\"#10b981\"\r\n                  strokeWidth={2}\r\n                  strokeDasharray=\"5 5\"\r\n                  dot={false}\r\n                />\r\n                {/* Actual line */}\r\n                <Line\r\n                  type=\"monotone\"\r\n                  dataKey=\"actual\"\r\n                  stroke=\"#0ea5e9\"\r\n                  strokeWidth={2}\r\n                  dot={{ fill: '#0ea5e9', strokeWidth: 0, r: 3 }}\r\n                  connectNulls={false}\r\n                />\r\n              </AreaChart>\r\n            </ResponsiveContainer>\r\n          </div>\r\n\r\n          <div className=\"mt-4 grid grid-cols-3 gap-4 pt-4 border-t\">\r\n            <div>\r\n              <p className=\"text-xs text-muted-foreground\">{t('stratum.forecastedRevenue')}</p>\r\n              <p className=\"text-lg font-semibold\">$156,890</p>\r\n              <p className=\"text-xs text-green-500\">+12.4% vs last period</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-xs text-muted-foreground\">{t('stratum.confidence')}</p>\r\n              <p className=\"text-lg font-semibold\">87%</p>\r\n              <p className=\"text-xs text-muted-foreground\">High confidence</p>\r\n            </div>\r\n            <div>\r\n              <p className=\"text-xs text-muted-foreground\">{t('stratum.modelAccuracy')}</p>\r\n              <p className=\"text-lg font-semibold\">94.2%</p>\r\n              <p className=\"text-xs text-muted-foreground\">Last 30 days</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* What-If Simulator */}\r\n        <SimulateSlider />\r\n      </div>\r\n\r\n      {/* Second Row */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Attribution Model */}\r\n        <div className=\"rounded-xl border bg-card p-5\">\r\n          <h3 className=\"font-semibold mb-4\">{t('stratum.attributionModel')}</h3>\r\n          <div className=\"flex items-center gap-6\">\r\n            <div className=\"w-48 h-48\">\r\n              <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n                <PieChart>\r\n                  <Pie\r\n                    data={mockAttributionData}\r\n                    cx=\"50%\"\r\n                    cy=\"50%\"\r\n                    innerRadius={50}\r\n                    outerRadius={80}\r\n                    paddingAngle={2}\r\n                    dataKey=\"value\"\r\n                  >\r\n                    {mockAttributionData.map((entry, index) => (\r\n                      <Cell key={`cell-${index}`} fill={entry.color} />\r\n                    ))}\r\n                  </Pie>\r\n                  <Tooltip\r\n                    contentStyle={{\r\n                      backgroundColor: 'hsl(var(--card))',\r\n                      border: '1px solid hsl(var(--border))',\r\n                      borderRadius: '0.5rem',\r\n                    }}\r\n                  />\r\n                </PieChart>\r\n              </ResponsiveContainer>\r\n            </div>\r\n            <div className=\"flex-1 space-y-3\">\r\n              {mockAttributionData.map((item) => (\r\n                <div key={item.name} className=\"flex items-center justify-between\">\r\n                  <div className=\"flex items-center gap-2\">\r\n                    <div className=\"w-3 h-3 rounded-full\" style={{ backgroundColor: item.color }} />\r\n                    <span className=\"text-sm\">{item.name}</span>\r\n                  </div>\r\n                  <span className=\"font-medium\">{item.value}%</span>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Anomaly Detection */}\r\n        <div className=\"rounded-xl border bg-card p-5\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"font-semibold\">{t('stratum.anomalyDetection')}</h3>\r\n            <span className=\"text-xs text-muted-foreground\">Last 7 days</span>\r\n          </div>\r\n\r\n          <div className=\"space-y-3\">\r\n            {anomalies.map((anomaly, i) => {\r\n              const isReviewed = reviewedAnomalies.includes(anomaly.id);\r\n              return (\r\n                <div\r\n                  key={anomaly.id || i}\r\n                  onClick={() => !isReviewed && handleAnomalyClick(anomaly as Anomaly)}\r\n                  className={cn(\r\n                    'p-3 rounded-lg border-l-4 transition-all',\r\n                    anomaly.type === 'positive'\r\n                      ? 'bg-green-500/10 border-green-500'\r\n                      : 'bg-red-500/10 border-red-500',\r\n                    isReviewed ? 'opacity-60 cursor-default' : 'cursor-pointer hover:shadow-md'\r\n                  )}\r\n                >\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex items-center gap-2\">\r\n                      {isReviewed ? (\r\n                        <CheckCircle2 className=\"w-4 h-4 text-muted-foreground\" />\r\n                      ) : anomaly.type === 'positive' ? (\r\n                        <CheckCircle2 className=\"w-4 h-4 text-green-500\" />\r\n                      ) : (\r\n                        <AlertTriangle className=\"w-4 h-4 text-red-500\" />\r\n                      )}\r\n                      <span className=\"font-medium text-sm\">{anomaly.metric}</span>\r\n                      {isReviewed && (\r\n                        <span className=\"px-1.5 py-0.5 rounded text-[10px] font-medium bg-muted text-muted-foreground\">\r\n                          Reviewed\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                    <div className=\"flex items-center gap-2\">\r\n                      <span className=\"text-xs text-muted-foreground\">{anomaly.date}</span>\r\n                      {!isReviewed && <ArrowRight className=\"w-3 h-3 text-muted-foreground\" />}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"mt-2 flex items-center justify-between text-sm\">\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Actual: </span>\r\n                      <span className=\"font-medium\">{anomaly.value}</span>\r\n                    </div>\r\n                    <div>\r\n                      <span className=\"text-muted-foreground\">Expected: </span>\r\n                      <span className=\"font-medium\">{anomaly.expected}</span>\r\n                    </div>\r\n                    <span\r\n                      className={cn(\r\n                        'font-semibold',\r\n                        anomaly.type === 'positive' ? 'text-green-500' : 'text-red-500'\r\n                      )}\r\n                    >\r\n                      {anomaly.deviation}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Active Alerts Section */}\r\n      {createdAlerts.length > 0 && (\r\n        <div className=\"rounded-xl border bg-card p-5\">\r\n          <div className=\"flex items-center justify-between mb-4\">\r\n            <h3 className=\"font-semibold flex items-center gap-2\">\r\n              <Bell className=\"w-5 h-5 text-primary\" />\r\n              Active Alerts\r\n              <span className=\"px-2 py-0.5 rounded-full bg-primary/10 text-primary text-xs font-medium\">\r\n                {createdAlerts.length}\r\n              </span>\r\n            </h3>\r\n          </div>\r\n\r\n          <div className=\"space-y-3\">\r\n            {createdAlerts.map((alert) => {\r\n              const conditionLabel = {\r\n                above: 'goes above',\r\n                below: 'goes below',\r\n                change_above: 'changes by more than +',\r\n                change_below: 'changes by more than -',\r\n              }[alert.condition];\r\n\r\n              const activeChannels = Object.entries(alert.channels)\r\n                .filter(([_, enabled]) => enabled)\r\n                .map(([channel]) => channel);\r\n\r\n              return (\r\n                <div\r\n                  key={alert.id}\r\n                  className={cn(\r\n                    'p-4 rounded-lg border transition-all',\r\n                    alert.enabled ? 'bg-background' : 'bg-muted/50 opacity-60'\r\n                  )}\r\n                >\r\n                  <div className=\"flex items-start justify-between gap-4\">\r\n                    <div className=\"flex-1 min-w-0\">\r\n                      <div className=\"flex items-center gap-2 mb-1\">\r\n                        <h4 className=\"font-medium text-sm truncate\">{alert.name}</h4>\r\n                        <span\r\n                          className={cn(\r\n                            'px-2 py-0.5 rounded-full text-xs font-medium',\r\n                            alert.enabled\r\n                              ? 'bg-green-500/10 text-green-500'\r\n                              : 'bg-muted text-muted-foreground'\r\n                          )}\r\n                        >\r\n                          {alert.enabled ? 'Active' : 'Paused'}\r\n                        </span>\r\n                      </div>\r\n                      <p className=\"text-sm text-muted-foreground\">\r\n                        <span className=\"font-medium text-foreground\">{alert.metric}</span>{' '}\r\n                        {conditionLabel}{' '}\r\n                        <span className=\"font-medium text-foreground\">\r\n                          {alert.threshold}\r\n                          {alert.condition.includes('change') ? '%' : ''}\r\n                        </span>\r\n                      </p>\r\n                      <div className=\"flex items-center gap-3 mt-2\">\r\n                        <span className=\"text-xs text-muted-foreground flex items-center gap-1\">\r\n                          <Clock className=\"w-3 h-3\" />\r\n                          {alert.frequency === 'realtime'\r\n                            ? 'Real-time'\r\n                            : alert.frequency === 'hourly'\r\n                              ? 'Hourly'\r\n                              : 'Daily'}\r\n                        </span>\r\n                        <div className=\"flex items-center gap-1\">\r\n                          {activeChannels.map((channel) => (\r\n                            <span\r\n                              key={channel}\r\n                              className=\"px-1.5 py-0.5 rounded text-[10px] font-medium bg-muted capitalize\"\r\n                            >\r\n                              {channel === 'inApp' ? 'In-App' : channel}\r\n                            </span>\r\n                          ))}\r\n                        </div>\r\n                      </div>\r\n                    </div>\r\n                    <div className=\"flex items-center gap-1\">\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleEditAlert(alert);\r\n                        }}\r\n                        className=\"px-3 py-1.5 rounded-lg text-xs font-medium border border-primary/30 text-primary bg-primary/10 hover:bg-primary/20 transition-colors\"\r\n                      >\r\n                        Edit\r\n                      </button>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleDuplicateAlert(alert);\r\n                        }}\r\n                        className=\"px-3 py-1.5 rounded-lg text-xs font-medium border border-blue-500/30 text-blue-500 bg-blue-500/10 hover:bg-blue-500/20 transition-colors\"\r\n                      >\r\n                        Duplicate\r\n                      </button>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleToggleAlert(alert.id!);\r\n                        }}\r\n                        className={cn(\r\n                          'px-3 py-1.5 rounded-lg text-xs font-medium border transition-colors',\r\n                          alert.enabled\r\n                            ? 'bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20'\r\n                            : 'bg-muted text-muted-foreground border-muted hover:bg-muted/80'\r\n                        )}\r\n                      >\r\n                        {alert.enabled ? 'Pause' : 'Resume'}\r\n                      </button>\r\n                      <button\r\n                        onClick={(e) => {\r\n                          e.stopPropagation();\r\n                          handleDeleteAlert(alert.id!);\r\n                        }}\r\n                        className=\"px-3 py-1.5 rounded-lg text-xs font-medium border border-red-500/30 text-red-500 bg-red-500/10 hover:bg-red-500/20 transition-colors\"\r\n                      >\r\n                        Delete\r\n                      </button>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              );\r\n            })}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Insight Detail Modal */}\r\n      {selectedInsight && (\r\n        <InsightDetailModal\r\n          insight={selectedInsight}\r\n          onClose={() => setSelectedInsight(null)}\r\n          onApply={handleApplyRecommendation}\r\n        />\r\n      )}\r\n\r\n      {/* Anomaly Detail Modal */}\r\n      {selectedAnomaly && (\r\n        <AnomalyDetailModal\r\n          anomaly={selectedAnomaly}\r\n          onClose={() => setSelectedAnomaly(null)}\r\n          onAction={handleAnomalyAction}\r\n        />\r\n      )}\r\n\r\n      {/* Alert Configuration Modal */}\r\n      {(alertConfigAnomaly || editingAlert) && (\r\n        <AlertConfigurationModal\r\n          anomaly={alertConfigAnomaly}\r\n          existingAlert={editingAlert}\r\n          mode={alertModalMode}\r\n          onClose={() => {\r\n            setAlertConfigAnomaly(null);\r\n            setEditingAlert(null);\r\n            setAlertModalMode('create');\r\n          }}\r\n          onSave={handleSaveAlertRule}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Stratum;\r\n"],"names":["useInsights","tenantId","date","useQuery","apiClient","useRecommendations","options","params","useAnomalies","DEFAULT_CAMPAIGN","SimulateSlider","campaign","onSimulate","className","t","useTranslation","inputs","setInputs","useState","result","setResult","isSimulating","setIsSimulating","runSimulation","useCallback","budgetChange","bidChange","targetAudienceChange","budgetMultiplier","bidMultiplier","audienceMultiplier","newSpend","impressionGrowth","newImpressions","ctrImprovement","newClicks","conversionEfficiency","newConversions","newRevenue","newROAS","changesMagnitude","confidence","simulationResult","useEffect","timer","resetInputs","renderSlider","label","value","min","max","onChange","tooltip","jsxs","jsx","SmartTooltip","Info","cn","e","getChangeIndicator","current","estimated","change","TrendingUp","TrendingDown","formatPercent","Calculator","RefreshCw","prev","i","DollarSign","formatCurrency","Target","formatCompactNumber","mockInsights","mockPredictionData","_","isPast","mockAttributionData","mockAnomalies","InsightDetailModal","insight","onClose","onApply","isApplying","setIsApplying","handleApply","resolve","getTypeColor","type","getTypeIcon","Lightbulb","AlertTriangle","Sparkles","Brain","Clock","X","BarChart3","Fragment","ResponsiveContainer","LineChart","CartesianGrid","XAxis","YAxis","Tooltip","Line","Zap","rec","idx","CheckCircle2","Loader2","AnomalyDetailModal","anomaly","onAction","selectedAction","setSelectedAction","isProcessing","setIsProcessing","handleAction","action","isPositive","_a","_b","AreaChart","Area","key","data","cause","AlertConfigurationModal","existingAlert","mode","onSave","isSaving","setIsSaving","hasChanges","setHasChanges","error","setError","getInitialAlertRule","alertRule","setAlertRule","originalName","handleSave","handleFieldChange","updates","updateChannel","channel","getModalTitle","getButtonText","metrics","conditions","frequencies","Bell","metric","cond","c","freq","Mail","MessageSquare","Stratum","toast","useToast","selectedTimeframe","setSelectedTimeframe","selectedInsight","setSelectedInsight","appliedInsights","setAppliedInsights","selectedAnomaly","setSelectedAnomaly","reviewedAnomalies","setReviewedAnomalies","alertConfigAnomaly","setAlertConfigAnomaly","editingAlert","setEditingAlert","alertModalMode","setAlertModalMode","createdAlerts","setCreatedAlerts","useTenantStore","state","insightsData","insightsLoading","refetchInsights","_recommendationsData","anomaliesData","_anomaliesLoading","_predictionsData","useLivePredictions","insights","useMemo","anomalies","a","handleRefresh","handleInsightClick","handleApplyRecommendation","handleAnomalyClick","handleAnomalyAction","handleSaveAlertRule","rule","isEdit","alert","ruleWithId","handleEditAlert","handleDuplicateAlert","handleToggleAlert","alertId","handleDeleteAlert","getInsightIcon","getPriorityBadge","priority","styles","tf","Settings","isApplied","ArrowRight","PieChart","Pie","entry","index","Cell","item","isReviewed","conditionLabel","activeChannels","enabled"],"mappings":"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"}