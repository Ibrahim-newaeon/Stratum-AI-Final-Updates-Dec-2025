{"version":3,"file":"TenantProfile-dL6xdXsl.js","sources":["../../src/views/superadmin/TenantProfile.tsx"],"sourcesContent":["/**\r\n * Tenant Profile (Super Admin Individual Tenant View)\r\n *\r\n * Detailed health profile for a specific tenant\r\n * Shows EMQ history, incidents, actions, and allows admin controls\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport { Link, useParams } from 'react-router-dom';\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n  type AutopilotMode,\r\n  EmqFixPlaybookPanel,\r\n  EmqScoreCard,\r\n  EmqTimeline,\r\n  type Kpi,\r\n  KpiStrip,\r\n  type PlaybookItem,\r\n  type TimelineEvent,\r\n  TrustStatusHeader,\r\n} from '@/components/shared';\r\nimport {\r\n  useAutopilotState,\r\n  useEmqIncidents,\r\n  useEmqPlaybook,\r\n  useEmqScore,\r\n  useSuspendTenant,\r\n  useTenant,\r\n  useUpdateAutopilotMode,\r\n} from '@/api/hooks';\r\nimport { useToast } from '@/components/ui/use-toast';\r\nimport {\r\n  ArrowLeftIcon,\r\n  ArrowPathIcon,\r\n  BuildingOfficeIcon,\r\n  CalendarIcon,\r\n  CheckCircleIcon,\r\n  ClockIcon,\r\n  Cog6ToothIcon,\r\n  ExclamationTriangleIcon,\r\n  ShieldCheckIcon,\r\n  ShieldExclamationIcon,\r\n  UserGroupIcon,\r\n  XMarkIcon,\r\n} from '@heroicons/react/24/outline';\r\n\r\ntype AdminAction = 'restrict' | 'support' | 'override';\r\n\r\n// Confirmation dialog component\r\ninterface ConfirmDialogProps {\r\n  isOpen: boolean;\r\n  title: string;\r\n  message: string;\r\n  confirmLabel: string;\r\n  confirmVariant?: 'danger' | 'warning' | 'primary';\r\n  onConfirm: () => void;\r\n  onCancel: () => void;\r\n  isLoading?: boolean;\r\n}\r\n\r\nfunction ConfirmDialog({\r\n  isOpen,\r\n  title,\r\n  message,\r\n  confirmLabel,\r\n  confirmVariant = 'primary',\r\n  onConfirm,\r\n  onCancel,\r\n  isLoading = false,\r\n}: ConfirmDialogProps) {\r\n  if (!isOpen) return null;\r\n\r\n  const variantStyles = {\r\n    danger: 'bg-danger hover:bg-danger/80 text-white',\r\n    warning: 'bg-warning hover:bg-warning/80 text-black',\r\n    primary: 'bg-stratum-500 hover:bg-stratum-600 text-white',\r\n  };\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 flex items-center justify-center\">\r\n      <div className=\"absolute inset-0 bg-black/50\" onClick={onCancel} />\r\n      <div className=\"relative bg-surface-primary border border-white/10 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl\">\r\n        <button\r\n          onClick={onCancel}\r\n          className=\"absolute top-4 right-4 text-text-muted hover:text-white transition-colors\"\r\n        >\r\n          <XMarkIcon className=\"w-5 h-5\" />\r\n        </button>\r\n        <h3 className=\"text-lg font-semibold text-white mb-2\">{title}</h3>\r\n        <p className=\"text-text-muted mb-6\">{message}</p>\r\n        <div className=\"flex justify-end gap-3\">\r\n          <button\r\n            onClick={onCancel}\r\n            disabled={isLoading}\r\n            className=\"px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors disabled:opacity-50\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={onConfirm}\r\n            disabled={isLoading}\r\n            className={cn(\r\n              'px-4 py-2 rounded-lg transition-colors disabled:opacity-50',\r\n              variantStyles[confirmVariant]\r\n            )}\r\n          >\r\n            {isLoading ? 'Processing...' : confirmLabel}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function TenantProfile() {\r\n  const { tenantId } = useParams<{ tenantId: string }>();\r\n  const tid = parseInt(tenantId || '1', 10);\r\n\r\n  const { toast } = useToast();\r\n\r\n  const [activeTab, setActiveTab] = useState<'overview' | 'incidents' | 'actions' | 'settings'>(\r\n    'overview'\r\n  );\r\n\r\n  // Confirmation dialog state\r\n  const [confirmDialog, setConfirmDialog] = useState<{\r\n    isOpen: boolean;\r\n    title: string;\r\n    message: string;\r\n    confirmLabel: string;\r\n    confirmVariant: 'danger' | 'warning' | 'primary';\r\n    onConfirm: () => void;\r\n  }>({\r\n    isOpen: false,\r\n    title: '',\r\n    message: '',\r\n    confirmLabel: '',\r\n    confirmVariant: 'primary',\r\n    onConfirm: () => {},\r\n  });\r\n\r\n  // Local feature flags state (for UI toggle)\r\n  const [localFeatures, setLocalFeatures] = useState<Record<string, boolean>>({\r\n    autopilot: true,\r\n    campaignBuilder: true,\r\n    competitorIntel: false,\r\n    predictions: true,\r\n  });\r\n\r\n  // Date range\r\n  const dateRange = {\r\n    start: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],\r\n    end: new Date().toISOString().split('T')[0],\r\n  };\r\n\r\n  // Fetch data\r\n  const { data: tenantData } = useTenant(tid);\r\n  const { data: emqData } = useEmqScore(tid);\r\n  const { data: autopilotData, refetch: refetchAutopilot } = useAutopilotState(tid);\r\n  const { data: playbookData } = useEmqPlaybook(tid);\r\n  const { data: incidentsData, refetch: refetchIncidents } = useEmqIncidents(\r\n    tid,\r\n    dateRange.start,\r\n    dateRange.end\r\n  );\r\n\r\n  // Mutations\r\n  const updateAutopilotModeMutation = useUpdateAutopilotMode(tid);\r\n  const suspendTenantMutation = useSuspendTenant();\r\n\r\n  const emqScore = emqData?.score ?? 72;\r\n  const autopilotMode: AutopilotMode = autopilotData?.mode ?? 'limited';\r\n  const budgetAtRisk = autopilotData?.budgetAtRisk ?? 8500;\r\n\r\n  // Sample tenant details\r\n  const tenant = {\r\n    id: tenantId,\r\n    name: tenantData?.name ?? 'Fashion Forward',\r\n    industry: 'Retail', // Industry not in API, using default\r\n    plan: tenantData?.plan ?? 'Pro',\r\n    accountManager: 'Sarah Johnson',\r\n    createdAt: new Date('2024-01-15'),\r\n    platforms: ['Meta', 'TikTok', 'Snapchat'],\r\n    users: 8,\r\n    monthlySpend: 120000,\r\n    mrr: 499,\r\n    status: 'active' as const,\r\n    features: localFeatures,\r\n    restrictions: [] as string[],\r\n  };\r\n\r\n  // Close confirmation dialog\r\n  const closeConfirmDialog = () => {\r\n    setConfirmDialog((prev) => ({ ...prev, isOpen: false }));\r\n  };\r\n\r\n  // Handle feature toggle with confirmation\r\n  const handleFeatureToggle = (feature: string, currentEnabled: boolean) => {\r\n    const action = currentEnabled ? 'disable' : 'enable';\r\n    setConfirmDialog({\r\n      isOpen: true,\r\n      title: `${action.charAt(0).toUpperCase() + action.slice(1)} ${feature.replace(/([A-Z])/g, ' $1').trim()}?`,\r\n      message: `Are you sure you want to ${action} the ${feature\r\n        .replace(/([A-Z])/g, ' $1')\r\n        .trim()\r\n        .toLowerCase()} feature for this tenant?`,\r\n      confirmLabel: action.charAt(0).toUpperCase() + action.slice(1),\r\n      confirmVariant: currentEnabled ? 'warning' : 'primary',\r\n      onConfirm: () => {\r\n        setLocalFeatures((prev) => ({ ...prev, [feature]: !currentEnabled }));\r\n        toast({\r\n          title: 'Feature Updated',\r\n          description: `${feature.replace(/([A-Z])/g, ' $1').trim()} has been ${action}d for this tenant.`,\r\n        });\r\n        closeConfirmDialog();\r\n      },\r\n    });\r\n  };\r\n\r\n  // Handle autopilot mode override with confirmation\r\n  const handleModeOverride = (newMode: AutopilotMode) => {\r\n    if (newMode === autopilotMode) return;\r\n\r\n    setConfirmDialog({\r\n      isOpen: true,\r\n      title: 'Override Autopilot Mode?',\r\n      message: `Are you sure you want to change the autopilot mode from \"${autopilotMode.replace('_', ' ')}\" to \"${newMode.replace('_', ' ')}\"? This will override the automated mode selection.`,\r\n      confirmLabel: 'Override Mode',\r\n      confirmVariant: 'warning',\r\n      onConfirm: async () => {\r\n        try {\r\n          await updateAutopilotModeMutation.mutateAsync({\r\n            mode: newMode,\r\n            reason: 'Admin manual override',\r\n          });\r\n          toast({\r\n            title: 'Mode Updated',\r\n            description: `Autopilot mode has been changed to ${newMode.replace('_', ' ')}.`,\r\n          });\r\n          refetchAutopilot();\r\n        } catch (error) {\r\n          toast({\r\n            title: 'Error',\r\n            description: error instanceof Error ? error.message : 'Failed to update autopilot mode',\r\n            variant: 'destructive',\r\n          });\r\n        }\r\n        closeConfirmDialog();\r\n      },\r\n    });\r\n  };\r\n\r\n  // Handle suspend tenant with confirmation\r\n  const handleSuspendTenant = () => {\r\n    setConfirmDialog({\r\n      isOpen: true,\r\n      title: 'Suspend Tenant?',\r\n      message: `Are you sure you want to suspend \"${tenant.name}\"? This will temporarily disable all access and automation for this tenant.`,\r\n      confirmLabel: 'Suspend Tenant',\r\n      confirmVariant: 'danger',\r\n      onConfirm: async () => {\r\n        try {\r\n          await suspendTenantMutation.mutateAsync({\r\n            id: tid,\r\n            reason: 'Admin manual suspension',\r\n          });\r\n          toast({\r\n            title: 'Tenant Suspended',\r\n            description: `${tenant.name} has been suspended.`,\r\n          });\r\n        } catch (error) {\r\n          toast({\r\n            title: 'Error',\r\n            description: error instanceof Error ? error.message : 'Failed to suspend tenant',\r\n            variant: 'destructive',\r\n          });\r\n        }\r\n        closeConfirmDialog();\r\n      },\r\n    });\r\n  };\r\n\r\n  // Handle refresh action log\r\n  const handleRefreshActionLog = async () => {\r\n    try {\r\n      await refetchIncidents();\r\n      toast({\r\n        title: 'Refreshed',\r\n        description: 'Action log has been refreshed.',\r\n      });\r\n    } catch (error) {\r\n      toast({\r\n        title: 'Error',\r\n        description: 'Failed to refresh action log.',\r\n        variant: 'destructive',\r\n      });\r\n    }\r\n  };\r\n\r\n  const kpis: Kpi[] = [\r\n    {\r\n      id: 'spend',\r\n      label: 'Monthly Spend',\r\n      value: tenant.monthlySpend,\r\n      format: 'currency',\r\n      previousValue: 115000,\r\n      confidence: emqScore,\r\n    },\r\n    {\r\n      id: 'mrr',\r\n      label: 'MRR',\r\n      value: tenant.mrr,\r\n      format: 'currency',\r\n      previousValue: 499,\r\n      confidence: 100,\r\n    },\r\n    {\r\n      id: 'users',\r\n      label: 'Active Users',\r\n      value: tenant.users,\r\n      format: 'number',\r\n      previousValue: 7,\r\n      confidence: 100,\r\n    },\r\n    {\r\n      id: 'uptime',\r\n      label: 'Data Uptime',\r\n      value: 99.2,\r\n      format: 'percentage',\r\n      previousValue: 98.5,\r\n      confidence: emqScore,\r\n    },\r\n  ];\r\n\r\n  const playbook: PlaybookItem[] = playbookData ?? [\r\n    {\r\n      id: '1',\r\n      title: 'Fix TikTok conversion variance',\r\n      description: 'TikTok reporting 22% lower conversions than GA4',\r\n      priority: 'critical',\r\n      owner: 'Data Team',\r\n      estimatedImpact: 12,\r\n      estimatedTime: '2 hours',\r\n      platform: 'TikTok',\r\n      status: 'in_progress',\r\n      actionUrl: null,\r\n    },\r\n    {\r\n      id: '2',\r\n      title: 'Resolve Snapchat API timeout',\r\n      description: 'Intermittent 504 errors causing data freshness issues',\r\n      priority: 'high',\r\n      owner: null,\r\n      estimatedImpact: 8,\r\n      estimatedTime: '1 hour',\r\n      platform: 'Snapchat',\r\n      status: 'pending',\r\n      actionUrl: null,\r\n    },\r\n  ];\r\n\r\n  const timeline: TimelineEvent[] = incidentsData?.map((i) => ({\r\n    id: i.id,\r\n    type: i.type,\r\n    title: i.title,\r\n    description: i.description ?? undefined,\r\n    timestamp: new Date(i.timestamp),\r\n    platform: i.platform ?? undefined,\r\n    severity: i.severity,\r\n    recoveryHours: i.recoveryHours ?? undefined,\r\n    emqImpact: i.emqImpact ?? undefined,\r\n  })) ?? [\r\n    {\r\n      id: '1',\r\n      type: 'incident_opened',\r\n      title: 'TikTok conversion tracking degraded',\r\n      description: 'Significant variance detected',\r\n      timestamp: new Date(Date.now() - 4 * 60 * 60 * 1000),\r\n      platform: 'TikTok',\r\n      severity: 'high',\r\n    },\r\n    {\r\n      id: '2',\r\n      type: 'mode_change',\r\n      title: 'Autopilot mode changed to Limited',\r\n      description: 'Due to signal degradation',\r\n      timestamp: new Date(Date.now() - 5 * 60 * 60 * 1000),\r\n      severity: 'medium',\r\n    },\r\n    {\r\n      id: '3',\r\n      type: 'recovery',\r\n      title: 'Meta pixel issue resolved',\r\n      description: 'Data loss recovered',\r\n      timestamp: new Date(Date.now() - 24 * 60 * 60 * 1000),\r\n      platform: 'Meta',\r\n      severity: 'low',\r\n      recoveryHours: 6,\r\n      emqImpact: 8,\r\n    },\r\n  ];\r\n\r\n  const handleAdminAction = (action: AdminAction) => {\r\n    switch (action) {\r\n      case 'support':\r\n        toast({\r\n          title: 'Contact Support',\r\n          description: 'Opening support ticket system...',\r\n        });\r\n        // In production, this would open a support modal or redirect\r\n        break;\r\n      case 'override':\r\n        setActiveTab('settings');\r\n        toast({\r\n          title: 'Mode Override',\r\n          description: 'Navigate to Admin Controls to override autopilot mode.',\r\n        });\r\n        break;\r\n      case 'restrict':\r\n        toast({\r\n          title: 'Apply Restriction',\r\n          description: 'Navigate to Admin Controls to manage restrictions.',\r\n        });\r\n        setActiveTab('settings');\r\n        break;\r\n    }\r\n  };\r\n\r\n  const tabs = [\r\n    { id: 'overview' as const, label: 'Overview' },\r\n    { id: 'incidents' as const, label: 'Incidents' },\r\n    { id: 'actions' as const, label: 'Action Log' },\r\n    { id: 'settings' as const, label: 'Admin Controls' },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Back Link & Header */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <Link\r\n            to=\"/dashboard/superadmin/tenants\"\r\n            className=\"p-2 rounded-lg bg-surface-secondary border border-white/10 text-text-muted hover:text-white transition-colors\"\r\n          >\r\n            <ArrowLeftIcon className=\"w-5 h-5\" />\r\n          </Link>\r\n          <div>\r\n            <div className=\"flex items-center gap-3\">\r\n              <h1 className=\"text-2xl font-bold text-white\">{tenant.name}</h1>\r\n              <span className=\"px-2 py-1 rounded-full text-xs bg-stratum-500/10 text-stratum-400\">\r\n                {tenant.plan}\r\n              </span>\r\n              <span className=\"px-2 py-1 rounded-full text-xs bg-success/10 text-success\">\r\n                {tenant.status}\r\n              </span>\r\n            </div>\r\n            <p className=\"text-text-muted\">{tenant.industry}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"flex items-center gap-3\">\r\n          <button\r\n            onClick={() => handleAdminAction('support')}\r\n            className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors\"\r\n          >\r\n            <UserGroupIcon className=\"w-4 h-4\" />\r\n            Contact Support\r\n          </button>\r\n          <button\r\n            onClick={() => handleAdminAction('override')}\r\n            className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-warning/10 border border-warning/20 text-warning hover:bg-warning/20 transition-colors\"\r\n          >\r\n            <ShieldExclamationIcon className=\"w-4 h-4\" />\r\n            Override Mode\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Trust Status */}\r\n      <TrustStatusHeader\r\n        emqScore={emqScore}\r\n        autopilotMode={autopilotMode}\r\n        budgetAtRisk={budgetAtRisk}\r\n        svi={32}\r\n        onViewDetails={() => setActiveTab('incidents')}\r\n      />\r\n\r\n      {/* Tenant Info Cards */}\r\n      <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n        <div className=\"p-4 rounded-xl bg-surface-secondary border border-white/10\">\r\n          <div className=\"flex items-center gap-3 mb-2\">\r\n            <BuildingOfficeIcon className=\"w-5 h-5 text-text-muted\" />\r\n            <span className=\"text-text-muted\">Platforms</span>\r\n          </div>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {tenant.platforms.map((p) => (\r\n              <span key={p} className=\"px-2 py-1 rounded bg-surface-tertiary text-white text-sm\">\r\n                {p}\r\n              </span>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"p-4 rounded-xl bg-surface-secondary border border-white/10\">\r\n          <div className=\"flex items-center gap-3 mb-2\">\r\n            <UserGroupIcon className=\"w-5 h-5 text-text-muted\" />\r\n            <span className=\"text-text-muted\">Account Manager</span>\r\n          </div>\r\n          <span className=\"text-white font-medium\">{tenant.accountManager}</span>\r\n        </div>\r\n\r\n        <div className=\"p-4 rounded-xl bg-surface-secondary border border-white/10\">\r\n          <div className=\"flex items-center gap-3 mb-2\">\r\n            <CalendarIcon className=\"w-5 h-5 text-text-muted\" />\r\n            <span className=\"text-text-muted\">Customer Since</span>\r\n          </div>\r\n          <span className=\"text-white font-medium\">\r\n            {tenant.createdAt.toLocaleDateString('en-US', { month: 'short', year: 'numeric' })}\r\n          </span>\r\n        </div>\r\n\r\n        <div className=\"p-4 rounded-xl bg-surface-secondary border border-white/10\">\r\n          <div className=\"flex items-center gap-3 mb-2\">\r\n            <Cog6ToothIcon className=\"w-5 h-5 text-text-muted\" />\r\n            <span className=\"text-text-muted\">Features</span>\r\n          </div>\r\n          <div className=\"flex flex-wrap gap-2\">\r\n            {Object.entries(tenant.features)\r\n              .filter(([, enabled]) => enabled)\r\n              .map(([feature]) => (\r\n                <span\r\n                  key={feature}\r\n                  className=\"px-2 py-1 rounded bg-stratum-500/10 text-stratum-400 text-xs\"\r\n                >\r\n                  {feature}\r\n                </span>\r\n              ))}\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* KPI Strip */}\r\n      <KpiStrip kpis={kpis} emqScore={emqScore} />\r\n\r\n      {/* Tabs */}\r\n      <div className=\"flex items-center gap-2 border-b border-white/10 pb-4\">\r\n        {tabs.map((tab) => (\r\n          <button\r\n            key={tab.id}\r\n            onClick={() => setActiveTab(tab.id)}\r\n            className={cn(\r\n              'px-4 py-2 rounded-lg transition-colors',\r\n              activeTab === tab.id\r\n                ? 'bg-stratum-500/10 text-stratum-400'\r\n                : 'text-text-muted hover:text-white hover:bg-white/5'\r\n            )}\r\n          >\r\n            {tab.label}\r\n          </button>\r\n        ))}\r\n      </div>\r\n\r\n      {/* Tab Content */}\r\n      {activeTab === 'overview' && (\r\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n          <div className=\"lg:col-span-2 space-y-6\">\r\n            <EmqScoreCard\r\n              score={emqScore}\r\n              previousScore={emqData?.previousScore ?? 78}\r\n              showDrivers\r\n            />\r\n            <EmqFixPlaybookPanel\r\n              items={playbook}\r\n              onItemClick={(item) => {\r\n                toast({\r\n                  title: item.title,\r\n                  description: `${item.description} â€” Priority: ${item.priority}, Owner: ${item.owner || 'Unassigned'}`,\r\n                });\r\n              }}\r\n              onAssign={(item) => {\r\n                toast({\r\n                  title: 'Assignment requested',\r\n                  description: `\"${item.title}\" has been flagged for assignment to ${item.owner || 'the team'}.`,\r\n                });\r\n              }}\r\n              maxItems={5}\r\n            />\r\n          </div>\r\n          <div>\r\n            <EmqTimeline events={timeline} maxEvents={8} />\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === 'incidents' && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-lg font-semibold text-white\">Incident History</h2>\r\n            <select className=\"px-3 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white focus:outline-none focus:ring-2 focus:ring-stratum-500\">\r\n              <option value=\"30\">Last 30 days</option>\r\n              <option value=\"60\">Last 60 days</option>\r\n              <option value=\"90\">Last 90 days</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden\">\r\n            <table className=\"w-full\">\r\n              <thead>\r\n                <tr className=\"border-b border-white/10\">\r\n                  <th className=\"text-left p-4 text-text-muted font-medium\">Incident</th>\r\n                  <th className=\"text-left p-4 text-text-muted font-medium\">Platform</th>\r\n                  <th className=\"text-left p-4 text-text-muted font-medium\">Severity</th>\r\n                  <th className=\"text-left p-4 text-text-muted font-medium\">Duration</th>\r\n                  <th className=\"text-left p-4 text-text-muted font-medium\">EMQ Impact</th>\r\n                  <th className=\"text-left p-4 text-text-muted font-medium\">Status</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody className=\"divide-y divide-white/5\">\r\n                {timeline.map((event) => (\r\n                  <tr key={event.id} className=\"hover:bg-white/5 transition-colors\">\r\n                    <td className=\"p-4\">\r\n                      <div className=\"font-medium text-white\">{event.title}</div>\r\n                      <div className=\"text-sm text-text-muted\">{event.description}</div>\r\n                    </td>\r\n                    <td className=\"p-4 text-text-muted\">{event.platform || '-'}</td>\r\n                    <td className=\"p-4\">\r\n                      <span\r\n                        className={cn(\r\n                          'px-2 py-1 rounded-full text-xs font-medium',\r\n                          event.severity === 'critical' && 'bg-danger/10 text-danger',\r\n                          event.severity === 'high' && 'bg-orange-500/10 text-orange-400',\r\n                          event.severity === 'medium' && 'bg-warning/10 text-warning',\r\n                          event.severity === 'low' && 'bg-success/10 text-success'\r\n                        )}\r\n                      >\r\n                        {event.severity}\r\n                      </span>\r\n                    </td>\r\n                    <td className=\"p-4 text-text-muted\">\r\n                      {event.recoveryHours ? `${event.recoveryHours}h` : 'Ongoing'}\r\n                    </td>\r\n                    <td className=\"p-4\">\r\n                      {event.emqImpact ? (\r\n                        <span className=\"text-danger\">-{event.emqImpact} pts</span>\r\n                      ) : (\r\n                        <span className=\"text-text-muted\">-</span>\r\n                      )}\r\n                    </td>\r\n                    <td className=\"p-4\">\r\n                      {event.type === 'recovery' ? (\r\n                        <span className=\"flex items-center gap-1 text-success\">\r\n                          <CheckCircleIcon className=\"w-4 h-4\" />\r\n                          Resolved\r\n                        </span>\r\n                      ) : (\r\n                        <span className=\"flex items-center gap-1 text-warning\">\r\n                          <ClockIcon className=\"w-4 h-4\" />\r\n                          Open\r\n                        </span>\r\n                      )}\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === 'actions' && (\r\n        <div className=\"space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <h2 className=\"text-lg font-semibold text-white\">Action Log</h2>\r\n            <button\r\n              onClick={handleRefreshActionLog}\r\n              className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors\"\r\n            >\r\n              <ArrowPathIcon className=\"w-4 h-4\" />\r\n              Refresh\r\n            </button>\r\n          </div>\r\n\r\n          <div className=\"rounded-2xl bg-surface-secondary border border-white/10 p-6\">\r\n            <div className=\"text-center text-text-muted py-8\">\r\n              <ClockIcon className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\r\n              <p>Action log will display automated and manual actions taken.</p>\r\n              <p className=\"text-sm mt-2\">Coming soon</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {activeTab === 'settings' && (\r\n        <div className=\"space-y-6\">\r\n          <h2 className=\"text-lg font-semibold text-white\">Admin Controls</h2>\r\n\r\n          {/* Feature Toggles */}\r\n          <div className=\"rounded-2xl bg-surface-secondary border border-white/10 p-6\">\r\n            <h3 className=\"font-medium text-white mb-4\">Feature Access</h3>\r\n            <div className=\"space-y-4\">\r\n              {Object.entries(tenant.features).map(([feature, enabled]) => (\r\n                <div key={feature} className=\"flex items-center justify-between\">\r\n                  <div>\r\n                    <span className=\"text-white capitalize\">\r\n                      {feature.replace(/([A-Z])/g, ' $1')}\r\n                    </span>\r\n                    <p className=\"text-sm text-text-muted\">\r\n                      {feature === 'autopilot' && 'Automated budget and bid adjustments'}\r\n                      {feature === 'campaignBuilder' && 'Create and publish campaigns'}\r\n                      {feature === 'competitorIntel' && 'Competitor tracking and analysis'}\r\n                      {feature === 'predictions' && 'AI-powered performance predictions'}\r\n                    </p>\r\n                  </div>\r\n                  <button\r\n                    onClick={() => handleFeatureToggle(feature, enabled)}\r\n                    className={cn(\r\n                      'relative w-12 h-6 rounded-full transition-colors',\r\n                      enabled ? 'bg-stratum-500' : 'bg-surface-tertiary'\r\n                    )}\r\n                  >\r\n                    <span\r\n                      className={cn(\r\n                        'absolute top-1 w-4 h-4 rounded-full bg-white transition-transform',\r\n                        enabled ? 'left-7' : 'left-1'\r\n                      )}\r\n                    />\r\n                  </button>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Mode Override */}\r\n          <div className=\"rounded-2xl bg-surface-secondary border border-white/10 p-6\">\r\n            <h3 className=\"font-medium text-white mb-4\">Autopilot Mode Override</h3>\r\n            <p className=\"text-sm text-text-muted mb-4\">\r\n              Override the automated mode selection for this tenant. Use with caution.\r\n            </p>\r\n            <div className=\"flex flex-wrap gap-3\">\r\n              {(['normal', 'limited', 'cuts_only', 'frozen'] as AutopilotMode[]).map((mode) => (\r\n                <button\r\n                  key={mode}\r\n                  onClick={() => handleModeOverride(mode)}\r\n                  disabled={updateAutopilotModeMutation.isPending}\r\n                  className={cn(\r\n                    'px-4 py-2 rounded-lg border transition-colors disabled:opacity-50',\r\n                    autopilotMode === mode\r\n                      ? 'bg-stratum-500/10 border-stratum-500 text-stratum-400'\r\n                      : 'bg-surface-tertiary border-white/10 text-text-muted hover:text-white'\r\n                  )}\r\n                >\r\n                  {mode.replace('_', ' ')}\r\n                </button>\r\n              ))}\r\n            </div>\r\n          </div>\r\n\r\n          {/* Restrictions */}\r\n          <div className=\"rounded-2xl bg-surface-secondary border border-white/10 p-6\">\r\n            <h3 className=\"font-medium text-white mb-4\">Active Restrictions</h3>\r\n            {tenant.restrictions.length > 0 ? (\r\n              <div className=\"space-y-2\">\r\n                {tenant.restrictions.map((r, i) => (\r\n                  <div key={i} className=\"flex items-center gap-2 text-warning\">\r\n                    <ExclamationTriangleIcon className=\"w-4 h-4\" />\r\n                    {r}\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            ) : (\r\n              <div className=\"flex items-center gap-2 text-success\">\r\n                <ShieldCheckIcon className=\"w-5 h-5\" />\r\n                <span>No restrictions applied</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Danger Zone */}\r\n          <div className=\"rounded-2xl bg-danger/5 border border-danger/20 p-6\">\r\n            <h3 className=\"font-medium text-danger mb-4\">Danger Zone</h3>\r\n            <div className=\"flex items-center justify-between\">\r\n              <div>\r\n                <span className=\"text-white\">Suspend Tenant</span>\r\n                <p className=\"text-sm text-text-muted\">\r\n                  Temporarily disable all access and automation\r\n                </p>\r\n              </div>\r\n              <button\r\n                onClick={handleSuspendTenant}\r\n                disabled={suspendTenantMutation.isPending}\r\n                className=\"px-4 py-2 rounded-lg bg-danger/10 border border-danger/20 text-danger hover:bg-danger/20 transition-colors disabled:opacity-50\"\r\n              >\r\n                {suspendTenantMutation.isPending ? 'Suspending...' : 'Suspend'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Confirmation Dialog */}\r\n      <ConfirmDialog\r\n        isOpen={confirmDialog.isOpen}\r\n        title={confirmDialog.title}\r\n        message={confirmDialog.message}\r\n        confirmLabel={confirmDialog.confirmLabel}\r\n        confirmVariant={confirmDialog.confirmVariant}\r\n        onConfirm={confirmDialog.onConfirm}\r\n        onCancel={closeConfirmDialog}\r\n        isLoading={updateAutopilotModeMutation.isPending || suspendTenantMutation.isPending}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n"],"names":["ConfirmDialog","isOpen","title","message","confirmLabel","confirmVariant","onConfirm","onCancel","isLoading","variantStyles","jsxs","jsx","XMarkIcon","cn","TenantProfile","tenantId","useParams","tid","toast","useToast","activeTab","setActiveTab","useState","confirmDialog","setConfirmDialog","localFeatures","setLocalFeatures","dateRange","tenantData","useTenant","emqData","useEmqScore","autopilotData","refetchAutopilot","useAutopilotState","playbookData","useEmqPlaybook","incidentsData","refetchIncidents","useEmqIncidents","updateAutopilotModeMutation","useUpdateAutopilotMode","suspendTenantMutation","useSuspendTenant","emqScore","autopilotMode","budgetAtRisk","tenant","closeConfirmDialog","prev","handleFeatureToggle","feature","currentEnabled","action","handleModeOverride","newMode","error","handleSuspendTenant","handleRefreshActionLog","kpis","playbook","timeline","i","handleAdminAction","tabs","Link","ArrowLeftIcon","UserGroupIcon","ShieldExclamationIcon","TrustStatusHeader","BuildingOfficeIcon","p","CalendarIcon","Cog6ToothIcon","enabled","KpiStrip","tab","EmqScoreCard","EmqFixPlaybookPanel","item","EmqTimeline","event","CheckCircleIcon","ClockIcon","ArrowPathIcon","mode","r","ExclamationTriangleIcon","ShieldCheckIcon"],"mappings":"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"}