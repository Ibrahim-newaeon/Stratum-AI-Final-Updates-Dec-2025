import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as n}from"./vendor-react-Dz7uKsMg.js";import{A as f,s as w,c as l,E as b,w as _,T as S,x as k,a3 as R}from"./index-BQex3859.js";import{R as A}from"./refresh-cw-DLOeozaH.js";import{T as C}from"./trending-down-75FD7zon.js";import{C as F}from"./circle-check-big-CIbPdEH4.js";import{A as O}from"./arrow-up-right-NhE7dUE0.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";const j={meta:"Meta (Facebook)",google:"Google Ads",tiktok:"TikTok",snapchat:"Snapchat"},P={meta:"bg-blue-500",google:"bg-red-500",tiktok:"bg-black",snapchat:"bg-yellow-400"},o=r=>r>=80?"text-green-500":r>=60?"text-blue-500":r>=40?"text-amber-500":"text-red-500",N=r=>r>=80?"bg-green-500/10":r>=60?"bg-blue-500/10":r>=40?"bg-amber-500/10":"bg-red-500/10",v=r=>{const i={Excellent:{label:"Excellent",color:"text-green-500 bg-green-500/10"},Good:{label:"Good",color:"text-blue-500 bg-blue-500/10"},Fair:{label:"Fair",color:"text-amber-500 bg-amber-500/10"},Poor:{label:"Needs Work",color:"text-red-500 bg-red-500/10"}};return i[r]||i.Poor},E=r=>{const i={critical:"bg-red-500/10 text-red-500 border-red-500/20",high:"bg-orange-500/10 text-orange-500 border-orange-500/20",medium:"bg-amber-500/10 text-amber-500 border-amber-500/20",low:"bg-blue-500/10 text-blue-500 border-blue-500/20"};return i[r]||i.medium};function X(){const[r,i]=n.useState(!0),[g,h]=n.useState(!1),[t,u]=n.useState(null),[c,p]=n.useState(null),[T,y]=n.useState(null),m=async()=>{try{h(!0);const a=await(await fetch("/api/v1/capi/quality/report")).json();a.success&&a.data?(u(a.data),!c&&Object.keys(a.data.platform_scores||{}).length>0&&p(Object.keys(a.data.platform_scores)[0])):u(null)}catch(s){console.error("Failed to fetch report:",s),y("Failed to load data quality report")}finally{i(!1),h(!1)}};n.useEffect(()=>{m();const s=setInterval(m,2*60*1e3);return()=>clearInterval(s)},[]);const d=c?t==null?void 0:t.platform_scores[c]:null;return r?e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-40 bg-muted rounded"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx("div",{className:"h-80 bg-muted rounded"}),e.jsx("div",{className:"h-80 bg-muted rounded"})]})]})}):!t||t.overall_score===0?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Data Quality Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Monitor and improve your Event Match Quality"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center",children:[e.jsx(f,{className:"w-16 h-16 text-muted-foreground/50 mb-4"}),e.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"No Data Yet"}),e.jsx("p",{className:"text-muted-foreground max-w-md",children:"Connect platforms and stream conversion events to see your data quality analysis."}),e.jsxs("a",{href:"/capi-setup",className:"mt-6 inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:["Connect Platforms",e.jsx(w,{className:"w-4 h-4"})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Data Quality Dashboard"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"AI-powered analysis to boost your Event Match Quality and ROAS"})]}),e.jsxs("button",{onClick:m,disabled:g,className:"flex items-center gap-2 px-4 py-2 bg-muted hover:bg-muted/80 rounded-lg transition-colors disabled:opacity-50",children:[e.jsx(A,{className:l("w-4 h-4",g&&"animate-spin")}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:l("rounded-xl border p-5",N(t.overall_score)),children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Overall Score"}),e.jsx(f,{className:l("w-5 h-5",o(t.overall_score))})]}),e.jsxs("div",{className:l("text-3xl font-bold",o(t.overall_score)),children:[t.overall_score,"%"]}),e.jsx("div",{className:"mt-2 flex items-center gap-1 text-sm",children:t.trend==="improving"?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-4 h-4 text-green-500"}),e.jsx("span",{className:"text-green-500",children:"Improving"})]}):t.trend==="declining"?e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"w-4 h-4 text-red-500"}),e.jsx("span",{className:"text-red-500",children:"Declining"})]}):e.jsx("span",{className:"text-muted-foreground",children:"Stable"})})]}),e.jsxs("div",{className:"rounded-xl border bg-gradient-to-br from-green-500/10 to-emerald-500/10 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Potential ROAS Lift"}),e.jsx(b,{className:"w-5 h-5 text-green-500"})]}),e.jsxs("div",{className:"text-3xl font-bold text-green-500",children:["+",t.estimated_roas_improvement,"%"]}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fix data gaps to unlock"})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Critical Gaps"}),e.jsx(_,{className:"w-5 h-5 text-red-500"})]}),e.jsx("div",{className:"text-3xl font-bold text-foreground",children:t.data_gaps_summary.critical+t.data_gaps_summary.high}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-red-500/10 text-red-500",children:[t.data_gaps_summary.critical," critical"]}),e.jsxs("span",{className:"px-2 py-0.5 text-xs rounded-full bg-orange-500/10 text-orange-500",children:[t.data_gaps_summary.high," high"]})]})]}),e.jsxs("div",{className:"rounded-xl border bg-card p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Platforms"}),e.jsx(S,{className:"w-5 h-5 text-primary"})]}),e.jsx("div",{className:"text-3xl font-bold text-foreground",children:Object.keys(t.platform_scores).length}),e.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Active connections"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 rounded-xl border bg-card overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b",children:e.jsx("h2",{className:"font-semibold text-foreground",children:"Platform Match Quality"})}),e.jsx("div",{className:"flex border-b overflow-x-auto",children:Object.entries(t.platform_scores).map(([s,a])=>e.jsxs("button",{onClick:()=>p(s),className:l("flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors whitespace-nowrap",c===s?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:[e.jsx("div",{className:l("w-3 h-3 rounded-full",P[s])}),j[s]||s,e.jsxs("span",{className:l("px-1.5 py-0.5 text-xs rounded",N(a.score),o(a.score)),children:[a.score,"%"]})]},s))}),d&&e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:l("text-4xl font-bold",o(d.score)),children:[d.score,"%"]}),e.jsx("span",{className:l("px-3 py-1 rounded-full text-sm font-medium",v(d.quality_level).color),children:v(d.quality_level).label})]}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Event Match Quality Score"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-500",children:["+",d.potential_roas_lift,"%"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"ROAS lift potential"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-foreground mb-2 flex items-center gap-2",children:[e.jsx(F,{className:"w-4 h-4 text-green-500"}),"Fields Present (",d.fields_present.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.fields_present.map(s=>e.jsx("span",{className:"px-2 py-1 text-xs bg-green-500/10 text-green-600 rounded-full",children:s},s))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-foreground mb-2 flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4 text-red-500"}),"Fields Missing (",d.fields_missing.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:d.fields_missing.map(s=>e.jsx("span",{className:"px-2 py-1 text-xs bg-red-500/10 text-red-600 rounded-full",children:s},s))})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-3",children:"Data Gaps to Fix"}),e.jsx("div",{className:"space-y-3",children:d.data_gaps.map((s,a)=>e.jsxs("div",{className:l("p-4 rounded-lg border",E(s.severity)),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium",children:s.field}),e.jsx("span",{className:l("px-2 py-0.5 text-xs rounded-full uppercase font-semibold",s.severity==="critical"?"bg-red-500 text-white":s.severity==="high"?"bg-orange-500 text-white":"bg-amber-500 text-white"),children:s.severity})]}),e.jsx("p",{className:"text-sm",children:s.recommendation})]}),e.jsxs("span",{className:"text-sm font-semibold",children:["+",s.impact_percent,"%"]})]}),e.jsxs("div",{className:"mt-2 p-2 bg-background/50 rounded text-xs",children:[e.jsx("strong",{children:"How to fix:"})," ",s.how_to_fix]})]},a))})]})]})]}),e.jsxs("div",{className:"rounded-xl border bg-card overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-primary/5 to-transparent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-primary"}),e.jsx("h2",{className:"font-semibold text-foreground",children:"Top Recommendations"})]})}),e.jsx("div",{className:"p-4 space-y-3",children:t.top_recommendations.map((s,a)=>e.jsx("div",{className:"p-4 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:l("w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white",s.priority===1?"bg-red-500":s.priority===2?"bg-orange-500":"bg-amber-500"),children:s.priority}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"font-medium text-foreground",children:s.field}),e.jsx("span",{className:"text-xs text-green-500 font-semibold",children:s.impact})]}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:s.action}),e.jsx("div",{className:"flex flex-wrap gap-1",children:s.affected_platforms.map(x=>e.jsx("span",{className:"px-2 py-0.5 text-xs bg-primary/10 text-primary rounded",children:j[x]||x},x))})]})]})},a))}),e.jsx("div",{className:"px-6 py-4 border-t bg-muted/30",children:e.jsxs("a",{href:"/capi-setup",className:"flex items-center justify-center gap-2 text-sm text-primary hover:underline",children:["Configure Platform Settings",e.jsx(O,{className:"w-4 h-4"})]})})]})]})]})}export{X as DataQuality,X as default};
//# sourceMappingURL=DataQuality-7YU-Y6fo.js.map
