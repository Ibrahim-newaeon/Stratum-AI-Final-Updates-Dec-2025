{"version":3,"file":"Rules-DkX704mF.js","sources":["../../src/api/rules.ts","../../src/views/Rules.tsx"],"sourcesContent":["/**\r\n * Stratum AI - Automation Rules API\r\n *\r\n * Automation rules builder and execution endpoints\r\n */\r\n\r\nimport { useMutation, useQuery, useQueryClient } from '@tanstack/react-query';\r\nimport { apiClient, ApiResponse, PaginatedResponse } from './client';\r\n\r\n// Types\r\nexport type RuleStatus = 'active' | 'paused' | 'draft';\r\nexport type RuleTrigger = 'schedule' | 'metric_threshold' | 'event' | 'manual';\r\nexport type RuleAction =\r\n  | 'pause_campaign'\r\n  | 'adjust_budget'\r\n  | 'adjust_bid'\r\n  | 'send_alert'\r\n  | 'pause_asset';\r\nexport type ConditionOperator = 'gt' | 'gte' | 'lt' | 'lte' | 'eq' | 'neq' | 'between';\r\n\r\nexport interface RuleCondition {\r\n  metric: string;\r\n  operator: ConditionOperator;\r\n  value: number | [number, number];\r\n  window?: string; // e.g., '24h', '7d'\r\n}\r\n\r\nexport interface RuleActionConfig {\r\n  type: RuleAction;\r\n  params: Record<string, unknown>;\r\n}\r\n\r\nexport interface Rule {\r\n  id: string;\r\n  tenantId: number;\r\n  name: string;\r\n  description: string | null;\r\n  status: RuleStatus;\r\n  trigger: RuleTrigger;\r\n  conditions: RuleCondition[];\r\n  conditionLogic: 'and' | 'or';\r\n  actions: RuleActionConfig[];\r\n  platforms: string[];\r\n  campaignIds: string[] | null; // null = all campaigns\r\n  schedule?: {\r\n    cron?: string;\r\n    timezone: string;\r\n  };\r\n  createdAt: string;\r\n  updatedAt: string;\r\n  lastRunAt: string | null;\r\n  runCount: number;\r\n}\r\n\r\nexport interface RuleExecution {\r\n  id: string;\r\n  ruleId: string;\r\n  status: 'success' | 'failed' | 'skipped';\r\n  triggeredAt: string;\r\n  completedAt: string | null;\r\n  affectedCampaigns: string[];\r\n  actionsExecuted: {\r\n    type: RuleAction;\r\n    campaignId: string;\r\n    result: 'success' | 'failed';\r\n    details: Record<string, unknown>;\r\n  }[];\r\n  error: string | null;\r\n}\r\n\r\nexport interface RuleFilters {\r\n  status?: RuleStatus;\r\n  trigger?: RuleTrigger;\r\n  platform?: string;\r\n  search?: string;\r\n  skip?: number;\r\n  limit?: number;\r\n}\r\n\r\nexport interface CreateRuleRequest {\r\n  name: string;\r\n  description?: string;\r\n  trigger: RuleTrigger;\r\n  conditions: RuleCondition[];\r\n  conditionLogic?: 'and' | 'or';\r\n  actions: RuleActionConfig[];\r\n  platforms?: string[];\r\n  campaignIds?: string[];\r\n  schedule?: {\r\n    cron?: string;\r\n    timezone?: string;\r\n  };\r\n}\r\n\r\nexport interface UpdateRuleRequest extends Partial<CreateRuleRequest> {\r\n  status?: RuleStatus;\r\n}\r\n\r\n// API Functions\r\nexport const rulesApi = {\r\n  /**\r\n   * Get all rules with optional filters\r\n   */\r\n  getRules: async (filters: RuleFilters = {}): Promise<PaginatedResponse<Rule>> => {\r\n    const response = await apiClient.get<ApiResponse<PaginatedResponse<Rule>>>('/rules', {\r\n      params: filters,\r\n    });\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Get a single rule by ID\r\n   */\r\n  getRule: async (id: string): Promise<Rule> => {\r\n    const response = await apiClient.get<ApiResponse<Rule>>(`/rules/${id}`);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Create a new rule\r\n   */\r\n  createRule: async (data: CreateRuleRequest): Promise<Rule> => {\r\n    const response = await apiClient.post<ApiResponse<Rule>>('/rules', data);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Update an existing rule\r\n   */\r\n  updateRule: async (id: string, data: UpdateRuleRequest): Promise<Rule> => {\r\n    const response = await apiClient.patch<ApiResponse<Rule>>(`/rules/${id}`, data);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Delete a rule\r\n   */\r\n  deleteRule: async (id: string): Promise<void> => {\r\n    await apiClient.delete(`/rules/${id}`);\r\n  },\r\n\r\n  /**\r\n   * Toggle rule status\r\n   */\r\n  toggleRule: async (id: string): Promise<Rule> => {\r\n    const response = await apiClient.post<ApiResponse<Rule>>(`/rules/${id}/toggle`);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Execute a rule manually\r\n   */\r\n  executeRule: async (id: string): Promise<RuleExecution> => {\r\n    const response = await apiClient.post<ApiResponse<RuleExecution>>(`/rules/${id}/execute`);\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Get rule execution history\r\n   */\r\n  getRuleExecutions: async (id: string, limit: number = 10): Promise<RuleExecution[]> => {\r\n    const response = await apiClient.get<ApiResponse<RuleExecution[]>>(`/rules/${id}/executions`, {\r\n      params: { limit },\r\n    });\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Get rule templates\r\n   */\r\n  getTemplates: async (): Promise<Partial<Rule>[]> => {\r\n    const response = await apiClient.get<ApiResponse<Partial<Rule>[]>>('/rules/templates');\r\n    return response.data.data;\r\n  },\r\n\r\n  /**\r\n   * Validate rule conditions\r\n   */\r\n  validateConditions: async (\r\n    conditions: RuleCondition[]\r\n  ): Promise<{ valid: boolean; errors: string[] }> => {\r\n    const response = await apiClient.post<ApiResponse<{ valid: boolean; errors: string[] }>>(\r\n      '/rules/validate',\r\n      { conditions }\r\n    );\r\n    return response.data.data;\r\n  },\r\n};\r\n\r\n// React Query Hooks\r\n\r\nexport function useRules(filters: RuleFilters = {}) {\r\n  return useQuery({\r\n    queryKey: ['rules', filters],\r\n    queryFn: () => rulesApi.getRules(filters),\r\n    staleTime: 30 * 1000,\r\n  });\r\n}\r\n\r\nexport function useRule(id: string) {\r\n  return useQuery({\r\n    queryKey: ['rules', id],\r\n    queryFn: () => rulesApi.getRule(id),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function useCreateRule() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: rulesApi.createRule,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['rules'] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useUpdateRule() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: ({ id, data }: { id: string; data: UpdateRuleRequest }) =>\r\n      rulesApi.updateRule(id, data),\r\n    onSuccess: (_, variables) => {\r\n      queryClient.invalidateQueries({ queryKey: ['rules'] });\r\n      queryClient.invalidateQueries({ queryKey: ['rules', variables.id] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useDeleteRule() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: rulesApi.deleteRule,\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: ['rules'] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useToggleRule() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: rulesApi.toggleRule,\r\n    onSuccess: (_, id) => {\r\n      queryClient.invalidateQueries({ queryKey: ['rules'] });\r\n      queryClient.invalidateQueries({ queryKey: ['rules', id] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useExecuteRule() {\r\n  const queryClient = useQueryClient();\r\n\r\n  return useMutation({\r\n    mutationFn: rulesApi.executeRule,\r\n    onSuccess: (_, id) => {\r\n      queryClient.invalidateQueries({ queryKey: ['rules', id, 'executions'] });\r\n    },\r\n  });\r\n}\r\n\r\nexport function useRuleExecutions(id: string, limit: number = 10) {\r\n  return useQuery({\r\n    queryKey: ['rules', id, 'executions', limit],\r\n    queryFn: () => rulesApi.getRuleExecutions(id, limit),\r\n    enabled: !!id,\r\n  });\r\n}\r\n\r\nexport function useRuleTemplates() {\r\n  return useQuery({\r\n    queryKey: ['rules', 'templates'],\r\n    queryFn: rulesApi.getTemplates,\r\n    staleTime: 10 * 60 * 1000, // 10 minutes\r\n  });\r\n}\r\n\r\nexport function useValidateConditions() {\r\n  return useMutation({\r\n    mutationFn: rulesApi.validateConditions,\r\n  });\r\n}\r\n","import { useCallback, useMemo, useState } from 'react';\r\nimport { useTranslation } from 'react-i18next';\r\nimport {\r\n  Bell,\r\n  CheckCircle2,\r\n  ChevronRight,\r\n  Clock,\r\n  Copy,\r\n  DollarSign,\r\n  Edit,\r\n  Loader2,\r\n  MessageCircle,\r\n  Pause,\r\n  Play,\r\n  Plus,\r\n  Search,\r\n  Settings,\r\n  Tag,\r\n  Trash2,\r\n  X,\r\n  Zap,\r\n} from 'lucide-react';\r\nimport { cn } from '@/lib/utils';\r\nimport { useRules, useToggleRule, useCreateRule, useUpdateRule, useDeleteRule } from '@/api/hooks';\r\nimport { useToast } from '@/components/ui/use-toast';\r\n\r\ntype RuleStatus = 'active' | 'paused' | 'draft';\r\ntype RuleAction =\r\n  | 'apply_label'\r\n  | 'send_alert'\r\n  | 'pause_campaign'\r\n  | 'adjust_budget'\r\n  | 'notify_slack'\r\n  | 'notify_whatsapp';\r\n\r\ninterface Rule {\r\n  id: number;\r\n  name: string;\r\n  description: string;\r\n  status: RuleStatus;\r\n  condition: {\r\n    field: string;\r\n    operator: string;\r\n    value: string;\r\n  };\r\n  action: {\r\n    type: RuleAction;\r\n    config: Record<string, any>;\r\n  };\r\n  appliesTo: string[];\r\n  triggerCount: number;\r\n  lastTriggered: string | null;\r\n  cooldownHours: number;\r\n  createdAt: string;\r\n}\r\n\r\nconst mockRules: Rule[] = [\r\n  {\r\n    id: 1,\r\n    name: 'WhatsApp Alert for Budget Overspend',\r\n    description: 'Send WhatsApp notification when campaign spends over 80% of budget',\r\n    status: 'active',\r\n    condition: { field: 'spend', operator: 'greater_than', value: '800' },\r\n    action: {\r\n      type: 'notify_whatsapp',\r\n      config: { contact_ids: [1, 2], template_name: 'rule_alert' },\r\n    },\r\n    appliesTo: ['Summer Sale 2024', 'Brand Awareness Q4'],\r\n    triggerCount: 7,\r\n    lastTriggered: '2024-12-06T08:00:00Z',\r\n    cooldownHours: 12,\r\n    createdAt: '2024-12-01',\r\n  },\r\n  {\r\n    id: 2,\r\n    name: 'Pause Low ROAS Campaigns',\r\n    description: 'Automatically pause campaigns when ROAS drops below 2.0',\r\n    status: 'active',\r\n    condition: { field: 'roas', operator: 'less_than', value: '2.0' },\r\n    action: { type: 'pause_campaign', config: {} },\r\n    appliesTo: ['All Campaigns'],\r\n    triggerCount: 12,\r\n    lastTriggered: '2024-11-28T14:30:00Z',\r\n    cooldownHours: 24,\r\n    createdAt: '2024-06-15',\r\n  },\r\n  {\r\n    id: 3,\r\n    name: 'Alert on High Spend',\r\n    description: 'Send alert when daily spend exceeds $500',\r\n    status: 'active',\r\n    condition: { field: 'spend', operator: 'greater_than', value: '500' },\r\n    action: { type: 'send_alert', config: { email: 'marketing@company.com' } },\r\n    appliesTo: ['Summer Sale 2024', 'Brand Awareness Q4'],\r\n    triggerCount: 45,\r\n    lastTriggered: '2024-11-29T09:15:00Z',\r\n    cooldownHours: 4,\r\n    createdAt: '2024-07-20',\r\n  },\r\n  {\r\n    id: 4,\r\n    name: 'Label High Performers',\r\n    description: 'Apply \"star\" label to campaigns with ROAS above 4.0',\r\n    status: 'active',\r\n    condition: { field: 'roas', operator: 'greater_than', value: '4.0' },\r\n    action: { type: 'apply_label', config: { label: 'star-performer' } },\r\n    appliesTo: ['All Campaigns'],\r\n    triggerCount: 8,\r\n    lastTriggered: '2024-11-27T16:45:00Z',\r\n    cooldownHours: 12,\r\n    createdAt: '2024-08-10',\r\n  },\r\n  {\r\n    id: 5,\r\n    name: 'Budget Boost for Winners',\r\n    description: 'Increase budget by 20% when CTR exceeds 3%',\r\n    status: 'paused',\r\n    condition: { field: 'ctr', operator: 'greater_than', value: '3.0' },\r\n    action: { type: 'adjust_budget', config: { adjustment_percent: 20 } },\r\n    appliesTo: ['Product Launch - Widget Pro'],\r\n    triggerCount: 3,\r\n    lastTriggered: '2024-11-25T11:00:00Z',\r\n    cooldownHours: 48,\r\n    createdAt: '2024-09-05',\r\n  },\r\n  {\r\n    id: 6,\r\n    name: 'Slack Alert for Fatigue',\r\n    description: 'Notify Slack when creative fatigue score exceeds 70%',\r\n    status: 'draft',\r\n    condition: { field: 'fatigue_score', operator: 'greater_than', value: '70' },\r\n    action: { type: 'notify_slack', config: { channel: '#marketing-alerts' } },\r\n    appliesTo: [],\r\n    triggerCount: 0,\r\n    lastTriggered: null,\r\n    cooldownHours: 24,\r\n    createdAt: '2024-11-28',\r\n  },\r\n];\r\n\r\nconst operators = [\r\n  { value: 'equals', label: '=' },\r\n  { value: 'not_equals', label: '≠' },\r\n  { value: 'greater_than', label: '>' },\r\n  { value: 'less_than', label: '<' },\r\n  { value: 'greater_than_or_equal', label: '≥' },\r\n  { value: 'less_than_or_equal', label: '≤' },\r\n];\r\n\r\nconst fields = [\r\n  'roas',\r\n  'ctr',\r\n  'cpc',\r\n  'cpa',\r\n  'spend',\r\n  'impressions',\r\n  'clicks',\r\n  'conversions',\r\n  'fatigue_score',\r\n];\r\n\r\nexport function Rules() {\r\n  const { t } = useTranslation();\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [statusFilter, setStatusFilter] = useState<string>('all');\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n\r\n  const { toast } = useToast();\r\n\r\n  // Modal state\r\n  const [editingRule, setEditingRule] = useState<Rule | null>(null);\r\n  const [showDeleteConfirm, setShowDeleteConfirm] = useState<Rule | null>(null);\r\n  const [ruleForm, setRuleForm] = useState({\r\n    name: '',\r\n    description: '',\r\n    conditionField: 'roas',\r\n    conditionOperator: 'less_than',\r\n    conditionValue: '',\r\n    actionType: 'send_alert' as RuleAction,\r\n    cooldownHours: 24,\r\n  });\r\n\r\n  // Fetch rules from API\r\n  const { data: rulesData, isLoading } = useRules();\r\n  const toggleRule = useToggleRule();\r\n  const createRule = useCreateRule();\r\n  const updateRule = useUpdateRule();\r\n  const deleteRule = useDeleteRule();\r\n\r\n  const resetForm = useCallback(() => {\r\n    setRuleForm({\r\n      name: '',\r\n      description: '',\r\n      conditionField: 'roas',\r\n      conditionOperator: 'less_than',\r\n      conditionValue: '',\r\n      actionType: 'send_alert',\r\n      cooldownHours: 24,\r\n    });\r\n    setEditingRule(null);\r\n  }, []);\r\n\r\n  const openCreateModal = useCallback(() => {\r\n    resetForm();\r\n    setShowCreateModal(true);\r\n  }, [resetForm]);\r\n\r\n  const openEditModal = useCallback((rule: Rule) => {\r\n    setEditingRule(rule);\r\n    setRuleForm({\r\n      name: rule.name,\r\n      description: rule.description,\r\n      conditionField: rule.condition.field,\r\n      conditionOperator: rule.condition.operator,\r\n      conditionValue: rule.condition.value,\r\n      actionType: rule.action.type,\r\n      cooldownHours: rule.cooldownHours,\r\n    });\r\n    setShowCreateModal(true);\r\n  }, []);\r\n\r\n  const handleDuplicate = useCallback(async (rule: Rule) => {\r\n    try {\r\n      await createRule.mutateAsync({\r\n        name: `${rule.name} (Copy)`,\r\n        description: rule.description,\r\n        conditions: [{ field: rule.condition.field, operator: rule.condition.operator as any, value: rule.condition.value }],\r\n        actions: [{ type: rule.action.type as any, config: rule.action.config }],\r\n        trigger: 'metric_threshold',\r\n        status: 'draft',\r\n      } as any);\r\n      toast({ title: 'Rule duplicated', description: `\"${rule.name}\" has been duplicated as a draft.` });\r\n    } catch {\r\n      toast({ title: 'Error', description: 'Failed to duplicate rule.', variant: 'destructive' });\r\n    }\r\n  }, [createRule, toast]);\r\n\r\n  const handleSaveRule = useCallback(async () => {\r\n    if (!ruleForm.name.trim() || !ruleForm.conditionValue.trim()) return;\r\n\r\n    const payload = {\r\n      name: ruleForm.name,\r\n      description: ruleForm.description,\r\n      conditions: [{\r\n        field: ruleForm.conditionField,\r\n        operator: ruleForm.conditionOperator as any,\r\n        value: ruleForm.conditionValue,\r\n      }],\r\n      actions: [{\r\n        type: ruleForm.actionType as any,\r\n        config: {},\r\n      }],\r\n      trigger: 'metric_threshold' as const,\r\n      cooldown_hours: ruleForm.cooldownHours,\r\n    };\r\n\r\n    try {\r\n      if (editingRule) {\r\n        await updateRule.mutateAsync({ id: editingRule.id.toString(), data: payload as any });\r\n        toast({ title: 'Rule updated', description: `\"${ruleForm.name}\" has been updated.` });\r\n      } else {\r\n        await createRule.mutateAsync(payload as any);\r\n        toast({ title: 'Rule created', description: `\"${ruleForm.name}\" has been created.` });\r\n      }\r\n      setShowCreateModal(false);\r\n      resetForm();\r\n    } catch {\r\n      toast({ title: 'Error', description: `Failed to ${editingRule ? 'update' : 'create'} rule.`, variant: 'destructive' });\r\n    }\r\n  }, [ruleForm, editingRule, createRule, updateRule, toast, resetForm]);\r\n\r\n  const handleDeleteRule = useCallback(async (rule: Rule) => {\r\n    try {\r\n      await deleteRule.mutateAsync(rule.id.toString());\r\n      toast({ title: 'Rule deleted', description: `\"${rule.name}\" has been deleted.` });\r\n      setShowDeleteConfirm(null);\r\n    } catch {\r\n      toast({ title: 'Error', description: 'Failed to delete rule.', variant: 'destructive' });\r\n    }\r\n  }, [deleteRule, toast]);\r\n\r\n  // Transform API data or fall back to mock\r\n  const rules = useMemo((): Rule[] => {\r\n    if (rulesData?.items && rulesData.items.length > 0) {\r\n      return rulesData.items.map((r: any) => ({\r\n        id: Number(r.id) || 0,\r\n        name: r.name || '',\r\n        description: r.description || '',\r\n        status: r.status || r.is_active ? 'active' : 'paused',\r\n        condition: r.condition ||\r\n          r.conditions?.[0] || { field: 'roas', operator: 'less_than', value: '2.0' },\r\n        action: r.action || r.actions?.[0] || { type: 'send_alert', config: {} },\r\n        appliesTo: r.applies_to || r.campaigns || [],\r\n        triggerCount: r.trigger_count || r.triggerCount || 0,\r\n        lastTriggered: r.last_triggered || r.lastTriggered || null,\r\n        cooldownHours: r.cooldown_hours || r.cooldownHours || 24,\r\n        createdAt: r.created_at || r.createdAt || new Date().toISOString(),\r\n      }));\r\n    }\r\n    return mockRules;\r\n  }, [rulesData]);\r\n\r\n  // Handle toggle rule status\r\n  const handleToggleRule = async (ruleId: number, _currentStatus: RuleStatus) => {\r\n    await toggleRule.mutateAsync(ruleId.toString());\r\n  };\r\n\r\n  const filteredRules = rules.filter((rule) => {\r\n    if (searchQuery && !rule.name.toLowerCase().includes(searchQuery.toLowerCase())) {\r\n      return false;\r\n    }\r\n    if (statusFilter !== 'all' && rule.status !== statusFilter) {\r\n      return false;\r\n    }\r\n    return true;\r\n  });\r\n\r\n  const getStatusBadge = (status: RuleStatus) => {\r\n    const config = {\r\n      active: { color: 'bg-green-500/10 text-green-500', icon: CheckCircle2, label: 'Active' },\r\n      paused: { color: 'bg-amber-500/10 text-amber-500', icon: Pause, label: 'Paused' },\r\n      draft: { color: 'bg-gray-500/10 text-gray-500', icon: Edit, label: 'Draft' },\r\n    };\r\n    const { color, icon: Icon, label } = config[status];\r\n    return (\r\n      <span\r\n        className={cn(\r\n          'px-2 py-1 rounded-full text-xs font-medium inline-flex items-center gap-1',\r\n          color\r\n        )}\r\n      >\r\n        <Icon className=\"w-3 h-3\" />\r\n        {label}\r\n      </span>\r\n    );\r\n  };\r\n\r\n  const getActionIcon = (action: RuleAction) => {\r\n    switch (action) {\r\n      case 'apply_label':\r\n        return <Tag className=\"w-4 h-4 text-blue-500\" />;\r\n      case 'send_alert':\r\n        return <Bell className=\"w-4 h-4 text-amber-500\" />;\r\n      case 'pause_campaign':\r\n        return <Pause className=\"w-4 h-4 text-red-500\" />;\r\n      case 'adjust_budget':\r\n        return <DollarSign className=\"w-4 h-4 text-green-500\" />;\r\n      case 'notify_slack':\r\n        return <Settings className=\"w-4 h-4 text-purple-500\" />;\r\n      case 'notify_whatsapp':\r\n        return <MessageCircle className=\"w-4 h-4 text-green-600\" />;\r\n    }\r\n  };\r\n\r\n  const getActionLabel = (action: RuleAction) => {\r\n    const labels = {\r\n      apply_label: 'Apply Label',\r\n      send_alert: 'Send Alert',\r\n      pause_campaign: 'Pause Campaign',\r\n      adjust_budget: 'Adjust Budget',\r\n      notify_slack: 'Notify Slack',\r\n      notify_whatsapp: 'Notify WhatsApp',\r\n    };\r\n    return labels[action];\r\n  };\r\n\r\n  const getOperatorLabel = (operator: string) => {\r\n    return operators.find((op) => op.value === operator)?.label || operator;\r\n  };\r\n\r\n  const formatLastTriggered = (date: string | null) => {\r\n    if (!date) return 'Never';\r\n    const d = new Date(date);\r\n    const now = new Date();\r\n    const diffHours = Math.floor((now.getTime() - d.getTime()) / (1000 * 60 * 60));\r\n\r\n    if (diffHours < 1) return 'Just now';\r\n    if (diffHours < 24) return `${diffHours}h ago`;\r\n    if (diffHours < 48) return 'Yesterday';\r\n    return d.toLocaleDateString();\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Page Header */}\r\n      <div className=\"flex flex-col md:flex-row md:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold flex items-center gap-2\">\r\n            <Zap className=\"w-7 h-7 text-primary\" />\r\n            {t('rules.title')}\r\n          </h1>\r\n          <p className=\"text-muted-foreground\">{t('rules.subtitle')}</p>\r\n        </div>\r\n\r\n        <button\r\n          onClick={openCreateModal}\r\n          className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors\"\r\n        >\r\n          <Plus className=\"w-4 h-4\" />\r\n          <span>{t('rules.createRule')}</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Stats */}\r\n      <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n        <div className=\"metric-card info p-4\">\r\n          <p className=\"text-sm text-muted-foreground mb-1\">{t('rules.totalRules')}</p>\r\n          <p className=\"text-2xl font-bold\">{isLoading ? '...' : rules.length}</p>\r\n        </div>\r\n        <div className=\"metric-card success p-4\">\r\n          <p className=\"text-sm text-muted-foreground mb-1\">{t('rules.activeRules')}</p>\r\n          <p className=\"text-2xl font-bold text-green-500\">\r\n            {isLoading ? '...' : rules.filter((r) => r.status === 'active').length}\r\n          </p>\r\n        </div>\r\n        <div className=\"metric-card active p-4\">\r\n          <p className=\"text-sm text-muted-foreground mb-1\">{t('rules.triggersToday')}</p>\r\n          <p className=\"text-2xl font-bold text-primary\">23</p>\r\n        </div>\r\n        <div className=\"metric-card premium p-4\">\r\n          <p className=\"text-sm text-muted-foreground mb-1\">{t('rules.actionsExecuted')}</p>\r\n          <p className=\"text-2xl font-bold\">\r\n            {isLoading ? '...' : rules.reduce((acc, r) => acc + r.triggerCount, 0)}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Filters */}\r\n      <div className=\"flex flex-col md:flex-row gap-4\">\r\n        <div className=\"relative flex-1\">\r\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\r\n          <input\r\n            type=\"text\"\r\n            placeholder={t('rules.searchPlaceholder')}\r\n            value={searchQuery}\r\n            onChange={(e) => setSearchQuery(e.target.value)}\r\n            className=\"w-full pl-10 pr-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20\"\r\n          />\r\n        </div>\r\n\r\n        <select\r\n          value={statusFilter}\r\n          onChange={(e) => setStatusFilter(e.target.value)}\r\n          className=\"px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20\"\r\n        >\r\n          <option value=\"all\">{t('rules.allStatuses')}</option>\r\n          <option value=\"active\">{t('rules.active')}</option>\r\n          <option value=\"paused\">{t('rules.paused')}</option>\r\n          <option value=\"draft\">{t('rules.draft')}</option>\r\n        </select>\r\n      </div>\r\n\r\n      {/* Rules List */}\r\n      <div className=\"space-y-4\">\r\n        {filteredRules.map((rule) => (\r\n          <div\r\n            key={rule.id}\r\n            className=\"rounded-xl border bg-card p-5 hover:shadow-md transition-shadow\"\r\n          >\r\n            <div className=\"flex items-start justify-between mb-4\">\r\n              <div className=\"flex items-start gap-4\">\r\n                <div className=\"p-2 rounded-lg bg-primary/10\">\r\n                  <Zap className=\"w-5 h-5 text-primary\" />\r\n                </div>\r\n                <div>\r\n                  <div className=\"flex items-center gap-2 mb-1\">\r\n                    <h3 className=\"font-semibold\">{rule.name}</h3>\r\n                    {getStatusBadge(rule.status)}\r\n                  </div>\r\n                  <p className=\"text-sm text-muted-foreground\">{rule.description}</p>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"flex items-center gap-2\">\r\n                {rule.status === 'active' ? (\r\n                  <button\r\n                    onClick={() => handleToggleRule(rule.id, rule.status)}\r\n                    disabled={toggleRule.isPending}\r\n                    className=\"p-2 rounded-lg hover:bg-muted transition-colors disabled:opacity-50\"\r\n                    title=\"Pause\"\r\n                  >\r\n                    {toggleRule.isPending ? (\r\n                      <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                    ) : (\r\n                      <Pause className=\"w-4 h-4\" />\r\n                    )}\r\n                  </button>\r\n                ) : (\r\n                  <button\r\n                    onClick={() => handleToggleRule(rule.id, rule.status)}\r\n                    disabled={toggleRule.isPending}\r\n                    className=\"p-2 rounded-lg hover:bg-muted transition-colors disabled:opacity-50\"\r\n                    title=\"Activate\"\r\n                  >\r\n                    {toggleRule.isPending ? (\r\n                      <Loader2 className=\"w-4 h-4 animate-spin\" />\r\n                    ) : (\r\n                      <Play className=\"w-4 h-4\" />\r\n                    )}\r\n                  </button>\r\n                )}\r\n                <button\r\n                  onClick={() => openEditModal(rule)}\r\n                  className=\"p-2 rounded-lg hover:bg-muted transition-colors\"\r\n                  title=\"Edit\"\r\n                >\r\n                  <Edit className=\"w-4 h-4\" />\r\n                </button>\r\n                <button\r\n                  onClick={() => handleDuplicate(rule)}\r\n                  disabled={createRule.isPending}\r\n                  className=\"p-2 rounded-lg hover:bg-muted transition-colors disabled:opacity-50\"\r\n                  title=\"Duplicate\"\r\n                >\r\n                  <Copy className=\"w-4 h-4\" />\r\n                </button>\r\n                <button\r\n                  onClick={() => setShowDeleteConfirm(rule)}\r\n                  className=\"p-2 rounded-lg hover:bg-muted hover:text-red-500 transition-colors\"\r\n                  title=\"Delete\"\r\n                >\r\n                  <Trash2 className=\"w-4 h-4\" />\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Rule Logic Display */}\r\n            <div className=\"flex flex-wrap items-center gap-2 mb-4 p-3 rounded-lg bg-muted/50\">\r\n              <span className=\"text-sm font-medium text-primary\">IF</span>\r\n              <span className=\"px-2 py-1 rounded bg-background text-sm font-mono\">\r\n                {rule.condition.field}\r\n              </span>\r\n              <span className=\"text-sm font-bold\">{getOperatorLabel(rule.condition.operator)}</span>\r\n              <span className=\"px-2 py-1 rounded bg-background text-sm font-mono\">\r\n                {rule.condition.value}\r\n              </span>\r\n              <ChevronRight className=\"w-4 h-4 text-muted-foreground\" />\r\n              <span className=\"text-sm font-medium text-primary\">THEN</span>\r\n              <div className=\"flex items-center gap-1 px-2 py-1 rounded bg-background\">\r\n                {getActionIcon(rule.action.type)}\r\n                <span className=\"text-sm\">{getActionLabel(rule.action.type)}</span>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Rule Metadata */}\r\n            <div className=\"flex flex-wrap items-center gap-6 text-sm\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-muted-foreground\">{t('rules.appliesTo')}:</span>\r\n                <span className=\"font-medium\">\r\n                  {rule.appliesTo.length > 0 ? rule.appliesTo.join(', ') : 'Not configured'}\r\n                </span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Clock className=\"w-4 h-4 text-muted-foreground\" />\r\n                <span className=\"text-muted-foreground\">{t('rules.cooldown')}:</span>\r\n                <span className=\"font-medium\">{rule.cooldownHours}h</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <Zap className=\"w-4 h-4 text-muted-foreground\" />\r\n                <span className=\"text-muted-foreground\">{t('rules.triggered')}:</span>\r\n                <span className=\"font-medium\">{rule.triggerCount} times</span>\r\n              </div>\r\n              <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-muted-foreground\">{t('rules.lastTriggered')}:</span>\r\n                <span className=\"font-medium\">{formatLastTriggered(rule.lastTriggered)}</span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        ))}\r\n      </div>\r\n\r\n      {filteredRules.length === 0 && (\r\n        <div className=\"text-center py-12\">\r\n          <Zap className=\"w-12 h-12 mx-auto text-muted-foreground mb-4\" />\r\n          <p className=\"text-muted-foreground\">{t('rules.noRules')}</p>\r\n          <button\r\n            onClick={openCreateModal}\r\n            className=\"mt-4 text-primary hover:underline\"\r\n          >\r\n            {t('rules.createFirst')}\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* Create/Edit Rule Modal */}\r\n      {showCreateModal && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-background rounded-xl p-6 w-full max-w-2xl mx-4 max-h-[85vh] overflow-y-auto\">\r\n            <div className=\"flex items-center justify-between mb-4\">\r\n              <h2 className=\"text-xl font-bold\">\r\n                {editingRule ? 'Edit Rule' : t('rules.createRule')}\r\n              </h2>\r\n              <button\r\n                onClick={() => { setShowCreateModal(false); resetForm(); }}\r\n                className=\"p-2 rounded-lg hover:bg-muted transition-colors\"\r\n              >\r\n                <X className=\"w-4 h-4\" />\r\n              </button>\r\n            </div>\r\n\r\n            <div className=\"space-y-4\">\r\n              <div>\r\n                <label className=\"text-sm font-medium mb-1 block\">{t('rules.ruleName')}</label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={ruleForm.name}\r\n                  onChange={(e) => setRuleForm(f => ({ ...f, name: e.target.value }))}\r\n                  className=\"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20\"\r\n                  placeholder=\"e.g., Pause Low Performers\"\r\n                />\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-sm font-medium mb-1 block\">{t('rules.description')}</label>\r\n                <textarea\r\n                  value={ruleForm.description}\r\n                  onChange={(e) => setRuleForm(f => ({ ...f, description: e.target.value }))}\r\n                  className=\"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20\"\r\n                  rows={2}\r\n                  placeholder=\"Describe what this rule does...\"\r\n                />\r\n              </div>\r\n\r\n              <div className=\"p-4 rounded-lg bg-muted/50\">\r\n                <p className=\"text-sm font-medium mb-3\">{t('rules.condition')}</p>\r\n                <div className=\"flex gap-2\">\r\n                  <select\r\n                    value={ruleForm.conditionField}\r\n                    onChange={(e) => setRuleForm(f => ({ ...f, conditionField: e.target.value }))}\r\n                    className=\"flex-1 px-3 py-2 rounded-lg border bg-background\"\r\n                  >\r\n                    {fields.map((field) => (\r\n                      <option key={field} value={field}>\r\n                        {field.toUpperCase()}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  <select\r\n                    value={ruleForm.conditionOperator}\r\n                    onChange={(e) => setRuleForm(f => ({ ...f, conditionOperator: e.target.value }))}\r\n                    className=\"w-24 px-3 py-2 rounded-lg border bg-background\"\r\n                  >\r\n                    {operators.map((op) => (\r\n                      <option key={op.value} value={op.value}>\r\n                        {op.label}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={ruleForm.conditionValue}\r\n                    onChange={(e) => setRuleForm(f => ({ ...f, conditionValue: e.target.value }))}\r\n                    className=\"w-32 px-3 py-2 rounded-lg border bg-background\"\r\n                    placeholder=\"Value\"\r\n                  />\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"p-4 rounded-lg bg-muted/50\">\r\n                <p className=\"text-sm font-medium mb-3\">{t('rules.action')}</p>\r\n                <select\r\n                  value={ruleForm.actionType}\r\n                  onChange={(e) => setRuleForm(f => ({ ...f, actionType: e.target.value as RuleAction }))}\r\n                  className=\"w-full px-3 py-2 rounded-lg border bg-background\"\r\n                >\r\n                  <option value=\"apply_label\">Apply Label</option>\r\n                  <option value=\"send_alert\">Send Alert</option>\r\n                  <option value=\"pause_campaign\">Pause Campaign</option>\r\n                  <option value=\"adjust_budget\">Adjust Budget</option>\r\n                  <option value=\"notify_slack\">Notify Slack</option>\r\n                  <option value=\"notify_whatsapp\">Notify WhatsApp</option>\r\n                </select>\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"text-sm font-medium mb-1 block\">Cooldown (hours)</label>\r\n                <input\r\n                  type=\"number\"\r\n                  value={ruleForm.cooldownHours}\r\n                  onChange={(e) => setRuleForm(f => ({ ...f, cooldownHours: parseInt(e.target.value) || 1 }))}\r\n                  className=\"w-full px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20\"\r\n                  min={1}\r\n                  max={168}\r\n                />\r\n                <p className=\"text-xs text-muted-foreground mt-1\">Minimum time between rule triggers</p>\r\n              </div>\r\n            </div>\r\n\r\n            <div className=\"flex justify-end gap-3 mt-6\">\r\n              <button\r\n                onClick={() => { setShowCreateModal(false); resetForm(); }}\r\n                className=\"px-4 py-2 rounded-lg border hover:bg-muted transition-colors\"\r\n              >\r\n                {t('common.cancel')}\r\n              </button>\r\n              <button\r\n                onClick={handleSaveRule}\r\n                disabled={createRule.isPending || updateRule.isPending || !ruleForm.name.trim() || !ruleForm.conditionValue.trim()}\r\n                className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors disabled:opacity-50\"\r\n              >\r\n                {(createRule.isPending || updateRule.isPending) && <Loader2 className=\"w-4 h-4 animate-spin\" />}\r\n                {editingRule ? 'Update Rule' : t('rules.createRule')}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Delete Confirmation Modal */}\r\n      {showDeleteConfirm && (\r\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50\">\r\n          <div className=\"bg-background rounded-xl p-6 w-full max-w-md mx-4\">\r\n            <h2 className=\"text-lg font-bold mb-2\">Delete Rule</h2>\r\n            <p className=\"text-muted-foreground mb-4\">\r\n              Are you sure you want to delete &quot;{showDeleteConfirm.name}&quot;? This action cannot be undone.\r\n            </p>\r\n            <div className=\"flex justify-end gap-3\">\r\n              <button\r\n                onClick={() => setShowDeleteConfirm(null)}\r\n                className=\"px-4 py-2 rounded-lg border hover:bg-muted transition-colors\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={() => handleDeleteRule(showDeleteConfirm)}\r\n                disabled={deleteRule.isPending}\r\n                className=\"flex items-center gap-2 px-4 py-2 rounded-lg bg-red-600 text-white hover:bg-red-700 transition-colors disabled:opacity-50\"\r\n              >\r\n                {deleteRule.isPending && <Loader2 className=\"w-4 h-4 animate-spin\" />}\r\n                Delete\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Rules;\r\n"],"names":["rulesApi","filters","apiClient","id","data","limit","conditions","useRules","useQuery","useCreateRule","queryClient","useQueryClient","useMutation","useUpdateRule","_","variables","useDeleteRule","useToggleRule","mockRules","operators","fields","Rules","t","useTranslation","searchQuery","setSearchQuery","useState","statusFilter","setStatusFilter","showCreateModal","setShowCreateModal","toast","useToast","editingRule","setEditingRule","showDeleteConfirm","setShowDeleteConfirm","ruleForm","setRuleForm","rulesData","isLoading","toggleRule","createRule","updateRule","deleteRule","resetForm","useCallback","openCreateModal","openEditModal","rule","handleDuplicate","handleSaveRule","payload","handleDeleteRule","rules","useMemo","r","_a","_b","handleToggleRule","ruleId","_currentStatus","filteredRules","getStatusBadge","status","config","CheckCircle2","Pause","Edit","color","Icon","label","jsxs","cn","jsx","getActionIcon","action","Tag","Bell","DollarSign","Settings","MessageCircle","getActionLabel","getOperatorLabel","operator","op","formatLastTriggered","date","d","diffHours","Zap","Plus","acc","Search","e","Loader2","Play","Copy","Trash2","ChevronRight","Clock","X","f","field"],"mappings":"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"}