import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as F,L as c}from"./vendor-react-Dz7uKsMg.js";import{ag as b,ah as w,a9 as y,cS as _,cT as C,h as u,c as x,f as k,a6 as $}from"./index-BQex3859.js";import{u as E,a as R,b as P,c as A,d as D}from"./cdp-B6W0ktOz.js";import{F as T}from"./ArrowTrendingDownIcon-DA5nft8Y.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";function m({title:r,value:d,change:s,changeLabel:a,icon:t,href:i,loading:o,variant:h="info"}){const l=e.jsx("div",{className:x("metric-card p-6",h),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:r}),o?e.jsx("div",{className:"h-8 w-24 bg-muted animate-pulse rounded mt-2"}):e.jsx("p",{className:"text-2xl font-bold mt-2",children:d}),s!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[s>=0?e.jsx($,{className:"h-4 w-4 text-green-500"}):e.jsx(T,{className:"h-4 w-4 text-red-500"}),e.jsxs("span",{className:x("text-sm font-medium",s>=0?"text-green-500":"text-red-500"),children:[s>=0?"+":"",s.toFixed(1),"%"]}),a&&e.jsx("span",{className:"text-sm text-muted-foreground",children:a})]})]}),e.jsx("div",{className:"h-12 w-12 rounded-lg bg-primary/10 flex items-center justify-center",children:e.jsx(t,{className:"h-6 w-6 text-primary"})})]})});return i?e.jsx(c,{to:i,children:l}):l}function V({status:r}){const d={healthy:{color:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400",icon:k},degraded:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400",icon:u},unhealthy:{color:"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",icon:u}}[r]||{color:"bg-gray-100 text-gray-800",icon:k};return e.jsxs("span",{className:x("inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-medium",d.color),children:[e.jsx(d.icon,{className:"h-4 w-4"}),r.charAt(0).toUpperCase()+r.slice(1)]})}function B({data:r}){const d=[{key:"anonymous",label:"Anonymous",color:"bg-gray-400"},{key:"known",label:"Known",color:"bg-blue-400"},{key:"customer",label:"Customer",color:"bg-green-400"},{key:"churned",label:"Churned",color:"bg-red-400"}],s=Object.values(r).reduce((a,t)=>a+t,0);return e.jsx("div",{className:"space-y-3",children:d.map(a=>{const t=r[a.key]||0,i=s>0?t/s*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{className:"font-medium",children:a.label}),e.jsxs("span",{className:"text-muted-foreground",children:[t.toLocaleString()," (",i.toFixed(1),"%)"]})]}),e.jsx("div",{className:"h-2 bg-muted rounded-full overflow-hidden",children:e.jsx("div",{className:x("h-full rounded-full transition-all duration-500",a.color),style:{width:`${i}%`}})})]},a.key)})})}function H({data:r}){const d=Math.max(...r.map(s=>s.count),1);return e.jsx("div",{className:"flex items-end gap-1 h-32",children:r.slice(-14).map((s,a)=>e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-full bg-primary/80 rounded-t hover:bg-primary transition-colors",style:{height:`${s.count/d*100}%`,minHeight:"4px"},title:`${s.date}: ${s.count.toLocaleString()} events`}),a%2===0&&e.jsx("span",{className:"text-[10px] text-muted-foreground",children:new Date(s.date).getDate()})]},a))})}function J(){var g,p,f,j,v,N;const{data:r,isLoading:d}=E(),{data:s,isLoading:a}=R(),{data:t,isLoading:i}=P(30),{data:o,isLoading:h}=A(),{data:l}=D(),L=F.useMemo(()=>(o==null?void 0:o.segments.filter(n=>n.status==="active").length)||0,[o]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Customer Data Platform"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Unified customer profiles, segments, and behavioral data"})]}),e.jsx("div",{className:"flex items-center gap-3",children:r&&e.jsx(V,{status:r.status})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(m,{title:"Total Profiles",value:((g=s==null?void 0:s.total_profiles)==null?void 0:g.toLocaleString())||"0",change:s!=null&&s.new_profiles_7d?s.new_profiles_7d/(s.total_profiles||1)*100:void 0,changeLabel:"new this week",icon:b,href:"/dashboard/cdp/profiles",loading:a,variant:"success"}),e.jsx(m,{title:"Active Segments",value:L,icon:w,href:"/dashboard/cdp/segments",loading:h,variant:"premium"}),e.jsx(m,{title:"Events (30d)",value:((p=t==null?void 0:t.total_events)==null?void 0:p.toLocaleString())||"0",change:l==null?void 0:l.wow_change_pct,changeLabel:"vs last week",icon:y,href:"/dashboard/cdp/events",loading:i,variant:"active"}),e.jsx(m,{title:"Avg EMQ Score",value:((f=t==null?void 0:t.avg_emq_score)==null?void 0:f.toFixed(1))||"N/A",icon:_,href:"/dashboard/cdp/identity",loading:i,variant:"info"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"metric-card info p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Profile Lifecycle"}),a?e.jsx("div",{className:"space-y-4",children:[1,2,3,4].map(n=>e.jsx("div",{className:"h-6 bg-muted animate-pulse rounded"},n))}):s!=null&&s.lifecycle_distribution?e.jsx(B,{data:s.lifecycle_distribution}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"No data available"}),e.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Email Coverage"}),e.jsxs("p",{className:"font-semibold",children:[((j=s==null?void 0:s.email_coverage_pct)==null?void 0:j.toFixed(1))||0,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground",children:"Phone Coverage"}),e.jsxs("p",{className:"font-semibold",children:[((v=s==null?void 0:s.phone_coverage_pct)==null?void 0:v.toFixed(1))||0,"%"]})]})]})]}),e.jsxs("div",{className:"metric-card active p-6 lg:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Event Volume (Last 14 Days)"}),e.jsx(c,{to:"/dashboard/cdp/events",className:"text-sm text-primary hover:underline",children:"View all events"})]}),i?e.jsx("div",{className:"h-32 bg-muted animate-pulse rounded"}):t!=null&&t.daily_volume?e.jsx(H,{data:t.daily_volume}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"No event data available"}),(t==null?void 0:t.events_by_name)&&t.events_by_name.length>0&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("p",{className:"text-sm font-medium mb-2",children:"Top Events"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.events_by_name.slice(0,5).map(n=>e.jsxs("span",{className:"px-2 py-1 bg-muted rounded text-xs font-medium",children:[n.event_name,": ",n.count.toLocaleString()]},n.event_name))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs(c,{to:"/dashboard/cdp/profiles",className:"metric-card info p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-blue-500/10 flex items-center justify-center",children:e.jsx(b,{className:"h-5 w-5 text-blue-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"View Profiles"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Browse & manage customers"})]})]}),e.jsxs(c,{to:"/dashboard/cdp/segments",className:"metric-card premium p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-purple-500/10 flex items-center justify-center",children:e.jsx(w,{className:"h-5 w-5 text-purple-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Build Segments"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Create audience segments"})]})]}),e.jsxs(c,{to:"/dashboard/cdp/events",className:"metric-card success p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-green-500/10 flex items-center justify-center",children:e.jsx(y,{className:"h-5 w-5 text-green-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Event Timeline"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Track user behavior"})]})]}),e.jsxs(c,{to:"/dashboard/cdp/identity",className:"metric-card warning p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-orange-500/10 flex items-center justify-center",children:e.jsx(_,{className:"h-5 w-5 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Identity Graph"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Visualize connections"})]})]}),e.jsxs(c,{to:"/dashboard/cdp/audience-sync",className:"metric-card active p-4 flex items-center gap-4",children:[e.jsx("div",{className:"h-10 w-10 rounded-lg bg-pink-500/10 flex items-center justify-center",children:e.jsx(C,{className:"h-5 w-5 text-pink-500"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Audience Sync"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Push to ad platforms"})]})]})]}),l&&l.health_status!=="healthy"&&e.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-xl p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(u,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-yellow-800 dark:text-yellow-200",children:"Data Quality Alert"}),e.jsxs("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1",children:["Event volume has changed by ",(N=l.wow_change_pct)==null?void 0:N.toFixed(1),"% compared to last week. Current trend: ",l.volume_trend,"."]})]})]})})]})}export{J as default};
//# sourceMappingURL=CDPDashboard-BUtKRfg4.js.map
