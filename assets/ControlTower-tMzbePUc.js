import{j as e}from"./vendor-ui-B0DL0VNC.js";import{a8 as b,a6 as o,d3 as v,h as u,a5 as w,c as p,ac as k}from"./index-BQex3859.js";import{C as y}from"./ConfidenceBandBadge-BR4oR-ha.js";import{u as R}from"./vendor-react-Dz7uKsMg.js";import{u as S,a as A,b as q,c as I}from"./hooks-B2vGXtE6.js";import{u as T,a as $}from"./emqV2-BxKuXu1r.js";import{F as C}from"./Cog6ToothIcon-CPfpEQDd.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";import"./featureFlagsStore-DvEl_DiZ.js";function V(){var h;const c=R(),{data:a}=T(),{data:j}=$(),{data:t}=S(),{data:l}=A(),{data:r}=q(),{data:n}=I({minRisk:.3,limit:10}),d={mrr:(r==null?void 0:r.mrr)??(t==null?void 0:t.totalRevenue)??125e3,arr:(r==null?void 0:r.arr)??((t==null?void 0:t.totalRevenue)??125e3)*12,churnRisk:(n==null?void 0:n.length)??(t==null?void 0:t.atRiskTenants)??3,margin:68,totalBudgetAtRisk:(a==null?void 0:a.atRiskBudget)??(t==null?void 0:t.totalBudgetAtRisk)??45e3},m=((h=l==null?void 0:l.items)==null?void 0:h.map(s=>({id:s.id,name:s.name,emqScore:s.emqScore??85,status:(s.emqScore??85)>=90?"ok":(s.emqScore??85)>=60?"risk":(s.emqScore??85)>=40?"degraded":"critical",budgetAtRisk:s.budgetAtRisk??0,activeIncidents:s.activeIncidents??0,autopilotMode:"normal"})))??[{id:1,name:"Acme Corp",emqScore:94,status:"ok",budgetAtRisk:0,activeIncidents:0,autopilotMode:"normal"},{id:2,name:"TechStart Inc",emqScore:72,status:"risk",budgetAtRisk:8500,activeIncidents:1,autopilotMode:"limited"},{id:3,name:"GlobalBrand",emqScore:88,status:"ok",budgetAtRisk:2e3,activeIncidents:0,autopilotMode:"normal"},{id:4,name:"FastGrowth Co",emqScore:45,status:"critical",budgetAtRisk:25e3,activeIncidents:3,autopilotMode:"frozen"},{id:5,name:"RetailMax",emqScore:91,status:"ok",budgetAtRisk:0,activeIncidents:0,autopilotMode:"normal"}],g=j??[{platform:"Meta",p25:65,p50:78,p75:89,tenantScore:82,percentile:68},{platform:"Google",p25:72,p50:85,p75:94,tenantScore:88,percentile:72},{platform:"TikTok",p25:55,p50:70,p75:82,tenantScore:75,percentile:65}],f=(a==null?void 0:a.topIssues)??[{driver:"Freshness",affectedTenants:3},{driver:"Data Loss",affectedTenants:2},{driver:"Variance",affectedTenants:4}],N=m.reduce((s,i)=>(s[i.status]=(s[i.status]||0)+1,s),{}),x=s=>{switch(s){case"ok":return"text-success bg-success/10 border-success/20";case"risk":return"text-warning bg-warning/10 border-warning/20";case"degraded":return"text-orange-400 bg-orange-500/10 border-orange-500/20";case"critical":return"text-danger bg-danger/10 border-danger/20";default:return"text-text-muted bg-surface-tertiary border-white/10"}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Control Tower"}),e.jsx("p",{className:"text-text-muted",children:"Platform overview & tenant health"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("button",{onClick:()=>c("/dashboard/superadmin"),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors",children:[e.jsx(C,{className:"w-4 h-4"}),"System Settings"]})})]}),e.jsxs("div",{"data-tour":"portfolio-kpis",className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted mb-2",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"MRR"})]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:["$",(d.mrr/1e3).toFixed(0),"K"]}),e.jsxs("div",{className:"flex items-center gap-1 text-success text-sm mt-1",children:[e.jsx(o,{className:"w-4 h-4"}),"+12% vs last month"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted mb-2",children:[e.jsx(v,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Active Tenants"})]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:(a==null?void 0:a.totalTenants)??m.length}),e.jsxs("div",{className:"flex items-center gap-1 text-success text-sm mt-1",children:[e.jsx(o,{className:"w-4 h-4"}),"+3 this month"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted mb-2",children:[e.jsx(u,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Churn Risk"})]}),e.jsx("div",{className:"text-2xl font-bold text-warning",children:d.churnRisk}),e.jsx("div",{className:"text-sm text-text-muted mt-1",children:"tenants at risk"})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted mb-2",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Margin"})]}),e.jsxs("div",{className:"text-2xl font-bold text-success",children:[d.margin,"%"]}),e.jsxs("div",{className:"flex items-center gap-1 text-success text-sm mt-1",children:[e.jsx(o,{className:"w-4 h-4"}),"+2% vs target"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-danger/20",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted mb-2",children:[e.jsx(u,{className:"w-4 h-4 text-danger"}),e.jsx("span",{className:"text-sm",children:"Budget at Risk"})]}),e.jsxs("div",{className:"text-2xl font-bold text-danger",children:["$",(d.totalBudgetAtRisk/1e3).toFixed(0),"K"]}),e.jsx("div",{className:"text-sm text-text-muted mt-1",children:"across all tenants"})]})]}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:["ok","risk","degraded","critical"].map(s=>e.jsx("div",{className:p("p-4 rounded-xl border",x(s)),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm capitalize",children:s}),e.jsx("span",{className:"text-2xl font-bold",children:N[s]||0})]})},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2","data-tour":"tenant-health",children:e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-white/10",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Tenant Health"}),e.jsxs("button",{onClick:()=>c("/dashboard/tenants"),className:"text-sm text-stratum-400 hover:text-stratum-300 flex items-center gap-1",children:["View all",e.jsx(k,{className:"w-4 h-4"})]})]}),e.jsx("div",{className:"divide-y divide-white/5",children:m.map(s=>e.jsxs("div",{className:"p-4 hover:bg-white/5 cursor-pointer transition-colors",onClick:()=>c(`/app/${s.id}/overview`),children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-surface-tertiary flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:s.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-white",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx(y,{score:s.emqScore,size:"sm"}),e.jsx("span",{className:p("text-xs px-2 py-0.5 rounded capitalize",x(s.status)),children:s.status})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-lg font-bold text-white",children:s.emqScore}),e.jsx("div",{className:"text-xs text-text-muted",children:"EMQ"})]})]}),(s.budgetAtRisk>0||s.activeIncidents>0)&&e.jsxs("div",{className:"flex items-center gap-4 mt-3 pt-3 border-t border-white/5",children:[s.budgetAtRisk>0&&e.jsxs("span",{className:"text-sm text-danger",children:["$",s.budgetAtRisk.toLocaleString()," at risk"]}),s.activeIncidents>0&&e.jsxs("span",{className:"text-sm text-warning",children:[s.activeIncidents," active incident",s.activeIncidents>1?"s":""]})]})]},s.id))})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{"data-tour":"emq-benchmarks",className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/10",children:[e.jsx("h3",{className:"font-semibold text-white",children:"EMQ Benchmarks"}),e.jsx("p",{className:"text-sm text-text-muted",children:"P25 / P50 / P75 by platform"})]}),e.jsx("div",{className:"p-4 space-y-4",children:g.map(s=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-white",children:s.platform}),e.jsxs("span",{className:"text-sm text-text-muted",children:[s.p25," / ",s.p50," / ",s.p75]})]}),e.jsxs("div",{className:"relative h-2 bg-white/10 rounded-full",children:[e.jsx("div",{className:"absolute top-0 h-2 bg-danger/50 rounded-l-full",style:{width:`${s.p25}%`}}),e.jsx("div",{className:"absolute top-0 h-2 bg-warning/50",style:{left:`${s.p25}%`,width:`${s.p50-s.p25}%`}}),e.jsx("div",{className:"absolute top-0 h-2 bg-success/50 rounded-r-full",style:{left:`${s.p50}%`,width:`${s.p75-s.p50}%`}})]})]},s.platform))})]}),e.jsxs("div",{"data-tour":"top-issues",className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-white/10",children:[e.jsx("h3",{className:"font-semibold text-white",children:"Top Issues"}),e.jsx("p",{className:"text-sm text-text-muted",children:"Affecting most tenants"})]}),e.jsx("div",{className:"p-4 space-y-3",children:f.map((s,i)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-white",children:s.driver}),e.jsxs("span",{className:"text-sm text-danger",children:[s.affectedTenants," tenants"]})]},i))})]}),e.jsxs("div",{"data-tour":"autopilot-distribution",className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-white/10",children:e.jsx("h3",{className:"font-semibold text-white",children:"Autopilot Modes"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"flex items-center gap-2 mb-3",children:e.jsxs("div",{className:"flex-1 h-3 rounded-full overflow-hidden flex",children:[e.jsx("div",{className:"bg-success h-full",style:{width:"60%"}}),e.jsx("div",{className:"bg-warning h-full",style:{width:"20%"}}),e.jsx("div",{className:"bg-orange-500 h-full",style:{width:"10%"}}),e.jsx("div",{className:"bg-danger h-full",style:{width:"10%"}})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-success"}),e.jsx("span",{className:"text-text-muted",children:"Normal (60%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-warning"}),e.jsx("span",{className:"text-text-muted",children:"Limited (20%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-orange-500"}),e.jsx("span",{className:"text-text-muted",children:"Cuts Only (10%)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-danger"}),e.jsx("span",{className:"text-text-muted",children:"Frozen (10%)"})]})]})]})]})]})]})]})}export{V as default};
//# sourceMappingURL=ControlTower-tMzbePUc.js.map
