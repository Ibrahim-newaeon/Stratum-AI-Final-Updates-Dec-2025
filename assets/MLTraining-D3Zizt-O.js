import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as l}from"./vendor-react-Dz7uKsMg.js";import{t as c,c as o,x as R,a2 as w,z as P,aj as A,V as H,P as B,E as G,T as L,r as $}from"./index-BQex3859.js";import{C as V}from"./cpu-KpEi9kbn.js";import{C as J}from"./circle-alert-MlATZigW.js";import{U as Y}from"./upload-CPGtmIIL.js";import{F as Z}from"./file-spreadsheet-t9aDrZhs.js";import{R as v}from"./refresh-cw-DLOeozaH.js";import{C as I}from"./circle-check-big-CIbPdEH4.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";function ge(){const[m,C]=l.useState("upload"),[g,E]=l.useState([]),[h,z]=l.useState([]),[f,p]=l.useState(!1),[u,T]=l.useState(!1),[,N]=l.useState(0),[n,S]=l.useState(null),[F,d]=l.useState(null),y=l.useRef(null);l.useEffect(()=>{k(),b()},[]);const k=async()=>{try{const a=await c.get("/ml/models");E(a.data.models||[])}catch(a){console.error("Failed to fetch models:",a)}},b=async()=>{try{const a=await c.get("/ml/training-data");z(a.data.files||[])}catch(a){console.error("Failed to fetch training data:",a)}},K=async a=>{var t,i,_;const r=(t=a.target.files)==null?void 0:t[0];if(!r)return;if(!r.name.endsWith(".csv")){d("Please upload a CSV file");return}p(!0),d(null),N(0);const s=new FormData;s.append("file",r);try{const j=await c.post("/ml/upload?train_after_upload=false",s,{headers:{"Content-Type":"multipart/form-data"},onUploadProgress:x=>{if(x.total){const X=Math.round(x.loaded*100/x.total);N(X)}}});N(100),await b(),d(null),alert(`Successfully uploaded ${j.data.rows_processed||"N/A"} rows of training data`)}catch(j){const x=((_=(i=j.response)==null?void 0:i.data)==null?void 0:_.detail)||"Failed to upload file. Please try again.";d(x),console.error("Upload error:",j)}finally{p(!1),y.current&&(y.current.value="")}},O=async()=>{var a,r;p(!0),d(null);try{const s=await c.post("/ml/generate-sample",{num_campaigns:100,days_per_campaign:30});await b(),alert(`Generated ${s.data.rows} rows of sample training data`)}catch(s){const t=((r=(a=s.response)==null?void 0:a.data)==null?void 0:r.detail)||"Failed to generate sample data";d(t),console.error("Generate sample error:",s)}finally{p(!1)}},M=async(a=!1)=>{var r,s;T(!0),S(null),d(null);try{const t=a?"/ml/train?use_sample_data=true&num_campaigns=100&days=30":"/ml/train",i=await c.post(t);S(i.data),await k()}catch(t){const i=((s=(r=t.response)==null?void 0:r.data)==null?void 0:s.detail)||"Training failed. Please ensure you have uploaded training data.";d(i),console.error("Training error:",t)}finally{T(!1)}},W=async a=>{var r,s;if(confirm(`Are you sure you want to delete the ${a} model?`))try{await c.delete(`/ml/models/${a}`),await k()}catch(t){const i=((s=(r=t.response)==null?void 0:r.data)==null?void 0:s.detail)||"Failed to delete model";d(i),console.error("Delete error:",t)}},q=a=>a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`,U=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),D=a=>a.includes("roas")?e.jsx(G,{className:"w-5 h-5"}):a.includes("conversion")?e.jsx(L,{className:"w-5 h-5"}):a.includes("budget")?e.jsx($,{className:"w-5 h-5"}):e.jsx(w,{className:"w-5 h-5"}),Q=[{id:"upload",label:"Upload Data",icon:Y},{id:"models",label:"Models",icon:w},{id:"training",label:"Train",icon:V}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"ML Training"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-1",children:"Upload training data and manage ML models"})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:o("inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-sm font-medium",g.length>0?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400":"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400"),children:[e.jsx(V,{className:"w-4 h-4"}),g.length," Models Ready"]})})]}),F&&e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(J,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-red-700 dark:text-red-400",children:F}),e.jsx("button",{onClick:()=>d(null),className:"ml-auto text-red-500 hover:text-red-700",children:e.jsx(R,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"border-b border-gray-200 dark:border-gray-700",children:e.jsx("nav",{className:"flex gap-4",children:Q.map(a=>e.jsxs("button",{onClick:()=>C(a.id),className:o("flex items-center gap-2 px-4 py-3 border-b-2 font-medium transition-colors",m===a.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400"),children:[e.jsx(a.icon,{className:"w-5 h-5"}),a.label]},a.id))})}),m==="upload"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Upload Training Data"}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-8 text-center",children:[e.jsx("input",{type:"file",ref:y,onChange:K,accept:".csv",className:"hidden"}),e.jsx(Z,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-2",children:"Drag and drop your CSV file here, or"}),e.jsx("button",{onClick:()=>{var a;return(a=y.current)==null?void 0:a.click()},disabled:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:f?"Uploading...":"Browse Files"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-4",children:"Supported: CSV files from Kaggle (Facebook Ads, Google Ads) or generic format"})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Required CSV Columns:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:["spend","impressions","clicks","conversions","revenue","platform","date"].map(a=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm text-gray-600 dark:text-gray-400",children:a},a))})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Or Generate Sample Data"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Generate synthetic training data for testing the ML pipeline"}),e.jsxs("button",{onClick:O,disabled:f,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:[e.jsx(P,{className:"w-5 h-5"}),"Generate 100 Campaigns (30 days each)"]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Training Data Files"}),e.jsx("button",{onClick:b,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg",children:e.jsx(v,{className:"w-5 h-5 text-gray-500"})})]}),h.length===0?e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"No training data uploaded yet"}):e.jsx("div",{className:"space-y-2",children:h.map(a=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(A,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:a.name}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[q(a.size_bytes)," • ",U(a.modified_at)]})]})]}),e.jsx(I,{className:"w-5 h-5 text-green-500"})]},a.path))})]})]}),m==="models"&&e.jsx("div",{className:"space-y-6",children:g.length===0?e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-12 text-center",children:[e.jsx(w,{className:"w-16 h-16 mx-auto text-gray-300 dark:text-gray-600 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2",children:"No Models Trained"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Upload training data and train models to get started"}),e.jsx("button",{onClick:()=>C("training"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Go to Training"})]}):e.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map(a=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg text-blue-600 dark:text-blue-400",children:D(a.name)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white",children:a.name.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["v",a.version]})]})]}),e.jsx("button",{onClick:()=>W(a.name),className:"p-1.5 hover:bg-red-100 dark:hover:bg-red-900/30 rounded text-gray-400 hover:text-red-500",children:e.jsx(H,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[a.metrics.r2!==void 0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"R² Score"}),e.jsxs("span",{className:o("font-medium",a.metrics.r2>.7?"text-green-600":a.metrics.r2>.5?"text-yellow-600":"text-red-600"),children:[(a.metrics.r2*100).toFixed(1),"%"]})]}),a.metrics.mae!==void 0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"MAE"}),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a.metrics.mae.toFixed(3)})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Features:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.features.slice(0,4).map(r=>e.jsx("span",{className:"px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 rounded text-xs text-gray-600 dark:text-gray-400",children:r},r)),a.features.length>4&&e.jsxs("span",{className:"px-1.5 py-0.5 text-xs text-gray-500",children:["+",a.features.length-4," more"]})]})]}),e.jsxs("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-4",children:["Created: ",U(a.created_at)]})]},a.name))})}),m==="training"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Train Models"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(A,{className:"w-6 h-6 text-blue-500"}),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Train from Uploaded Data"})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Use your uploaded CSV training data to train models"}),e.jsx("button",{onClick:()=>M(!1),disabled:u||h.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:u?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5 animate-spin"}),"Training..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-5 h-5"}),"Start Training"]})}),h.length===0&&e.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-2",children:"Upload training data first"})]}),e.jsxs("div",{className:"p-4 border border-gray-200 dark:border-gray-600 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(P,{className:"w-6 h-6 text-purple-500"}),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Train from Sample Data"})]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Generate synthetic data and train models for testing"}),e.jsx("button",{onClick:()=>M(!0),disabled:u,className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50",children:u?e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"w-5 h-5 animate-spin"}),"Training..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"w-5 h-5"}),"Quick Train"]})})]})]})]}),n&&e.jsxs("div",{className:o("rounded-xl border p-6",n.success?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"),children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.success?e.jsx(I,{className:"w-6 h-6 text-green-500"}):e.jsx(R,{className:"w-6 h-6 text-red-500"}),e.jsx("h3",{className:o("font-semibold",n.success?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"),children:n.message})]}),n.success&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Training completed in ",n.training_time_seconds,"s"]}),e.jsx("div",{className:"space-y-3",children:n.models_trained.map(a=>{const r=n.metrics[a]||{};return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-800 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[D(a),e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:a})]}),e.jsxs("span",{className:o("text-sm font-medium",r.r2>.7?"text-green-600":r.r2>.5?"text-yellow-600":"text-red-600"),children:["R² = ",r.r2?(r.r2*100).toFixed(1):"N/A","%"]})]},a)})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl border border-gray-200 dark:border-gray-700 p-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Models That Will Be Trained"}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(G,{className:"w-5 h-5 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:"ROAS Predictor"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Predicts Return on Ad Spend from campaign features"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(L,{className:"w-5 h-5 text-green-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Conversion Predictor"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Predicts conversions based on spend and engagement"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx($,{className:"w-5 h-5 text-purple-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:"Budget Impact"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Predicts revenue changes from budget adjustments"})]})]})]})]})]})]})}export{ge as default};
//# sourceMappingURL=MLTraining-D3Zizt-O.js.map
