import{j as e}from"./vendor-ui-B0DL0VNC.js";import{f as _,r as A,L as H}from"./vendor-react-Dz7uKsMg.js";import{j as Z,g as z,ag as C,d4 as B,c as u,f as K,a9 as $,a7 as G,h as J,d5 as Q,F as W}from"./index-BQex3859.js";import{T as X,K as Y,E as ee}from"./KpiStrip-C0aZ-ZV9.js";import{E as te,a as se}from"./EmqTimeline-DxviryQA.js";import{b as re,c as ae,d as ie,e as ne,f as oe}from"./emqV2-BxKuXu1r.js";import{u as de,a as ce}from"./admin-C8dTloZG.js";import"./featureFlagsStore-DvEl_DiZ.js";import{F as le}from"./BuildingOfficeIcon-Cxa0zVTj.js";import{F as me}from"./CalendarIcon-LISB5gLp.js";import{F as xe}from"./Cog6ToothIcon-CPfpEQDd.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";import"./ConfidenceBandBadge-BR4oR-ha.js";import"./BudgetAtRiskChip-BRCQCK-f.js";import"./XCircleIcon-Dk49lKz_.js";import"./WrenchScrewdriverIcon-DJAaIhoQ.js";import"./UserCircleIcon-C5qf10f0.js";import"./ArrowTopRightOnSquareIcon-Cr7jBqzy.js";import"./ArrowTrendingDownIcon-DA5nft8Y.js";import"./BugAntIcon-BjOrFbnG.js";import"./ExclamationCircleIcon-C8aTdMTs.js";function pe({isOpen:f,title:i,message:r,confirmLabel:d,confirmVariant:c="primary",onConfirm:n,onCancel:o,isLoading:h=!1}){if(!f)return null;const w={danger:"bg-danger hover:bg-danger/80 text-white",warning:"bg-warning hover:bg-warning/80 text-black",primary:"bg-stratum-500 hover:bg-stratum-600 text-white"};return e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:o}),e.jsxs("div",{className:"relative bg-surface-primary border border-white/10 rounded-2xl p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsx("button",{onClick:o,className:"absolute top-4 right-4 text-text-muted hover:text-white transition-colors",children:e.jsx(W,{className:"w-5 h-5"})}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:i}),e.jsx("p",{className:"text-text-muted mb-6",children:r}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:o,disabled:h,className:"px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:n,disabled:h,className:u("px-4 py-2 rounded-lg transition-colors disabled:opacity-50",w[c]),children:h?"Processing...":d})]})]})]})}function Ee(){const{tenantId:f}=_(),i=parseInt(f||"1",10),{toast:r}=Z(),[d,c]=A.useState("overview"),[n,o]=A.useState({isOpen:!1,title:"",message:"",confirmLabel:"",confirmVariant:"primary",onConfirm:()=>{}}),[h,w]=A.useState({autopilot:!0,campaignBuilder:!0,competitorIntel:!1,predictions:!0}),k={start:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],end:new Date().toISOString().split("T")[0]},{data:l}=de(i),{data:m}=re(i),{data:x,refetch:F}=ae(i),{data:R}=ie(i),{data:y,refetch:I}=ne(i,k.start,k.end),N=oe(i),b=ce(),g=(m==null?void 0:m.score)??72,j=(x==null?void 0:x.mode)??"limited",O=(x==null?void 0:x.budgetAtRisk)??8500,s={id:f,name:(l==null?void 0:l.name)??"Fashion Forward",industry:"Retail",plan:(l==null?void 0:l.plan)??"Pro",accountManager:"Sarah Johnson",createdAt:new Date("2024-01-15"),platforms:["Meta","TikTok","Snapchat"],users:8,monthlySpend:12e4,mrr:499,status:"active",features:h,restrictions:[]},v=()=>{o(t=>({...t,isOpen:!1}))},M=(t,a)=>{const p=a?"disable":"enable";o({isOpen:!0,title:`${p.charAt(0).toUpperCase()+p.slice(1)} ${t.replace(/([A-Z])/g," $1").trim()}?`,message:`Are you sure you want to ${p} the ${t.replace(/([A-Z])/g," $1").trim().toLowerCase()} feature for this tenant?`,confirmLabel:p.charAt(0).toUpperCase()+p.slice(1),confirmVariant:a?"warning":"primary",onConfirm:()=>{w(q=>({...q,[t]:!a})),r({title:"Feature Updated",description:`${t.replace(/([A-Z])/g," $1").trim()} has been ${p}d for this tenant.`}),v()}})},L=t=>{t!==j&&o({isOpen:!0,title:"Override Autopilot Mode?",message:`Are you sure you want to change the autopilot mode from "${j.replace("_"," ")}" to "${t.replace("_"," ")}"? This will override the automated mode selection.`,confirmLabel:"Override Mode",confirmVariant:"warning",onConfirm:async()=>{try{await N.mutateAsync({mode:t,reason:"Admin manual override"}),r({title:"Mode Updated",description:`Autopilot mode has been changed to ${t.replace("_"," ")}.`}),F()}catch(a){r({title:"Error",description:a instanceof Error?a.message:"Failed to update autopilot mode",variant:"destructive"})}v()}})},P=()=>{o({isOpen:!0,title:"Suspend Tenant?",message:`Are you sure you want to suspend "${s.name}"? This will temporarily disable all access and automation for this tenant.`,confirmLabel:"Suspend Tenant",confirmVariant:"danger",onConfirm:async()=>{try{await b.mutateAsync({id:i,reason:"Admin manual suspension"}),r({title:"Tenant Suspended",description:`${s.name} has been suspended.`})}catch(t){r({title:"Error",description:t instanceof Error?t.message:"Failed to suspend tenant",variant:"destructive"})}v()}})},D=async()=>{try{await I(),r({title:"Refreshed",description:"Action log has been refreshed."})}catch{r({title:"Error",description:"Failed to refresh action log.",variant:"destructive"})}},E=[{id:"spend",label:"Monthly Spend",value:s.monthlySpend,format:"currency",previousValue:115e3,confidence:g},{id:"mrr",label:"MRR",value:s.mrr,format:"currency",previousValue:499,confidence:100},{id:"users",label:"Active Users",value:s.users,format:"number",previousValue:7,confidence:100},{id:"uptime",label:"Data Uptime",value:99.2,format:"percentage",previousValue:98.5,confidence:g}],U=R??[{id:"1",title:"Fix TikTok conversion variance",description:"TikTok reporting 22% lower conversions than GA4",priority:"critical",owner:"Data Team",estimatedImpact:12,estimatedTime:"2 hours",platform:"TikTok",status:"in_progress",actionUrl:null},{id:"2",title:"Resolve Snapchat API timeout",description:"Intermittent 504 errors causing data freshness issues",priority:"high",owner:null,estimatedImpact:8,estimatedTime:"1 hour",platform:"Snapchat",status:"pending",actionUrl:null}],S=(y==null?void 0:y.map(t=>({id:t.id,type:t.type,title:t.title,description:t.description??void 0,timestamp:new Date(t.timestamp),platform:t.platform??void 0,severity:t.severity,recoveryHours:t.recoveryHours??void 0,emqImpact:t.emqImpact??void 0})))??[{id:"1",type:"incident_opened",title:"TikTok conversion tracking degraded",description:"Significant variance detected",timestamp:new Date(Date.now()-4*60*60*1e3),platform:"TikTok",severity:"high"},{id:"2",type:"mode_change",title:"Autopilot mode changed to Limited",description:"Due to signal degradation",timestamp:new Date(Date.now()-5*60*60*1e3),severity:"medium"},{id:"3",type:"recovery",title:"Meta pixel issue resolved",description:"Data loss recovered",timestamp:new Date(Date.now()-24*60*60*1e3),platform:"Meta",severity:"low",recoveryHours:6,emqImpact:8}],T=t=>{switch(t){case"support":r({title:"Contact Support",description:"Opening support ticket system..."});break;case"override":c("settings"),r({title:"Mode Override",description:"Navigate to Admin Controls to override autopilot mode."});break;case"restrict":r({title:"Apply Restriction",description:"Navigate to Admin Controls to manage restrictions."}),c("settings");break}},V=[{id:"overview",label:"Overview"},{id:"incidents",label:"Incidents"},{id:"actions",label:"Action Log"},{id:"settings",label:"Admin Controls"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(H,{to:"/dashboard/superadmin/tenants",className:"p-2 rounded-lg bg-surface-secondary border border-white/10 text-text-muted hover:text-white transition-colors",children:e.jsx(z,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:s.name}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-stratum-500/10 text-stratum-400",children:s.plan}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-success/10 text-success",children:s.status})]}),e.jsx("p",{className:"text-text-muted",children:s.industry})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>T("support"),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors",children:[e.jsx(C,{className:"w-4 h-4"}),"Contact Support"]}),e.jsxs("button",{onClick:()=>T("override"),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-warning/10 border border-warning/20 text-warning hover:bg-warning/20 transition-colors",children:[e.jsx(B,{className:"w-4 h-4"}),"Override Mode"]})]})]}),e.jsx(X,{emqScore:g,autopilotMode:j,budgetAtRisk:O,svi:32,onViewDetails:()=>c("incidents")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(le,{className:"w-5 h-5 text-text-muted"}),e.jsx("span",{className:"text-text-muted",children:"Platforms"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:s.platforms.map(t=>e.jsx("span",{className:"px-2 py-1 rounded bg-surface-tertiary text-white text-sm",children:t},t))})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(C,{className:"w-5 h-5 text-text-muted"}),e.jsx("span",{className:"text-text-muted",children:"Account Manager"})]}),e.jsx("span",{className:"text-white font-medium",children:s.accountManager})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(me,{className:"w-5 h-5 text-text-muted"}),e.jsx("span",{className:"text-text-muted",children:"Customer Since"})]}),e.jsx("span",{className:"text-white font-medium",children:s.createdAt.toLocaleDateString("en-US",{month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(xe,{className:"w-5 h-5 text-text-muted"}),e.jsx("span",{className:"text-text-muted",children:"Features"})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Object.entries(s.features).filter(([,t])=>t).map(([t])=>e.jsx("span",{className:"px-2 py-1 rounded bg-stratum-500/10 text-stratum-400 text-xs",children:t},t))})]})]}),e.jsx(Y,{kpis:E,emqScore:g}),e.jsx("div",{className:"flex items-center gap-2 border-b border-white/10 pb-4",children:V.map(t=>e.jsx("button",{onClick:()=>c(t.id),className:u("px-4 py-2 rounded-lg transition-colors",d===t.id?"bg-stratum-500/10 text-stratum-400":"text-text-muted hover:text-white hover:bg-white/5"),children:t.label},t.id))}),d==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsx(te,{score:g,previousScore:(m==null?void 0:m.previousScore)??78,showDrivers:!0}),e.jsx(ee,{items:U,onItemClick:t=>{r({title:t.title,description:`${t.description} â€” Priority: ${t.priority}, Owner: ${t.owner||"Unassigned"}`})},onAssign:t=>{r({title:"Assignment requested",description:`"${t.title}" has been flagged for assignment to ${t.owner||"the team"}.`})},maxItems:5})]}),e.jsx("div",{children:e.jsx(se,{events:S,maxEvents:8})})]}),d==="incidents"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Incident History"}),e.jsxs("select",{className:"px-3 py-2 rounded-lg bg-surface-secondary border border-white/10 text-white focus:outline-none focus:ring-2 focus:ring-stratum-500",children:[e.jsx("option",{value:"30",children:"Last 30 days"}),e.jsx("option",{value:"60",children:"Last 60 days"}),e.jsx("option",{value:"90",children:"Last 90 days"})]})]}),e.jsx("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Incident"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Platform"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Severity"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Duration"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"EMQ Impact"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:S.map(t=>e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("div",{className:"font-medium text-white",children:t.title}),e.jsx("div",{className:"text-sm text-text-muted",children:t.description})]}),e.jsx("td",{className:"p-4 text-text-muted",children:t.platform||"-"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:u("px-2 py-1 rounded-full text-xs font-medium",t.severity==="critical"&&"bg-danger/10 text-danger",t.severity==="high"&&"bg-orange-500/10 text-orange-400",t.severity==="medium"&&"bg-warning/10 text-warning",t.severity==="low"&&"bg-success/10 text-success"),children:t.severity})}),e.jsx("td",{className:"p-4 text-text-muted",children:t.recoveryHours?`${t.recoveryHours}h`:"Ongoing"}),e.jsx("td",{className:"p-4",children:t.emqImpact?e.jsxs("span",{className:"text-danger",children:["-",t.emqImpact," pts"]}):e.jsx("span",{className:"text-text-muted",children:"-"})}),e.jsx("td",{className:"p-4",children:t.type==="recovery"?e.jsxs("span",{className:"flex items-center gap-1 text-success",children:[e.jsx(K,{className:"w-4 h-4"}),"Resolved"]}):e.jsxs("span",{className:"flex items-center gap-1 text-warning",children:[e.jsx($,{className:"w-4 h-4"}),"Open"]})})]},t.id))})]})})]}),d==="actions"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Action Log"}),e.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Refresh"]})]}),e.jsx("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 p-6",children:e.jsxs("div",{className:"text-center text-text-muted py-8",children:[e.jsx($,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Action log will display automated and manual actions taken."}),e.jsx("p",{className:"text-sm mt-2",children:"Coming soon"})]})})]}),d==="settings"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Admin Controls"}),e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 p-6",children:[e.jsx("h3",{className:"font-medium text-white mb-4",children:"Feature Access"}),e.jsx("div",{className:"space-y-4",children:Object.entries(s.features).map(([t,a])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white capitalize",children:t.replace(/([A-Z])/g," $1")}),e.jsxs("p",{className:"text-sm text-text-muted",children:[t==="autopilot"&&"Automated budget and bid adjustments",t==="campaignBuilder"&&"Create and publish campaigns",t==="competitorIntel"&&"Competitor tracking and analysis",t==="predictions"&&"AI-powered performance predictions"]})]}),e.jsx("button",{onClick:()=>M(t,a),className:u("relative w-12 h-6 rounded-full transition-colors",a?"bg-stratum-500":"bg-surface-tertiary"),children:e.jsx("span",{className:u("absolute top-1 w-4 h-4 rounded-full bg-white transition-transform",a?"left-7":"left-1")})})]},t))})]}),e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 p-6",children:[e.jsx("h3",{className:"font-medium text-white mb-4",children:"Autopilot Mode Override"}),e.jsx("p",{className:"text-sm text-text-muted mb-4",children:"Override the automated mode selection for this tenant. Use with caution."}),e.jsx("div",{className:"flex flex-wrap gap-3",children:["normal","limited","cuts_only","frozen"].map(t=>e.jsx("button",{onClick:()=>L(t),disabled:N.isPending,className:u("px-4 py-2 rounded-lg border transition-colors disabled:opacity-50",j===t?"bg-stratum-500/10 border-stratum-500 text-stratum-400":"bg-surface-tertiary border-white/10 text-text-muted hover:text-white"),children:t.replace("_"," ")},t))})]}),e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 p-6",children:[e.jsx("h3",{className:"font-medium text-white mb-4",children:"Active Restrictions"}),s.restrictions.length>0?e.jsx("div",{className:"space-y-2",children:s.restrictions.map((t,a)=>e.jsxs("div",{className:"flex items-center gap-2 text-warning",children:[e.jsx(J,{className:"w-4 h-4"}),t]},a))}):e.jsxs("div",{className:"flex items-center gap-2 text-success",children:[e.jsx(Q,{className:"w-5 h-5"}),e.jsx("span",{children:"No restrictions applied"})]})]}),e.jsxs("div",{className:"rounded-2xl bg-danger/5 border border-danger/20 p-6",children:[e.jsx("h3",{className:"font-medium text-danger mb-4",children:"Danger Zone"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-white",children:"Suspend Tenant"}),e.jsx("p",{className:"text-sm text-text-muted",children:"Temporarily disable all access and automation"})]}),e.jsx("button",{onClick:P,disabled:b.isPending,className:"px-4 py-2 rounded-lg bg-danger/10 border border-danger/20 text-danger hover:bg-danger/20 transition-colors disabled:opacity-50",children:b.isPending?"Suspending...":"Suspend"})]})]})]}),e.jsx(pe,{isOpen:n.isOpen,title:n.title,message:n.message,confirmLabel:n.confirmLabel,confirmVariant:n.confirmVariant,onConfirm:n.onConfirm,onCancel:v,isLoading:N.isPending||b.isPending})]})}export{Ee as default};
//# sourceMappingURL=TenantProfile-dL6xdXsl.js.map
