import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as o}from"./vendor-react-Dz7uKsMg.js";import{j as X,a9 as Y,c as i,a7 as g,d2 as Z,d7 as _,d8 as q,d0 as ee,h as f,a5 as se,f as L}from"./index-BQex3859.js";import{i as te}from"./hooks-B2vGXtE6.js";import{F as T}from"./ServerIcon-DWm3Ovkz.js";import{F as M}from"./CloudIcon-CGtkcdwB.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";import"./featureFlagsStore-DvEl_DiZ.js";function ue(){var D,$,F;const{toast:w}=X(),[j,v]=o.useState(!1),[Q,S]=o.useState(new Date),[A,R]=o.useState({}),[y,P]=o.useState({}),[t,m]=o.useState(null),{data:n,refetch:p}=te();o.useEffect(()=>{const s=setInterval(()=>{S(new Date),p()},3e4);return()=>clearInterval(s)},[p]);const E=async()=>{v(!0);try{await p(),S(new Date)}finally{v(!1)}},I=(s,a,c)=>{m({open:!0,type:c==="running"?"pause":"resume",queueId:s,queueName:a})},J=(s,a)=>{m({open:!0,type:"retry",queueId:s,queueName:a})},G=async()=>{if(!t)return;const{type:s,queueId:a,queueName:c}=t,u=`${s}-${a}`;P(r=>({...r,[u]:!0})),m(null);try{await new Promise(r=>setTimeout(r,1e3)),s==="pause"?(R(r=>({...r,[a]:"paused"})),w({title:"Queue paused",description:`"${c}" has been paused.`})):s==="resume"?(R(r=>({...r,[a]:"running"})),w({title:"Queue resumed",description:`"${c}" is now running.`})):s==="retry"&&(w({title:"Retrying failed jobs",description:`Retrying failed jobs in "${c}".`}),await p())}catch(r){console.error(`Failed to ${s} queue "${c}":`,r)}finally{P(r=>({...r,[u]:!1}))}},H=s=>A[s.id]??s.status,U=[{id:"api",name:"API Gateway",status:"healthy",uptime:99.99,latency:45,lastCheck:new Date,version:"2.4.1"},{id:"auth",name:"Auth Service",status:"healthy",uptime:99.95,latency:32,lastCheck:new Date,version:"1.8.0"},{id:"sync",name:"Sync Engine",status:"degraded",uptime:98.5,latency:1250,lastCheck:new Date,version:"3.1.2"},{id:"ml",name:"ML Pipeline",status:"healthy",uptime:99.8,latency:890,lastCheck:new Date,version:"2.0.0"},{id:"db",name:"Database Cluster",status:"healthy",uptime:99.99,latency:12,lastCheck:new Date,version:"PostgreSQL 15"},{id:"cache",name:"Cache Layer",status:"healthy",uptime:99.99,latency:2,lastCheck:new Date,version:"Redis 7.0"}],z=[{id:"sync",name:"Platform Sync",status:"running",pending:45,processing:12,completed:15420,failed:3,avgProcessTime:2.5},{id:"notifications",name:"Notifications",status:"running",pending:8,processing:2,completed:8932,failed:0,avgProcessTime:.3},{id:"reports",name:"Report Generation",status:"running",pending:15,processing:3,completed:1245,failed:2,avgProcessTime:45},{id:"ml-inference",name:"ML Inference",status:"running",pending:120,processing:8,completed:45678,failed:12,avgProcessTime:1.2}],B=[{platform:"Meta",status:"healthy",lastSync:new Date(Date.now()-5*60*1e3),syncDuration:45,errors:0,recordsProcessed:125e3},{platform:"Google",status:"healthy",lastSync:new Date(Date.now()-3*60*1e3),syncDuration:32,errors:0,recordsProcessed:89e3},{platform:"TikTok",status:"degraded",lastSync:new Date(Date.now()-15*60*1e3),syncDuration:180,errors:5,recordsProcessed:45e3},{platform:"Snapchat",status:"down",lastSync:new Date(Date.now()-2*60*60*1e3),syncDuration:0,errors:15,recordsProcessed:0}],K={cpu:42,memory:68,disk:35,network:125,activeConnections:1250,requestsPerMinute:4520,errorRate:.02},x=((D=n==null?void 0:n.services)==null?void 0:D.map(s=>({id:s.name.toLowerCase().replace(/\s+/g,"-"),name:s.name,status:s.status,uptime:s.uptime,latency:s.latency,lastCheck:new Date,version:s.version})))??U,O=(($=n==null?void 0:n.queues)==null?void 0:$.map(s=>({id:s.name.toLowerCase().replace(/\s+/g,"-"),name:s.name,status:s.status,pending:s.pending,processing:s.processing,completed:s.completed,failed:s.failed,avgProcessTime:s.avgProcessTime})))??z,h=((F=n==null?void 0:n.connectors)==null?void 0:F.map(s=>({platform:s.platform,status:s.status,lastSync:new Date(s.lastSync),syncDuration:0,errors:s.errors,recordsProcessed:s.recordsProcessed})))??B,d=(n==null?void 0:n.metrics)??K,C=s=>{switch(s){case"healthy":case"running":return"text-success";case"degraded":case"paused":return"text-warning";case"down":case"stalled":return"text-danger"}},V=s=>{switch(s){case"healthy":case"running":return"bg-success/10";case"degraded":case"paused":return"bg-warning/10";case"down":case"stalled":return"bg-danger/10"}},N=s=>{switch(s){case"healthy":return e.jsx(L,{className:"w-5 h-5 text-success"});case"degraded":return e.jsx(f,{className:"w-5 h-5 text-warning"});case"down":return e.jsx(f,{className:"w-5 h-5 text-danger"})}},W=s=>s<60?`${s}s`:s<3600?`${Math.floor(s/60)}m`:`${Math.floor(s/3600)}h`,k=s=>{const a=Math.floor((Date.now()-s.getTime())/6e4);return a<1?"Just now":a<60?`${a}m ago`:`${Math.floor(a/60)}h ago`},l=x.some(s=>s.status==="down")||h.some(s=>s.status==="down")?"down":x.some(s=>s.status==="degraded")||h.some(s=>s.status==="degraded")?"degraded":"healthy";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"System Health"}),e.jsx("p",{className:"text-text-muted",children:"Pipeline and infrastructure monitoring"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm",children:[e.jsx(Y,{className:"w-4 h-4"}),"Last updated: ",k(Q)]}),e.jsxs("button",{onClick:E,disabled:j,className:i("flex items-center gap-2 px-4 py-2 rounded-lg bg-surface-secondary border border-white/10 text-text-secondary hover:text-white transition-colors",j&&"opacity-50 cursor-not-allowed"),children:[e.jsx(g,{className:i("w-4 h-4",j&&"animate-spin")}),"Refresh"]})]})]}),e.jsxs("div",{className:i("flex items-center gap-4 p-4 rounded-xl border",l==="healthy"&&"bg-success/5 border-success/20",l==="degraded"&&"bg-warning/5 border-warning/20",l==="down"&&"bg-danger/5 border-danger/20"),children:[N(l),e.jsxs("div",{children:[e.jsxs("span",{className:i("font-semibold",C(l)),children:[l==="healthy"&&"All Systems Operational",l==="degraded"&&"Some Systems Degraded",l==="down"&&"System Issues Detected"]}),e.jsxs("p",{className:"text-sm text-text-muted",children:[x.filter(s=>s.status==="healthy").length,"/",x.length," services healthy, ",h.filter(s=>s.status==="healthy").length,"/",h.length," ","connectors online"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:[e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(Z,{className:"w-4 h-4"}),"CPU"]}),e.jsxs("div",{className:i("text-2xl font-bold",d.cpu>80?"text-danger":"text-white"),children:[d.cpu,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Memory"]}),e.jsxs("div",{className:i("text-2xl font-bold",d.memory>85?"text-warning":"text-white"),children:[d.memory,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(T,{className:"w-4 h-4"}),"Disk"]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[d.disk,"%"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(M,{className:"w-4 h-4"}),"Network"]}),e.jsxs("div",{className:"text-2xl font-bold text-white",children:[d.network," Mbps"]})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(q,{className:"w-4 h-4"}),"Connections"]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:d.activeConnections.toLocaleString()})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(ee,{className:"w-4 h-4"}),"Requests/min"]}),e.jsx("div",{className:"text-2xl font-bold text-white",children:d.requestsPerMinute.toLocaleString()})]}),e.jsxs("div",{className:"p-4 rounded-xl bg-surface-secondary border border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 text-text-muted text-sm mb-2",children:[e.jsx(f,{className:"w-4 h-4"}),"Error Rate"]}),e.jsxs("div",{className:i("text-2xl font-bold",d.errorRate>1?"text-danger":"text-success"),children:[d.errorRate,"%"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-white/10",children:[e.jsx(T,{className:"w-5 h-5 text-stratum-400"}),e.jsx("h2",{className:"font-semibold text-white",children:"Core Services"})]}),e.jsx("div",{className:"divide-y divide-white/5",children:x.map(s=>e.jsx("div",{className:"p-4 hover:bg-white/5 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.name}),e.jsxs("div",{className:"text-xs text-text-muted",children:["v",s.version]})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-text-muted",children:"Uptime"}),e.jsxs("div",{className:"text-white",children:[s.uptime,"%"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-text-muted",children:"Latency"}),e.jsxs("div",{className:i(s.latency>1e3?"text-warning":"text-white"),children:[s.latency,"ms"]})]})]})]})},s.id))})]}),e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-white/10",children:[e.jsx(M,{className:"w-5 h-5 text-stratum-400"}),e.jsx("h2",{className:"font-semibold text-white",children:"Platform Connectors"})]}),e.jsx("div",{className:"divide-y divide-white/5",children:h.map(s=>e.jsx("div",{className:"p-4 hover:bg-white/5 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[N(s.status),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-white",children:s.platform}),e.jsxs("div",{className:"text-xs text-text-muted",children:["Last sync: ",k(s.lastSync)]})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-text-muted",children:"Records"}),e.jsx("div",{className:"text-white",children:s.recordsProcessed.toLocaleString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-text-muted",children:"Errors"}),e.jsx("div",{className:i(s.errors>0?"text-danger":"text-success"),children:s.errors})]})]})]})},s.platform))})]})]}),e.jsxs("div",{className:"rounded-2xl bg-surface-secondary border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 border-b border-white/10",children:[e.jsx(se,{className:"w-5 h-5 text-stratum-400"}),e.jsx("h2",{className:"font-semibold text-white",children:"Job Queues"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10",children:[e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Queue"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Status"}),e.jsx("th",{className:"text-right p-4 text-text-muted font-medium",children:"Pending"}),e.jsx("th",{className:"text-right p-4 text-text-muted font-medium",children:"Processing"}),e.jsx("th",{className:"text-right p-4 text-text-muted font-medium",children:"Completed"}),e.jsx("th",{className:"text-right p-4 text-text-muted font-medium",children:"Failed"}),e.jsx("th",{className:"text-right p-4 text-text-muted font-medium",children:"Avg Time"}),e.jsx("th",{className:"text-left p-4 text-text-muted font-medium",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/5",children:O.map(s=>{const a=H(s),c=y[`pause-${s.id}`],u=y[`resume-${s.id}`],r=y[`retry-${s.id}`],b=c||u;return e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"p-4 font-medium text-white",children:s.name}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:i("px-2 py-1 rounded-full text-xs font-medium",C(a),V(a)),children:a})}),e.jsx("td",{className:"p-4 text-right text-white",children:s.pending}),e.jsx("td",{className:"p-4 text-right text-stratum-400",children:s.processing}),e.jsx("td",{className:"p-4 text-right text-success",children:s.completed.toLocaleString()}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("span",{className:s.failed>0?"text-danger":"text-text-muted",children:s.failed})}),e.jsx("td",{className:"p-4 text-right text-text-muted",children:W(s.avgProcessTime)}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>I(s.id,s.name,a),disabled:b,className:i("text-text-muted hover:text-white text-sm transition-colors",b&&"opacity-50 cursor-not-allowed"),children:b?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3 animate-spin"}),c?"Pausing...":"Resuming..."]}):a==="running"?"Pause":"Resume"}),s.failed>0&&e.jsx("button",{onClick:()=>J(s.id,s.name),disabled:r,className:i("text-warning hover:text-white text-sm transition-colors",r&&"opacity-50 cursor-not-allowed"),children:r?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3 animate-spin"}),"Retrying..."]}):"Retry Failed"})]})})]},s.id)})})]})})]}),t&&e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>m(null)}),e.jsxs("div",{className:"relative bg-surface-secondary border border-white/10 rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.type==="retry"?e.jsx(g,{className:"w-6 h-6 text-warning"}):t.type==="pause"?e.jsx(f,{className:"w-6 h-6 text-warning"}):e.jsx(L,{className:"w-6 h-6 text-success"}),e.jsxs("h3",{className:"text-lg font-semibold text-white",children:[t.type==="pause"&&"Pause Queue",t.type==="resume"&&"Resume Queue",t.type==="retry"&&"Retry Failed Jobs"]})]}),e.jsxs("p",{className:"text-text-secondary mb-6",children:[t.type==="pause"&&e.jsxs(e.Fragment,{children:["Are you sure you want to pause the"," ",e.jsx("span",{className:"font-medium text-white",children:t.queueName})," queue? This will stop processing new jobs until resumed."]}),t.type==="resume"&&e.jsxs(e.Fragment,{children:["Are you sure you want to resume the"," ",e.jsx("span",{className:"font-medium text-white",children:t.queueName})," queue? Job processing will continue immediately."]}),t.type==="retry"&&e.jsxs(e.Fragment,{children:["Are you sure you want to retry all failed jobs in the"," ",e.jsx("span",{className:"font-medium text-white",children:t.queueName})," queue? This will re-queue all failed jobs for processing."]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:()=>m(null),className:"px-4 py-2 rounded-lg text-text-secondary hover:text-white transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:G,className:i("px-4 py-2 rounded-lg font-medium transition-colors",t.type==="pause"&&"bg-warning/20 text-warning hover:bg-warning/30",t.type==="resume"&&"bg-success/20 text-success hover:bg-success/30",t.type==="retry"&&"bg-stratum-500/20 text-stratum-400 hover:bg-stratum-500/30"),children:[t.type==="pause"&&"Pause Queue",t.type==="resume"&&"Resume Queue",t.type==="retry"&&"Retry Jobs"]})]})]})]})]})}export{ue as default};
//# sourceMappingURL=System-DWs3nwEG.js.map
