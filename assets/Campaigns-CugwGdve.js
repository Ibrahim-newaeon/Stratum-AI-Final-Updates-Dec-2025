import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as m}from"./vendor-react-Dz7uKsMg.js";import{i as H,Q as K,u as X,X as Z,c as o,C as q,G as ee,U as Q,s as te,j as se,Y as ae,$ as re,P as ne,V as ie,M as U,J as le,K as oe,E as ce,a0 as de,a1 as me,H as ue,N as ge}from"./index-BQex3859.js";import{u as xe}from"./campaignBuilder-B-MzQ-hf.js";import{C as W}from"./circle-alert-MlATZigW.js";import{R as pe}from"./refresh-cw-DLOeozaH.js";import{D as he}from"./dollar-sign-Dosx4kzY.js";import{C as be}from"./chevron-left-BQKXUEYA.js";import{L as M}from"./loader-circle-CJwg01sb.js";import{u as fe,a as je,b as Ne,c as ve}from"./campaigns-Cg-hLZGc.js";import"./featureFlagsStore-DvEl_DiZ.js";import{P as ye}from"./plus-B9u7Tds1.js";import{F as _e}from"./funnel-BvijHT_k.js";import{P as ke}from"./pause-CGHTPI-4.js";import{T as we}from"./trending-down-75FD7zon.js";import{S as Ce}from"./square-pen-6DBNh-jk.js";import{E as Se}from"./ellipsis-9Q2qFKdX.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M17 3a2 2 0 0 1 2 2v15a1 1 0 0 1-1.496.868l-4.512-2.578a2 2 0 0 0-1.984 0l-4.512 2.578A1 1 0 0 1 5 20V5a2 2 0 0 1 2-2z",key:"oz39mx"}]],Ee=H("bookmark",Ae);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pe=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Re=H("user-plus",Pe);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Te=H("users-round",Ie),z=[{id:"meta",name:"Meta",description:"Facebook & Instagram Ads",color:"bg-blue-600",objectives:["AWARENESS","TRAFFIC","ENGAGEMENT","LEADS","APP_PROMOTION","SALES"]},{id:"google",name:"Google",description:"Search, Display & YouTube",color:"bg-red-500",objectives:["SEARCH","DISPLAY","VIDEO","SHOPPING","PERFORMANCE_MAX","DISCOVERY"]},{id:"tiktok",name:"TikTok",description:"TikTok For Business",color:"bg-black",objectives:["REACH","TRAFFIC","VIDEO_VIEWS","COMMUNITY_INTERACTION","CONVERSIONS","APP_PROMOTION"]},{id:"snapchat",name:"Snapchat",description:"Snapchat Ads Manager",color:"bg-yellow-400",objectives:["AWARENESS","CONSIDERATION","CONVERSIONS","CATALOG_SALES"]}],P=["platform","basics","budget","targeting"],J={platform:"",name:"",objective:"",external_id:"",account_id:"",status:"draft",daily_budget:"",lifetime_budget:"",currency:"USD",start_date:"",end_date:"",targeting_age_min:"18",targeting_age_max:"65",targeting_genders:[],targeting_locations:"",targeting_interests:"",custom_audiences:[],lookalike_audiences:[],saved_audiences:[]};function De({open:i,onClose:B,onSuccess:w}){const{t:r}=K(),{user:C}=X(),[k,S]=m.useState("platform"),[a,p]=m.useState(J),[l,A]=m.useState({}),[T,h]=m.useState(!1),[j,R]=m.useState(null),[N,f]=m.useState("custom"),[v,I]=m.useState(null),D=(C==null?void 0:C.tenant_id)||0,u=P.indexOf(k),y=z.find(t=>t.id===a.platform),{data:g=[],isLoading:_,refetch:Y}=xe(D,a.platform,!0);m.useEffect(()=>{g.length>0&&!a.account_id&&p(t=>({...t,account_id:g[0].platform_account_id,currency:g[0].currency}))},[g,a.account_id]),m.useEffect(()=>{a.platform&&(p(t=>({...t,account_id:"",currency:"USD"})),I(null))},[a.platform]);const d=(t,n)=>{p(c=>({...c,[t]:n})),l[t]&&A(c=>({...c,[t]:void 0}))},$=t=>{const n=g.find(c=>c.platform_account_id===t);n&&p(c=>({...c,account_id:t,currency:n.currency}))},F=(t,n)=>{p(c=>{const b=c[t];return b.includes(n)?{...c,[t]:b.filter(O=>O!==n)}:{...c,[t]:[...b,n]}})},L=t=>{const n={};switch(t){case"platform":a.platform||(n.platform=r("campaigns.create.errors.platformRequired"));break;case"basics":a.name.trim()||(n.name=r("campaigns.create.errors.nameRequired")),a.objective||(n.objective=r("campaigns.create.errors.objectiveRequired")),a.account_id||(n.account_id=r("campaigns.create.errors.accountRequired"));break;case"budget":!a.daily_budget&&!a.lifetime_budget&&(n.daily_budget=r("campaigns.create.errors.budgetRequired")),a.start_date&&a.end_date&&a.end_date<a.start_date&&(n.end_date=r("campaigns.create.errors.endDateInvalid"));break;case"targeting":const c=parseInt(a.targeting_age_min),b=parseInt(a.targeting_age_max);(c<13||c>100)&&(n.targeting_age_min=r("campaigns.create.errors.ageInvalid")),(b<13||b>100)&&(n.targeting_age_max=r("campaigns.create.errors.ageInvalid")),c>b&&(n.targeting_age_max=r("campaigns.create.errors.ageRangeInvalid"));break}return A(n),Object.keys(n).length===0},E=()=>{if(L(k)){const t=u+1;t<P.length&&S(P[t])}},V=()=>{const t=u-1;t>=0&&S(P[t])},G=async()=>{if(L("targeting")){h(!0),R(null);try{const t=a.external_id||`stratum_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,n={name:a.name,platform:a.platform,status:a.status,objective:a.objective,external_id:t,account_id:a.account_id,daily_budget_cents:a.daily_budget?Math.round(parseFloat(a.daily_budget)*100):null,lifetime_budget_cents:a.lifetime_budget?Math.round(parseFloat(a.lifetime_budget)*100):null,currency:a.currency,start_date:a.start_date||null,end_date:a.end_date||null,targeting_age_min:parseInt(a.targeting_age_min)||18,targeting_age_max:parseInt(a.targeting_age_max)||65,targeting_genders:a.targeting_genders.length>0?a.targeting_genders:null,targeting_locations:a.targeting_locations?a.targeting_locations.split(",").map(O=>({name:O.trim()})):null,targeting_interests:a.targeting_interests?a.targeting_interests.split(",").map(O=>O.trim()):null,custom_audiences:a.custom_audiences.length>0?a.custom_audiences:null,lookalike_audiences:a.lookalike_audiences.length>0?a.lookalike_audiences:null,saved_audiences:a.saved_audiences.length>0?a.saved_audiences:null},b=await(await fetch("/api/v1/campaigns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).json();b.success?(w==null||w(b.data),s()):R(b.message||r("campaigns.create.errors.submitFailed"))}catch{R(r("campaigns.create.errors.submitFailed"))}finally{h(!1)}}},s=()=>{p(J),S("platform"),A({}),R(null),I(null),B()},x=t=>t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(0)}K`:t.toString();return i?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:"relative w-full max-w-5xl max-h-[90vh] overflow-hidden rounded-2xl bg-card border shadow-xl mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-foreground",children:r("campaigns.create.title")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r("campaigns.create.subtitle")})]}),e.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-muted transition-colors",children:e.jsx(Z,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"px-6 py-4 border-b bg-muted/30",children:e.jsx("div",{className:"flex items-center justify-between",children:P.map((t,n)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:o("flex items-center justify-center w-8 h-8 rounded-full text-sm font-medium transition-all",n<u?"bg-green-500 text-white":n===u?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:n<u?e.jsx(q,{className:"w-4 h-4"}):n+1}),e.jsx("span",{className:o("ml-2 text-sm font-medium hidden sm:block",n===u?"text-foreground":"text-muted-foreground"),children:r(`campaigns.create.steps.${t}`)}),n<P.length-1&&e.jsx("div",{className:o("w-12 h-0.5 mx-4 transition-colors",n<u?"bg-green-500":"bg-muted")})]},t))})}),e.jsxs("div",{className:"p-8 overflow-y-auto max-h-[60vh]",children:[k==="platform"&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-muted-foreground text-lg",children:r("campaigns.create.selectPlatform")}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:z.map(t=>e.jsxs("button",{onClick:()=>d("platform",t.id),className:o("flex flex-col items-center gap-4 p-6 rounded-xl border-2 transition-all text-center relative",a.platform===t.id?"border-primary bg-primary/5":"border-transparent bg-muted/50 hover:bg-muted"),children:[a.platform===t.id&&e.jsx(q,{className:"w-5 h-5 text-primary absolute top-3 right-3"}),e.jsx("div",{className:o("w-16 h-16 rounded-xl flex items-center justify-center text-white font-bold text-2xl",t.color),children:t.name.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground text-lg",children:t.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]})]},t.id))}),l.platform&&e.jsxs("p",{className:"text-sm text-red-500 flex items-center gap-1",children:[e.jsx(W,{className:"w-4 h-4"}),l.platform]})]}),k==="basics"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:[r("campaigns.create.campaignName")," *"]}),e.jsx("input",{type:"text",value:a.name,onChange:t=>d("name",t.target.value),placeholder:r("campaigns.create.campaignNamePlaceholder"),className:o("w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary",l.name&&"border-red-500")}),l.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.name})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:[r("campaigns.create.objective")," *"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:y==null?void 0:y.objectives.map(t=>e.jsx("button",{onClick:()=>d("objective",t),className:o("px-3 py-2 rounded-lg text-sm font-medium border transition-all",a.objective===t?"border-primary bg-primary/10 text-primary":"border-transparent bg-muted hover:bg-muted/80 text-foreground"),children:r(`campaigns.create.objectives.${t.toLowerCase()}`,t.replace(/_/g," "))},t))}),l.objective&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.objective})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-2",children:[r("campaigns.create.accountId")," *"]}),_?e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2.5 rounded-lg border bg-muted",children:[e.jsx(pe,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading accounts..."})]}):g.length===0?e.jsx("div",{className:"flex items-center justify-between p-4 rounded-lg border border-dashed bg-muted/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"No ad accounts connected"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Connect your ",y==null?void 0:y.name," account in Settings → Integrations"]})]})]})}):e.jsxs("select",{value:a.account_id,onChange:t=>$(t.target.value),className:o("w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary",l.account_id&&"border-red-500"),children:[e.jsx("option",{value:"",children:"Select an ad account"}),g.map(t=>e.jsxs("option",{value:t.platform_account_id,children:[t.name," (",t.platform_account_id,") - ",t.currency]},t.id))]}),l.account_id&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.account_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.initialStatus")}),e.jsx("div",{className:"flex gap-3",children:["draft","active","paused"].map(t=>e.jsx("button",{onClick:()=>d("status",t),className:o("px-4 py-2 rounded-lg text-sm font-medium border transition-all",a.status===t?"border-primary bg-primary/10 text-primary":"border-transparent bg-muted hover:bg-muted/80 text-foreground"),children:r(`campaigns.status.${t}`)},t))})]})]}),k==="budget"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-blue-500/10 border border-blue-500/20",children:[e.jsx(he,{className:"w-5 h-5 text-blue-500"}),e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:r("campaigns.create.budgetInfo")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.currency")}),e.jsxs("select",{value:a.currency,onChange:t=>d("currency",t.target.value),className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary",children:[e.jsx("option",{value:"USD",children:"USD - US Dollar"}),e.jsx("option",{value:"EUR",children:"EUR - Euro"}),e.jsx("option",{value:"GBP",children:"GBP - British Pound"}),e.jsx("option",{value:"SAR",children:"SAR - Saudi Riyal"}),e.jsx("option",{value:"AED",children:"AED - UAE Dirham"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.dailyBudget")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",children:a.currency==="USD"?"$":a.currency==="EUR"?"€":a.currency}),e.jsx("input",{type:"number",value:a.daily_budget,onChange:t=>d("daily_budget",t.target.value),placeholder:"0.00",min:"0",step:"0.01",className:o("w-full pl-12 pr-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary",l.daily_budget&&"border-red-500")})]}),l.daily_budget&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.daily_budget})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.lifetimeBudget")}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-muted-foreground",children:a.currency==="USD"?"$":a.currency==="EUR"?"€":a.currency}),e.jsx("input",{type:"number",value:a.lifetime_budget,onChange:t=>d("lifetime_budget",t.target.value),placeholder:"0.00",min:"0",step:"0.01",className:"w-full pl-12 pr-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.startDate")}),e.jsx("input",{type:"date",value:a.start_date,onChange:t=>d("start_date",t.target.value),className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.endDate")}),e.jsx("input",{type:"date",value:a.end_date,onChange:t=>d("end_date",t.target.value),min:a.start_date,className:o("w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary",l.end_date&&"border-red-500")}),l.end_date&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.end_date})]})]})]}),k==="targeting"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-purple-500/10 border border-purple-500/20",children:[e.jsx(Q,{className:"w-5 h-5 text-purple-500"}),e.jsx("p",{className:"text-sm text-purple-600 dark:text-purple-400",children:r("campaigns.create.targetingInfo")})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-foreground mb-3",children:[r("campaigns.create.audiences","Audiences")," ",e.jsx("span",{className:"text-muted-foreground font-normal",children:"(Optional)"})]}),v?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 mb-3",children:[e.jsxs("button",{onClick:()=>f("custom"),className:o("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all",N==="custom"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[e.jsx(Re,{className:"w-4 h-4"}),"Custom (",v.custom.length,")"]}),e.jsxs("button",{onClick:()=>f("lookalike"),className:o("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all",N==="lookalike"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[e.jsx(Te,{className:"w-4 h-4"}),"Lookalike (",v.lookalike.length,")"]}),e.jsxs("button",{onClick:()=>f("saved"),className:o("flex items-center gap-2 px-3 py-1.5 rounded-lg text-sm font-medium transition-all",N==="saved"?"bg-primary text-primary-foreground":"bg-muted hover:bg-muted/80"),children:[e.jsx(Ee,{className:"w-4 h-4"}),"Saved (",v.saved.length,")"]})]}),N==="custom"&&e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:v.custom.map(t=>e.jsxs("label",{className:o("flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all",a.custom_audiences.includes(t.id)?"border-primary bg-primary/5":"border-transparent bg-muted/50 hover:bg-muted"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:a.custom_audiences.includes(t.id),onChange:()=>F("custom_audiences",t.id),className:"rounded border-muted-foreground"}),e.jsx("span",{className:"font-medium text-sm",children:t.name})]}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[x(t.size)," users"]})]},t.id))}),N==="lookalike"&&e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:v.lookalike.map(t=>e.jsxs("label",{className:o("flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all",a.lookalike_audiences.includes(t.id)?"border-primary bg-primary/5":"border-transparent bg-muted/50 hover:bg-muted"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:a.lookalike_audiences.includes(t.id),onChange:()=>F("lookalike_audiences",t.id),className:"rounded border-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm block",children:t.name}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["Source: ",t.source]})]})]}),e.jsx("span",{className:"text-xs text-muted-foreground",children:x(t.size)})]},t.id))}),N==="saved"&&e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:v.saved.map(t=>e.jsx("label",{className:o("flex items-center justify-between p-3 rounded-lg border cursor-pointer transition-all",a.saved_audiences.includes(t.id)?"border-primary bg-primary/5":"border-transparent bg-muted/50 hover:bg-muted"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:a.saved_audiences.includes(t.id),onChange:()=>F("saved_audiences",t.id),className:"rounded border-muted-foreground"}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-sm block",children:t.name}),e.jsx("span",{className:"text-xs text-muted-foreground",children:t.description})]})]})},t.id))}),(a.custom_audiences.length>0||a.lookalike_audiences.length>0||a.saved_audiences.length>0)&&e.jsxs("p",{className:"text-xs text-primary mt-2",children:[a.custom_audiences.length+a.lookalike_audiences.length+a.saved_audiences.length," ","audience(s) selected"]})]}):e.jsx("div",{className:"flex items-center justify-between p-4 rounded-lg border border-dashed bg-muted/30",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"No audiences synced"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Audiences can be synced after connecting your platform. Use demographic targeting below instead."})]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.ageRange")}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("input",{type:"number",value:a.targeting_age_min,onChange:t=>d("targeting_age_min",t.target.value),min:"13",max:"100",className:o("w-24 px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary text-center",l.targeting_age_min&&"border-red-500")}),e.jsx("span",{className:"text-muted-foreground",children:"to"}),e.jsx("input",{type:"number",value:a.targeting_age_max,onChange:t=>d("targeting_age_max",t.target.value),min:"13",max:"100",className:o("w-24 px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary text-center",l.targeting_age_max&&"border-red-500")}),e.jsx("span",{className:"text-sm text-muted-foreground",children:r("campaigns.create.yearsOld")})]}),(l.targeting_age_min||l.targeting_age_max)&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:l.targeting_age_min||l.targeting_age_max})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.gender")}),e.jsx("div",{className:"flex gap-3",children:["all","male","female"].map(t=>e.jsx("button",{onClick:()=>{if(t==="all")d("targeting_genders",[]);else{const n=a.targeting_genders;n.includes(t)?d("targeting_genders",n.filter(c=>c!==t)):d("targeting_genders",[...n,t])}},className:o("px-4 py-2 rounded-lg text-sm font-medium border transition-all",t==="all"&&a.targeting_genders.length===0||a.targeting_genders.includes(t)?"border-primary bg-primary/10 text-primary":"border-transparent bg-muted hover:bg-muted/80 text-foreground"),children:r(`campaigns.create.genders.${t}`)},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.locations")}),e.jsx("input",{type:"text",value:a.targeting_locations,onChange:t=>d("targeting_locations",t.target.value),placeholder:r("campaigns.create.locationsPlaceholder"),className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:r("campaigns.create.locationsHelp")})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:r("campaigns.create.interests")}),e.jsx("input",{type:"text",value:a.targeting_interests,onChange:t=>d("targeting_interests",t.target.value),placeholder:r("campaigns.create.interestsPlaceholder"),className:"w-full px-4 py-2.5 rounded-lg border bg-background focus:ring-2 focus:ring-primary/20 focus:border-primary"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:r("campaigns.create.interestsHelp")})]})]}),j&&e.jsxs("div",{className:"mt-4 flex items-center gap-3 p-4 bg-red-500/10 border border-red-500/20 rounded-lg text-red-600",children:[e.jsx(W,{className:"w-5 h-5"}),e.jsx("span",{children:j})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t bg-muted/30",children:[e.jsxs("button",{onClick:u===0?s:V,className:"flex items-center gap-2 px-4 py-2 rounded-lg border hover:bg-muted transition-colors",children:[e.jsx(be,{className:"w-4 h-4"}),r(u===0?"common.cancel":"common.back")]}),u<P.length-1?e.jsxs("button",{onClick:E,className:"flex items-center gap-2 px-6 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:[r("common.next"),e.jsx(te,{className:"w-4 h-4"})]}):e.jsx("button",{onClick:G,disabled:T,className:"flex items-center gap-2 px-6 py-2 rounded-lg bg-green-600 text-white hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:T?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"w-4 h-4 animate-spin"}),r("campaigns.create.creating")]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-4 h-4"}),r("campaigns.create.createCampaign")]})})]})]})]}):null}const Fe=[{id:1,name:"Summer Sale 2024",platform:"google",status:"active",spend:12450,budget:15e3,revenue:48750,roas:3.92,impressions:1245e3,clicks:34560,conversions:890,ctr:2.78,trend:"up"},{id:2,name:"Brand Awareness Q4",platform:"meta",status:"active",spend:8900,budget:1e4,revenue:35600,roas:4,impressions:21e5,clicks:42e3,conversions:560,ctr:2,trend:"stable"},{id:3,name:"Product Launch - Widget Pro",platform:"google",status:"paused",spend:5600,budget:8e3,revenue:15680,roas:2.8,impressions:89e4,clicks:21340,conversions:234,ctr:2.4,trend:"down"},{id:4,name:"Retargeting - Cart Abandoners",platform:"meta",status:"active",spend:3200,budget:5e3,revenue:19200,roas:6,impressions:45e4,clicks:13500,conversions:320,ctr:3,trend:"up"},{id:5,name:"TikTok Influencer Collab",platform:"tiktok",status:"active",spend:7800,budget:12e3,revenue:23400,roas:3,impressions:56e5,clicks:168e3,conversions:420,ctr:3,trend:"up"}];function at(){const{t:i}=K(),{toast:B}=se(),[w,r]=m.useState(""),[C,k]=m.useState("all"),[S,a]=m.useState("all"),[p,l]=m.useState("spend"),[A,T]=m.useState("desc"),[h,j]=m.useState([]),[R,N]=m.useState(!1);ae(s=>s.tenantId);const{data:f,isLoading:v}=fe(),I=je(),D=Ne(),u=ve(),y=m.useMemo(()=>f!=null&&f.items&&f.items.length>0?f.items.map(s=>{var x,t;return{id:Number(s.id)||Number(s.campaign_id)||0,name:s.name||s.campaign_name||"",platform:((x=s.platform)==null?void 0:x.toLowerCase())||"google",status:((t=s.status)==null?void 0:t.toLowerCase())||"active",spend:s.spend||0,budget:s.budget||s.daily_budget||1e4,revenue:s.revenue||0,roas:s.roas||(s.spend>0?s.revenue/s.spend:0),impressions:s.impressions||0,clicks:s.clicks||0,conversions:s.conversions||0,ctr:s.ctr||(s.impressions>0?s.clicks/s.impressions*100:0),trend:s.trend||(s.roas>=3.5?"up":s.roas<2.5?"down":"stable")}}):Fe,[f]),g=s=>{p===s?T(A==="asc"?"desc":"asc"):(l(s),T("desc"))},_=y.filter(s=>!(w&&!s.name.toLowerCase().includes(w.toLowerCase())||C!=="all"&&s.status!==C||S!=="all"&&s.platform!==S)).sort((s,x)=>{const t=s[p],n=x[p],c=A==="asc"?1:-1;return typeof t=="string"?t.localeCompare(n)*c:(t-n)*c}),Y=async()=>{for(const s of h)await I.mutateAsync(s.toString());j([])},d=async()=>{for(const s of h)await D.mutateAsync(s.toString());j([])},$=async()=>{for(const s of h)await u.mutateAsync(s.toString());j([])},F=()=>{h.length===_.length?j([]):j(_.map(s=>s.id))},L=s=>{j(x=>x.includes(s)?x.filter(t=>t!==s):[...x,s])},E=({field:s})=>p!==s?null:A==="asc"?e.jsx(me,{className:"w-4 h-4"}):e.jsx(ue,{className:"w-4 h-4"}),V=s=>{const x={active:"bg-green-500/10 text-green-500",paused:"bg-amber-500/10 text-amber-500",completed:"bg-blue-500/10 text-blue-500",draft:"bg-gray-500/10 text-gray-500"};return e.jsx("span",{className:o("px-2 py-1 rounded-full text-xs font-medium",x[s]),children:s.charAt(0).toUpperCase()+s.slice(1)})},G=s=>e.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-white text-xs font-bold",style:{backgroundColor:ge(s)},title:s.charAt(0).toUpperCase()+s.slice(1),children:s.charAt(0).toUpperCase()});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:i("campaigns.title")}),e.jsx("p",{className:"text-muted-foreground",children:i("campaigns.subtitle")})]}),e.jsxs("button",{onClick:()=>N(!0),className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 transition-colors",children:[e.jsx(ye,{className:"w-4 h-4"}),e.jsx("span",{children:i("campaigns.createNew")})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(re,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground"}),e.jsx("input",{type:"text",placeholder:i("campaigns.searchPlaceholder"),value:w,onChange:s=>r(s.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:C,onChange:s=>k(s.target.value),className:"px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"all",children:i("campaigns.allStatuses")}),e.jsx("option",{value:"active",children:i("campaigns.active")}),e.jsx("option",{value:"paused",children:i("campaigns.paused")}),e.jsx("option",{value:"completed",children:i("campaigns.completed")}),e.jsx("option",{value:"draft",children:i("campaigns.draft")})]}),e.jsxs("select",{value:S,onChange:s=>a(s.target.value),className:"px-4 py-2 rounded-lg border bg-background focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"all",children:i("campaigns.allPlatforms")}),e.jsx("option",{value:"google",children:"Google Ads"}),e.jsx("option",{value:"meta",children:"Meta Ads"}),e.jsx("option",{value:"tiktok",children:"TikTok Ads"})]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 rounded-lg border hover:bg-muted transition-colors",children:[e.jsx(_e,{className:"w-4 h-4"}),e.jsx("span",{children:i("common.moreFilters")})]})]})]}),h.length>0&&e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-primary/10 border border-primary/20",children:[e.jsxs("span",{className:"text-sm font-medium",children:[h.length," ",i("campaigns.selected")]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:Y,disabled:I.isPending,className:"flex items-center gap-1 px-3 py-1.5 rounded-md bg-background border hover:bg-muted transition-colors text-sm disabled:opacity-50",children:[I.isPending?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(ke,{className:"w-4 h-4"}),i("campaigns.pauseSelected")]}),e.jsxs("button",{onClick:d,disabled:D.isPending,className:"flex items-center gap-1 px-3 py-1.5 rounded-md bg-background border hover:bg-muted transition-colors text-sm disabled:opacity-50",children:[D.isPending?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(ne,{className:"w-4 h-4"}),i("campaigns.activateSelected")]}),e.jsxs("button",{onClick:$,disabled:u.isPending,className:"flex items-center gap-1 px-3 py-1.5 rounded-md bg-red-500/10 text-red-500 hover:bg-red-500/20 transition-colors text-sm disabled:opacity-50",children:[u.isPending?e.jsx(M,{className:"w-4 h-4 animate-spin"}):e.jsx(ie,{className:"w-4 h-4"}),i("campaigns.deleteSelected")]})]})]}),e.jsxs("div",{className:"rounded-xl border bg-card overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4 text-left",children:e.jsx("input",{type:"checkbox",checked:h.length===_.length&&_.length>0,onChange:F,className:"rounded border-muted-foreground/50"})}),e.jsx("th",{className:"p-4 text-left",children:e.jsxs("button",{onClick:()=>g("name"),className:"flex items-center gap-1 text-sm font-medium hover:text-primary",children:[i("campaigns.name"),e.jsx(E,{field:"name"})]})}),e.jsx("th",{className:"p-4 text-left text-sm font-medium",children:i("campaigns.status")}),e.jsx("th",{className:"p-4 text-right",children:e.jsxs("button",{onClick:()=>g("spend"),className:"flex items-center gap-1 text-sm font-medium hover:text-primary ml-auto",children:[i("campaigns.spend"),e.jsx(E,{field:"spend"})]})}),e.jsx("th",{className:"p-4 text-right",children:e.jsxs("button",{onClick:()=>g("revenue"),className:"flex items-center gap-1 text-sm font-medium hover:text-primary ml-auto",children:[i("campaigns.revenue"),e.jsx(E,{field:"revenue"})]})}),e.jsx("th",{className:"p-4 text-right",children:e.jsxs("button",{onClick:()=>g("roas"),className:"flex items-center gap-1 text-sm font-medium hover:text-primary ml-auto",children:["ROAS",e.jsx(E,{field:"roas"})]})}),e.jsx("th",{className:"p-4 text-right",children:e.jsxs("button",{onClick:()=>g("conversions"),className:"flex items-center gap-1 text-sm font-medium hover:text-primary ml-auto",children:[i("campaigns.conversions"),e.jsx(E,{field:"conversions"})]})}),e.jsx("th",{className:"p-4 text-right text-sm font-medium",children:"CTR"}),e.jsx("th",{className:"p-4 text-center text-sm font-medium",children:i("campaigns.trend")}),e.jsx("th",{className:"p-4 text-right text-sm font-medium",children:i("campaigns.actions")})]})}),e.jsx("tbody",{className:"divide-y",children:_.map(s=>e.jsxs("tr",{className:"hover:bg-muted/30 transition-colors",children:[e.jsx("td",{className:"p-4",children:e.jsx("input",{type:"checkbox",checked:h.includes(s.id),onChange:()=>L(s.id),className:"rounded border-muted-foreground/50"})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[G(s.platform),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[U(s.spend)," / ",U(s.budget)]})]})]})}),e.jsx("td",{className:"p-4",children:V(s.status)}),e.jsx("td",{className:"p-4 text-right font-medium",children:U(s.spend)}),e.jsx("td",{className:"p-4 text-right font-medium text-green-500",children:U(s.revenue)}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("span",{className:o("font-semibold",s.roas>=4&&"text-green-500",s.roas>=3&&s.roas<4&&"text-primary",s.roas<3&&"text-amber-500"),children:[s.roas.toFixed(2),"x"]})}),e.jsx("td",{className:"p-4 text-right",children:le(s.conversions)}),e.jsx("td",{className:"p-4 text-right",children:oe(s.ctr)}),e.jsxs("td",{className:"p-4 text-center",children:[s.trend==="up"&&e.jsx(ce,{className:"w-5 h-5 text-green-500 mx-auto"}),s.trend==="down"&&e.jsx(we,{className:"w-5 h-5 text-red-500 mx-auto"}),s.trend==="stable"&&e.jsx("div",{className:"w-5 h-0.5 bg-muted-foreground mx-auto"})]}),e.jsx("td",{className:"p-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-1",children:[e.jsx("button",{className:"p-2 rounded-lg hover:bg-muted transition-colors",children:e.jsx(de,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 rounded-lg hover:bg-muted transition-colors",children:e.jsx(Ce,{className:"w-4 h-4"})}),e.jsx("button",{className:"p-2 rounded-lg hover:bg-muted transition-colors",children:e.jsx(Se,{className:"w-4 h-4"})})]})})]},s.id))})]})}),_.length===0&&e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:"text-muted-foreground",children:i("campaigns.noResults")})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:v?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(M,{className:"w-4 h-4 animate-spin"}),"Loading campaigns..."]}):i("campaigns.showing",{count:_.length,total:y.length})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1.5 rounded-lg border hover:bg-muted transition-colors text-sm disabled:opacity-50",disabled:!0,children:i("common.previous")}),e.jsx("button",{className:"px-3 py-1.5 rounded-lg bg-primary text-primary-foreground text-sm",children:"1"}),e.jsx("button",{className:"px-3 py-1.5 rounded-lg border hover:bg-muted transition-colors text-sm",children:"2"}),e.jsx("button",{className:"px-3 py-1.5 rounded-lg border hover:bg-muted transition-colors text-sm",children:i("common.next")})]})]}),e.jsx(De,{open:R,onClose:()=>N(!1),onSuccess:s=>{B({title:"Campaign created",description:`"${(s==null?void 0:s.name)||"New campaign"}" has been created successfully.`})}})]})}export{at as Campaigns,at as default};
//# sourceMappingURL=Campaigns-CugwGdve.js.map
