var q=Object.defineProperty;var U=(a,t,s)=>t in a?q(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s;var j=(a,t,s)=>U(a,typeof t!="symbol"?t+"":t,s);import{j as e}from"./vendor-ui-B0DL0VNC.js";import{z as w,y as v,w as S,r as _,S as y,cZ as C,U as E,Z as k,H as $,s as I,D as H,cU as R}from"./index-BQex3859.js";import{r as m}from"./vendor-react-Dz7uKsMg.js";import{u as f}from"./vendor-query-BPt-n81V.js";import{R as L}from"./refresh-cw-DLOeozaH.js";import{I as O}from"./info-Bj1e8ZpJ.js";import{C as A}from"./circle-alert-MlATZigW.js";import{T as D}from"./trending-down-75FD7zon.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-motion-CR45sdSp.js";const F="/api";class K{constructor(t=F){j(this,"baseUrl");this.baseUrl=t}async request(t,s={}){const i=`${this.baseUrl}${t}`,d={...s,headers:{...{"Content-Type":"application/json"},...s.headers}};try{const n=await fetch(i,d);if(!n.ok)throw{message:`HTTP error! status: ${n.status}`,status:n.status};return{data:await n.json(),success:!0}}catch(n){return console.error("API request failed:",n),{data:null,success:!1,message:n instanceof Error?n.message:"Unknown error"}}}async get(t,s){let i=t;if(s){const r=new URLSearchParams(s);i=`${t}?${r.toString()}`}return this.request(i,{method:"GET"})}async post(t,s){return this.request(t,{method:"POST",body:s?JSON.stringify(s):void 0})}async put(t,s){return this.request(t,{method:"PUT",body:s?JSON.stringify(s):void 0})}async patch(t,s){return this.request(t,{method:"PATCH",body:s?JSON.stringify(s):void 0})}async delete(t){return this.request(t,{method:"DELETE"})}async getAssets(){return this.get("/assets")}async uploadAsset(t,s){const i=new FormData;i.append("file",t),s&&i.append("metadata",JSON.stringify(s));const r=`${this.baseUrl}/assets/upload`;return(await fetch(r,{method:"POST",body:i})).json()}async deleteAsset(t){return this.delete(`/assets/${t}`)}async getCampaigns(){return this.get("/campaigns")}async getCampaignById(t){return this.get(`/campaigns/${t}`)}async getAnalytics(t){return this.get("/analytics",t)}async getEMQData(){return this.get("/emq")}async getEMQIssues(){return this.get("/emq/issues")}}const N=new K,x={critical:{icon:S,color:"text-red-500",bg:"bg-red-500/10",border:"border-red-500/30",badge:"bg-red-500 text-white"},high:{icon:A,color:"text-orange-500",bg:"bg-orange-500/10",border:"border-orange-500/30",badge:"bg-orange-500 text-white"},medium:{icon:O,color:"text-yellow-500",bg:"bg-yellow-500/10",border:"border-yellow-500/30",badge:"bg-yellow-500 text-black"},low:{icon:v,color:"text-blue-500",bg:"bg-blue-500/10",border:"border-blue-500/30",badge:"bg-blue-500 text-white"}},G={revenue_decline:D,automation_blocked:y,signal_degraded:k,segment_underperforming:E,attribution_gap:C,trust_gate_bottleneck:y,channel_inefficiency:_};function M({score:a,status:t}){const s=2*Math.PI*45,i=s-a/100*s,r={healthy:"#34c759",degraded:"#f59e0b",critical:"#ef4444"},d=r[t]||r.degraded;return e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[e.jsx("circle",{cx:"64",cy:"64",r:"45",stroke:"currentColor",strokeWidth:"8",fill:"none",className:"text-white/10"}),e.jsx("circle",{cx:"64",cy:"64",r:"45",stroke:d,strokeWidth:"8",fill:"none",strokeLinecap:"round",strokeDasharray:s,strokeDashoffset:i,className:"transition-all duration-1000 ease-out"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("span",{className:"text-3xl font-bold text-white",children:Math.round(a)}),e.jsx("span",{className:"text-xs text-gray-400 uppercase tracking-wider",children:t})]})]})}function J({problem:a,isExpanded:t,onToggle:s}){const i=x[a.severity]||x.medium,r=i.icon,d=G[a.category]||A;return e.jsxs("div",{className:`rounded-xl border ${i.border} ${i.bg} overflow-hidden transition-all duration-300`,children:[e.jsxs("button",{onClick:s,className:"w-full p-4 flex items-start gap-4 text-left hover:bg-white/5 transition-colors",children:[e.jsx("div",{className:`p-2 rounded-lg ${i.bg} ${i.color}`,children:e.jsx(r,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${i.badge}`,children:a.severity.toUpperCase()}),e.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(d,{className:"w-3 h-3"}),a.category.replace(/_/g," ")]})]}),e.jsx("h3",{className:"text-white font-semibold truncate",children:a.title}),e.jsx("p",{className:"text-sm text-gray-400 mt-1 line-clamp-2",children:a.description})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[a.solutions.length," solution",a.solutions.length!==1?"s":""]}),t?e.jsx($,{className:"w-5 h-5 text-gray-400"}):e.jsx(I,{className:"w-5 h-5 text-gray-400"})]})]}),t&&e.jsxs("div",{className:"border-t border-white/10 p-4 space-y-4",children:[a.root_cause_path.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"}),"Root Cause Analysis"]}),e.jsx("div",{className:"space-y-2",children:a.root_cause_path.map((n,c)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-white/10 flex items-center justify-center text-xs text-gray-400",children:c+1}),e.jsxs("div",{children:[e.jsx("span",{className:"text-cyan-400 font-medium",children:String(n.node)}),e.jsx("span",{className:"text-gray-400 mx-2",children:"→"}),e.jsx("span",{className:"text-white",children:String(n.finding)}),!!n.detail&&e.jsx("p",{className:"text-gray-500 text-xs mt-0.5",children:String(n.detail)})]})]},c))})]}),Object.keys(a.metrics).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-2 flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4"}),"Key Metrics"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:Object.entries(a.metrics).slice(0,6).map(([n,c])=>e.jsxs("div",{className:"bg-white/5 rounded-lg p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 truncate",children:n.replace(/_/g," ")}),e.jsx("div",{className:"text-sm font-medium text-white truncate",children:typeof c=="number"?c.toLocaleString(void 0,{maximumFractionDigits:1}):String(c)})]},n))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-300 mb-3 flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4 text-amber-400"}),"Suggested Solutions"]}),e.jsx("div",{className:"space-y-3",children:a.solutions.map((n,c)=>e.jsx(B,{solution:n,priority:c+1},c))})]})]})]})}function B({solution:a,priority:t}){const[s,i]=m.useState(!1),r={investigate:"bg-blue-500/20 text-blue-400",fix:"bg-red-500/20 text-red-400",adjust:"bg-amber-500/20 text-amber-400",monitor:"bg-green-500/20 text-green-400"};return e.jsx("div",{className:"bg-white/5 rounded-lg p-4 border border-white/10",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-amber-500/20 flex items-center justify-center text-xs font-bold text-amber-400",children:t}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h5",{className:"text-white font-medium",children:a.title}),e.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${r[a.action_type]||"bg-gray-500/20 text-gray-400"}`,children:a.action_type}),a.auto_fixable&&e.jsxs("span",{className:"px-2 py-0.5 rounded text-xs bg-green-500/20 text-green-400 flex items-center gap-1",children:[e.jsx(k,{className:"w-3 h-3"}),"Auto-fix available"]})]}),e.jsx("p",{className:"text-sm text-gray-400",children:a.description}),a.estimated_impact&&e.jsxs("p",{className:"text-xs text-cyan-400 mt-2 flex items-center gap-1",children:[e.jsx(H,{className:"w-3 h-3"}),a.estimated_impact]}),a.steps.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("button",{onClick:()=>i(!s),className:"text-xs text-gray-400 hover:text-white flex items-center gap-1 transition-colors",children:[s?e.jsx($,{className:"w-3 h-3"}):e.jsx(I,{className:"w-3 h-3"}),s?"Hide":"Show"," ",a.steps.length," steps"]}),s&&e.jsx("ol",{className:"mt-2 space-y-1 text-sm text-gray-400 list-decimal list-inside",children:a.steps.map((d,n)=>e.jsx("li",{className:"pl-2",children:d},n))})]})]})]})})}function Q(){var u,p;const[a,t]=m.useState(null),[s,i]=m.useState(null),{data:r,isLoading:d,refetch:n}=f({queryKey:["kg-health"],queryFn:async()=>(await N.get("/knowledge-graph/insights/health")).data,refetchInterval:6e4}),{data:c,isLoading:h,refetch:P}=f({queryKey:["kg-problems",s],queryFn:async()=>{const l=new URLSearchParams;return s&&l.set("severity",s),(await N.get(`/knowledge-graph/insights/problems?${l}`)).data},refetchInterval:6e4}),T=()=>{n(),P()},g=(c==null?void 0:c.problems)||[];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(w,{className:"w-5 h-5 text-amber-400"}),"Knowledge Graph Insights"]}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"AI-powered problem detection with suggested solutions"})]}),e.jsx("button",{onClick:T,className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-400 hover:text-white transition-colors",children:e.jsx(L,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"bg-[rgba(255,_255,_255,_0.05)] rounded-xl border border-white/10 p-6",children:e.jsxs("div",{className:"flex items-center gap-8",children:[d?e.jsx("div",{className:"w-32 h-32 rounded-full bg-white/5 animate-pulse"}):r?e.jsx(M,{score:r.health_score,status:r.status}):null,e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"System Health Overview"}),e.jsx("div",{className:"grid grid-cols-4 gap-4",children:Object.entries((r==null?void 0:r.problem_counts)||{}).map(([l,b])=>{const o=x[l];return e.jsxs("button",{onClick:()=>i(s===l?null:l),className:`p-3 rounded-lg border transition-all ${s===l?`${o==null?void 0:o.border} ${o==null?void 0:o.bg}`:"border-white/10 bg-white/5 hover:bg-white/10"}`,children:[e.jsx("div",{className:`text-2xl font-bold ${(o==null?void 0:o.color)||"text-white"}`,children:String(b)}),e.jsx("div",{className:"text-xs text-gray-400 capitalize",children:l})]},l)})})]}),(r==null?void 0:r.top_problem)&&e.jsxs("div",{className:"w-80 bg-white/5 rounded-lg p-4 border border-white/10",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"Top Priority"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(S,{className:"w-4 h-4 text-red-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-white line-clamp-1",children:r.top_problem.title}),e.jsx("div",{className:"text-xs text-gray-400 mt-1 line-clamp-2",children:((u=r.top_problem.solutions[0])==null?void 0:u.title)||"View solutions"})]})]})]})]})}),s&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Filtering by:"}),e.jsxs("button",{onClick:()=>i(null),className:`px-3 py-1 rounded-full text-sm flex items-center gap-1 ${((p=x[s])==null?void 0:p.badge)||"bg-gray-500 text-white"}`,children:[s,e.jsx("span",{className:"ml-1",children:"×"})]})]}),e.jsx("div",{className:"space-y-3",children:h?e.jsx("div",{className:"space-y-3",children:[1,2,3].map(l=>e.jsx("div",{className:"h-24 bg-white/5 rounded-xl animate-pulse"},l))}):g.length===0?e.jsxs("div",{className:"text-center py-12 bg-[rgba(255,_255,_255,_0.05)] rounded-xl border border-white/10",children:[e.jsx(v,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"All Systems Healthy"}),e.jsx("p",{className:"text-gray-400",children:"No problems detected in the last 7 days."})]}):g.map(l=>e.jsx(J,{problem:l,isExpanded:a===l.id,onToggle:()=>t(a===l.id?null:l.id)},l.id))})]})}function ne(){return e.jsxs(e.Fragment,{children:[e.jsxs(R,{children:[e.jsx("title",{children:"Knowledge Graph Insights | Stratum AI"}),e.jsx("meta",{name:"description",content:"AI-powered problem detection with root cause analysis and suggested solutions"})]}),e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx(Q,{})})]})}export{ne as default};
//# sourceMappingURL=KnowledgeGraphInsights-DA1hSKEI.js.map
