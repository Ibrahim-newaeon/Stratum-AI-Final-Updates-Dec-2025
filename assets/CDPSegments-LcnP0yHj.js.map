{"version":3,"file":"CDPSegments-LcnP0yHj.js","sources":["../../src/views/cdp/CDPSegments.tsx"],"sourcesContent":["/**\r\n * CDP Segments - Segment builder and manager\r\n */\r\n\r\nimport { useState } from 'react';\r\nimport {\r\n  ArrowPathIcon,\r\n  CheckIcon,\r\n  ExclamationTriangleIcon,\r\n  MagnifyingGlassIcon,\r\n  PencilIcon,\r\n  PlayIcon,\r\n  PlusIcon,\r\n  TagIcon,\r\n  TrashIcon,\r\n  UserGroupIcon,\r\n  XMarkIcon,\r\n} from '@heroicons/react/24/outline';\r\nimport { cn } from '@/lib/utils';\r\nimport {\r\n  type CDPSegment,\r\n  type SegmentCondition,\r\n  type SegmentCreate,\r\n  type SegmentRules,\r\n  type SegmentStatus,\r\n  useComputeSegment,\r\n  useCreateSegment,\r\n  useDeleteSegment,\r\n  usePreviewSegment,\r\n  useSegments,\r\n  useUpdateSegment,\r\n} from '@/api/cdp';\r\n\r\n// Status Badge\r\nfunction StatusBadge({ status }: { status: SegmentStatus }) {\r\n  const config = {\r\n    draft: 'bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-300',\r\n    computing: 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400',\r\n    active: 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400',\r\n    stale: 'bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400',\r\n    archived: 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400',\r\n  };\r\n\r\n  return (\r\n    <span className={cn('px-2 py-1 rounded-full text-xs font-medium capitalize', config[status])}>\r\n      {status}\r\n    </span>\r\n  );\r\n}\r\n\r\n// Condition Builder Row\r\nfunction ConditionRow({\r\n  condition,\r\n  onChange,\r\n  onRemove,\r\n  isLast,\r\n}: {\r\n  condition: SegmentCondition;\r\n  onChange: (condition: SegmentCondition) => void;\r\n  onRemove: () => void;\r\n  isLast: boolean;\r\n}) {\r\n  const fieldOptions = [\r\n    { value: 'lifecycle_stage', label: 'Lifecycle Stage' },\r\n    { value: 'total_events', label: 'Total Events' },\r\n    { value: 'total_revenue', label: 'Total Revenue' },\r\n    { value: 'total_purchases', label: 'Total Purchases' },\r\n    { value: 'first_seen_at', label: 'First Seen' },\r\n    { value: 'last_seen_at', label: 'Last Seen' },\r\n    { value: 'has_email', label: 'Has Email' },\r\n    { value: 'has_phone', label: 'Has Phone' },\r\n  ];\r\n\r\n  const operatorOptions: Record<string, Array<{ value: string; label: string }>> = {\r\n    lifecycle_stage: [\r\n      { value: 'eq', label: 'equals' },\r\n      { value: 'neq', label: 'not equals' },\r\n      { value: 'in', label: 'is one of' },\r\n    ],\r\n    total_events: [\r\n      { value: 'gt', label: 'greater than' },\r\n      { value: 'gte', label: 'greater or equal' },\r\n      { value: 'lt', label: 'less than' },\r\n      { value: 'lte', label: 'less or equal' },\r\n      { value: 'eq', label: 'equals' },\r\n    ],\r\n    total_revenue: [\r\n      { value: 'gt', label: 'greater than' },\r\n      { value: 'gte', label: 'greater or equal' },\r\n      { value: 'lt', label: 'less than' },\r\n      { value: 'lte', label: 'less or equal' },\r\n    ],\r\n    total_purchases: [\r\n      { value: 'gt', label: 'greater than' },\r\n      { value: 'gte', label: 'greater or equal' },\r\n      { value: 'eq', label: 'equals' },\r\n    ],\r\n    first_seen_at: [\r\n      { value: 'after', label: 'after' },\r\n      { value: 'before', label: 'before' },\r\n      { value: 'within_days', label: 'within last N days' },\r\n    ],\r\n    last_seen_at: [\r\n      { value: 'after', label: 'after' },\r\n      { value: 'before', label: 'before' },\r\n      { value: 'within_days', label: 'within last N days' },\r\n    ],\r\n    has_email: [{ value: 'eq', label: 'is' }],\r\n    has_phone: [{ value: 'eq', label: 'is' }],\r\n  };\r\n\r\n  const operators = operatorOptions[condition.field] || operatorOptions.total_events;\r\n\r\n  return (\r\n    <div className=\"flex items-center gap-3 p-3 bg-muted/50 rounded-lg\">\r\n      <select\r\n        value={condition.field}\r\n        onChange={(e) => onChange({ ...condition, field: e.target.value, value: '' })}\r\n        className=\"px-3 py-2 border rounded-lg bg-background text-sm\"\r\n      >\r\n        {fieldOptions.map((opt) => (\r\n          <option key={opt.value} value={opt.value}>\r\n            {opt.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n\r\n      <select\r\n        value={condition.operator}\r\n        onChange={(e) => onChange({ ...condition, operator: e.target.value })}\r\n        className=\"px-3 py-2 border rounded-lg bg-background text-sm\"\r\n      >\r\n        {operators.map((opt) => (\r\n          <option key={opt.value} value={opt.value}>\r\n            {opt.label}\r\n          </option>\r\n        ))}\r\n      </select>\r\n\r\n      {condition.field === 'lifecycle_stage' ? (\r\n        <select\r\n          value={String(condition.value)}\r\n          onChange={(e) => onChange({ ...condition, value: e.target.value })}\r\n          className=\"flex-1 px-3 py-2 border rounded-lg bg-background text-sm\"\r\n        >\r\n          <option value=\"\">Select stage...</option>\r\n          <option value=\"anonymous\">Anonymous</option>\r\n          <option value=\"known\">Known</option>\r\n          <option value=\"customer\">Customer</option>\r\n          <option value=\"churned\">Churned</option>\r\n        </select>\r\n      ) : condition.field === 'has_email' || condition.field === 'has_phone' ? (\r\n        <select\r\n          value={String(condition.value)}\r\n          onChange={(e) => onChange({ ...condition, value: e.target.value === 'true' })}\r\n          className=\"flex-1 px-3 py-2 border rounded-lg bg-background text-sm\"\r\n        >\r\n          <option value=\"true\">Yes</option>\r\n          <option value=\"false\">No</option>\r\n        </select>\r\n      ) : (\r\n        <input\r\n          type={\r\n            condition.field.includes('_at') && !condition.operator.includes('days')\r\n              ? 'date'\r\n              : 'number'\r\n          }\r\n          value={String(condition.value || '')}\r\n          onChange={(e) => onChange({ ...condition, value: e.target.value })}\r\n          placeholder=\"Enter value...\"\r\n          className=\"flex-1 px-3 py-2 border rounded-lg bg-background text-sm\"\r\n        />\r\n      )}\r\n\r\n      <button\r\n        onClick={onRemove}\r\n        disabled={isLast}\r\n        className=\"p-2 hover:bg-muted rounded-lg transition-colors disabled:opacity-50\"\r\n      >\r\n        <TrashIcon className=\"h-4 w-4\" />\r\n      </button>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Segment Builder Modal\r\nfunction SegmentBuilderModal({\r\n  segment,\r\n  onClose,\r\n  onSave,\r\n}: {\r\n  segment?: CDPSegment;\r\n  onClose: () => void;\r\n  onSave: (data: SegmentCreate) => void;\r\n}) {\r\n  const [name, setName] = useState(segment?.name || '');\r\n  const [description, setDescription] = useState(segment?.description || '');\r\n  const [logic, setLogic] = useState<'and' | 'or'>('and');\r\n  const [conditions, setConditions] = useState<SegmentCondition[]>(\r\n    (segment?.rules as unknown as SegmentRules)?.conditions || [\r\n      { field: 'lifecycle_stage', operator: 'eq', value: '' },\r\n    ]\r\n  );\r\n  const [autoRefresh, setAutoRefresh] = useState(segment?.auto_refresh ?? true);\r\n  const [refreshInterval, setRefreshInterval] = useState(segment?.refresh_interval_hours || 24);\r\n\r\n  const previewMutation = usePreviewSegment();\r\n\r\n  const handlePreview = async () => {\r\n    try {\r\n      await previewMutation.mutateAsync({\r\n        rules: { logic, conditions },\r\n        limit: 10,\r\n      });\r\n    } catch (error) {\r\n      console.error('Preview failed:', error);\r\n    }\r\n  };\r\n\r\n  const handleSave = () => {\r\n    if (!name.trim()) return;\r\n    onSave({\r\n      name: name.trim(),\r\n      description: description.trim() || undefined,\r\n      rules: { logic, conditions },\r\n      auto_refresh: autoRefresh,\r\n      refresh_interval_hours: refreshInterval,\r\n    });\r\n  };\r\n\r\n  const addCondition = () => {\r\n    setConditions([...conditions, { field: 'total_events', operator: 'gt', value: 0 }]);\r\n  };\r\n\r\n  const updateCondition = (index: number, condition: SegmentCondition) => {\r\n    const updated = [...conditions];\r\n    updated[index] = condition;\r\n    setConditions(updated);\r\n  };\r\n\r\n  const removeCondition = (index: number) => {\r\n    if (conditions.length > 1) {\r\n      setConditions(conditions.filter((_, i) => i !== index));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\"\r\n      onClick={onClose}\r\n    >\r\n      <div\r\n        className=\"bg-card rounded-xl border shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-hidden\"\r\n        onClick={(e) => e.stopPropagation()}\r\n      >\r\n        {/* Header */}\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <h3 className=\"text-lg font-semibold\">{segment ? 'Edit Segment' : 'Create Segment'}</h3>\r\n          <button onClick={onClose} className=\"p-2 hover:bg-muted rounded-lg\">\r\n            <XMarkIcon className=\"h-5 w-5\" />\r\n          </button>\r\n        </div>\r\n\r\n        {/* Content */}\r\n        <div className=\"p-4 overflow-y-auto max-h-[calc(90vh-150px)] space-y-6\">\r\n          {/* Name & Description */}\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-1\">Segment Name *</label>\r\n              <input\r\n                type=\"text\"\r\n                value={name}\r\n                onChange={(e) => setName(e.target.value)}\r\n                placeholder=\"e.g., High-Value Customers\"\r\n                className=\"w-full px-3 py-2 border rounded-lg bg-background\"\r\n              />\r\n            </div>\r\n            <div>\r\n              <label className=\"block text-sm font-medium mb-1\">Description</label>\r\n              <textarea\r\n                value={description}\r\n                onChange={(e) => setDescription(e.target.value)}\r\n                placeholder=\"Describe what this segment includes...\"\r\n                rows={2}\r\n                className=\"w-full px-3 py-2 border rounded-lg bg-background resize-none\"\r\n              />\r\n            </div>\r\n          </div>\r\n\r\n          {/* Logic Toggle */}\r\n          <div>\r\n            <label className=\"block text-sm font-medium mb-2\">Match profiles where:</label>\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                onClick={() => setLogic('and')}\r\n                className={cn(\r\n                  'px-4 py-2 rounded-lg text-sm font-medium transition-colors',\r\n                  logic === 'and'\r\n                    ? 'bg-primary text-primary-foreground'\r\n                    : 'bg-muted hover:bg-muted/80'\r\n                )}\r\n              >\r\n                ALL conditions match (AND)\r\n              </button>\r\n              <button\r\n                onClick={() => setLogic('or')}\r\n                className={cn(\r\n                  'px-4 py-2 rounded-lg text-sm font-medium transition-colors',\r\n                  logic === 'or'\r\n                    ? 'bg-primary text-primary-foreground'\r\n                    : 'bg-muted hover:bg-muted/80'\r\n                )}\r\n              >\r\n                ANY condition matches (OR)\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Conditions */}\r\n          <div className=\"space-y-3\">\r\n            <label className=\"block text-sm font-medium\">Conditions</label>\r\n            {conditions.map((condition, index) => (\r\n              <ConditionRow\r\n                key={index}\r\n                condition={condition}\r\n                onChange={(c) => updateCondition(index, c)}\r\n                onRemove={() => removeCondition(index)}\r\n                isLast={conditions.length === 1}\r\n              />\r\n            ))}\r\n            <button\r\n              onClick={addCondition}\r\n              className=\"flex items-center gap-2 px-4 py-2 border border-dashed rounded-lg text-sm text-muted-foreground hover:text-foreground hover:border-primary transition-colors\"\r\n            >\r\n              <PlusIcon className=\"h-4 w-4\" />\r\n              Add Condition\r\n            </button>\r\n          </div>\r\n\r\n          {/* Auto-Refresh Settings */}\r\n          <div className=\"space-y-3\">\r\n            <label className=\"flex items-center gap-2\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={autoRefresh}\r\n                onChange={(e) => setAutoRefresh(e.target.checked)}\r\n                className=\"rounded border-gray-300\"\r\n              />\r\n              <span className=\"text-sm font-medium\">Auto-refresh segment</span>\r\n            </label>\r\n            {autoRefresh && (\r\n              <div className=\"ml-6\">\r\n                <label className=\"block text-sm text-muted-foreground mb-1\">Refresh every</label>\r\n                <select\r\n                  value={refreshInterval}\r\n                  onChange={(e) => setRefreshInterval(Number(e.target.value))}\r\n                  className=\"px-3 py-2 border rounded-lg bg-background text-sm\"\r\n                >\r\n                  <option value={1}>1 hour</option>\r\n                  <option value={6}>6 hours</option>\r\n                  <option value={12}>12 hours</option>\r\n                  <option value={24}>24 hours</option>\r\n                  <option value={168}>Weekly</option>\r\n                </select>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Preview */}\r\n          <div className=\"pt-4 border-t\">\r\n            <button\r\n              onClick={handlePreview}\r\n              disabled={previewMutation.isPending}\r\n              className=\"flex items-center gap-2 px-4 py-2 border rounded-lg text-sm hover:bg-muted transition-colors disabled:opacity-50\"\r\n            >\r\n              <UserGroupIcon className=\"h-4 w-4\" />\r\n              {previewMutation.isPending ? 'Loading...' : 'Preview Segment'}\r\n            </button>\r\n            {previewMutation.data && (\r\n              <div className=\"mt-3 p-3 bg-muted/50 rounded-lg\">\r\n                <p className=\"text-sm font-medium\">\r\n                  Estimated: {previewMutation.data.estimated_count.toLocaleString()} profiles\r\n                </p>\r\n                {previewMutation.data.sample_profiles.length > 0 && (\r\n                  <p className=\"text-xs text-muted-foreground mt-1\">\r\n                    Sample:{' '}\r\n                    {previewMutation.data.sample_profiles.map((p) => p.id.slice(0, 8)).join(', ')}\r\n                    ...\r\n                  </p>\r\n                )}\r\n              </div>\r\n            )}\r\n          </div>\r\n        </div>\r\n\r\n        {/* Footer */}\r\n        <div className=\"flex items-center justify-end gap-3 p-4 border-t\">\r\n          <button\r\n            onClick={onClose}\r\n            className=\"px-4 py-2 text-sm font-medium hover:bg-muted rounded-lg transition-colors\"\r\n          >\r\n            Cancel\r\n          </button>\r\n          <button\r\n            onClick={handleSave}\r\n            disabled={!name.trim()}\r\n            className=\"px-4 py-2 bg-primary text-primary-foreground rounded-lg text-sm font-medium hover:bg-primary/90 transition-colors disabled:opacity-50\"\r\n          >\r\n            <CheckIcon className=\"h-4 w-4 inline-block mr-1\" />\r\n            {segment ? 'Update' : 'Create'} Segment\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n// Segment Card\r\nfunction SegmentCard({\r\n  segment,\r\n  onEdit,\r\n  onCompute,\r\n  onDelete,\r\n}: {\r\n  segment: CDPSegment;\r\n  onEdit: () => void;\r\n  onCompute: () => void;\r\n  onDelete: () => void;\r\n}) {\r\n  return (\r\n    <div className=\"bg-card rounded-xl border p-4 hover:shadow-lg transition-shadow\">\r\n      <div className=\"flex items-start justify-between mb-3\">\r\n        <div className=\"flex items-center gap-3\">\r\n          <div className=\"h-10 w-10 rounded-lg bg-primary/10 flex items-center justify-center\">\r\n            <TagIcon className=\"h-5 w-5 text-primary\" />\r\n          </div>\r\n          <div>\r\n            <h3 className=\"font-semibold\">{segment.name}</h3>\r\n            <p className=\"text-sm text-muted-foreground\">{segment.slug}</p>\r\n          </div>\r\n        </div>\r\n        <StatusBadge status={segment.status} />\r\n      </div>\r\n\r\n      {segment.description && (\r\n        <p className=\"text-sm text-muted-foreground mb-3 line-clamp-2\">{segment.description}</p>\r\n      )}\r\n\r\n      <div className=\"grid grid-cols-2 gap-4 mb-4\">\r\n        <div>\r\n          <p className=\"text-xs text-muted-foreground\">Profiles</p>\r\n          <p className=\"font-semibold\">{segment.profile_count.toLocaleString()}</p>\r\n        </div>\r\n        <div>\r\n          <p className=\"text-xs text-muted-foreground\">Last Computed</p>\r\n          <p className=\"text-sm\">\r\n            {segment.last_computed_at\r\n              ? new Date(segment.last_computed_at).toLocaleDateString()\r\n              : 'Never'}\r\n          </p>\r\n        </div>\r\n      </div>\r\n\r\n      {segment.tags.length > 0 && (\r\n        <div className=\"flex flex-wrap gap-1 mb-4\">\r\n          {segment.tags.map((tag) => (\r\n            <span key={tag} className=\"px-2 py-0.5 bg-muted rounded text-xs\">\r\n              {tag}\r\n            </span>\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"flex items-center justify-between pt-3 border-t\">\r\n        <div className=\"flex items-center gap-1\">\r\n          {segment.auto_refresh && (\r\n            <span className=\"flex items-center gap-1 text-xs text-muted-foreground\">\r\n              <ArrowPathIcon className=\"h-3 w-3\" />\r\n              Every {segment.refresh_interval_hours}h\r\n            </span>\r\n          )}\r\n        </div>\r\n        <div className=\"flex items-center gap-1\">\r\n          <button\r\n            onClick={onCompute}\r\n            className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\r\n            title=\"Recompute\"\r\n          >\r\n            <PlayIcon className=\"h-4 w-4\" />\r\n          </button>\r\n          <button\r\n            onClick={onEdit}\r\n            className=\"p-2 hover:bg-muted rounded-lg transition-colors\"\r\n            title=\"Edit\"\r\n          >\r\n            <PencilIcon className=\"h-4 w-4\" />\r\n          </button>\r\n          <button\r\n            onClick={onDelete}\r\n            className=\"p-2 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors text-red-500\"\r\n            title=\"Delete\"\r\n          >\r\n            <TrashIcon className=\"h-4 w-4\" />\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default function CDPSegments() {\r\n  const [search, setSearch] = useState('');\r\n  const [showBuilder, setShowBuilder] = useState(false);\r\n  const [editingSegment, setEditingSegment] = useState<CDPSegment | undefined>();\r\n  const [deleteConfirm, setDeleteConfirm] = useState<string | null>(null);\r\n\r\n  const { data, isLoading, refetch } = useSegments();\r\n  const createMutation = useCreateSegment();\r\n  const updateMutation = useUpdateSegment();\r\n  const deleteMutation = useDeleteSegment();\r\n  const computeMutation = useComputeSegment();\r\n\r\n  const filteredSegments =\r\n    data?.segments.filter(\r\n      (s) =>\r\n        s.name.toLowerCase().includes(search.toLowerCase()) ||\r\n        s.description?.toLowerCase().includes(search.toLowerCase())\r\n    ) || [];\r\n\r\n  const handleCreate = async (segmentData: SegmentCreate) => {\r\n    try {\r\n      await createMutation.mutateAsync(segmentData);\r\n      setShowBuilder(false);\r\n      refetch();\r\n    } catch (error) {\r\n      console.error('Create failed:', error);\r\n    }\r\n  };\r\n\r\n  const handleUpdate = async (segmentData: SegmentCreate) => {\r\n    if (!editingSegment) return;\r\n    try {\r\n      await updateMutation.mutateAsync({\r\n        segmentId: editingSegment.id,\r\n        update: segmentData,\r\n      });\r\n      setEditingSegment(undefined);\r\n      refetch();\r\n    } catch (error) {\r\n      console.error('Update failed:', error);\r\n    }\r\n  };\r\n\r\n  const handleDelete = async (segmentId: string) => {\r\n    try {\r\n      await deleteMutation.mutateAsync(segmentId);\r\n      setDeleteConfirm(null);\r\n      refetch();\r\n    } catch (error) {\r\n      console.error('Delete failed:', error);\r\n    }\r\n  };\r\n\r\n  const handleCompute = async (segmentId: string) => {\r\n    try {\r\n      await computeMutation.mutateAsync(segmentId);\r\n      refetch();\r\n    } catch (error) {\r\n      console.error('Compute failed:', error);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header */}\r\n      <div className=\"flex flex-col sm:flex-row sm:items-center justify-between gap-4\">\r\n        <div>\r\n          <h1 className=\"text-2xl font-bold\">Segments</h1>\r\n          <p className=\"text-muted-foreground mt-1\">{data?.total || 0} segments</p>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowBuilder(true)}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors\"\r\n        >\r\n          <PlusIcon className=\"h-4 w-4\" />\r\n          Create Segment\r\n        </button>\r\n      </div>\r\n\r\n      {/* Search */}\r\n      <div className=\"relative max-w-md\">\r\n        <MagnifyingGlassIcon className=\"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground\" />\r\n        <input\r\n          type=\"text\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n          placeholder=\"Search segments...\"\r\n          className=\"w-full pl-10 pr-4 py-2 border rounded-lg bg-background focus:ring-2 focus:ring-primary focus:outline-none\"\r\n        />\r\n      </div>\r\n\r\n      {/* Segments Grid */}\r\n      {isLoading ? (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {[1, 2, 3].map((i) => (\r\n            <div key={i} className=\"bg-card rounded-xl border p-4 animate-pulse\">\r\n              <div className=\"h-10 w-10 bg-muted rounded-lg mb-3\" />\r\n              <div className=\"h-5 w-32 bg-muted rounded mb-2\" />\r\n              <div className=\"h-4 w-full bg-muted rounded\" />\r\n            </div>\r\n          ))}\r\n        </div>\r\n      ) : filteredSegments.length === 0 ? (\r\n        <div className=\"text-center py-12 bg-card rounded-xl border\">\r\n          <TagIcon className=\"h-12 w-12 mx-auto text-muted-foreground mb-4\" />\r\n          <h3 className=\"font-semibold mb-2\">No segments found</h3>\r\n          <p className=\"text-muted-foreground text-sm mb-4\">\r\n            {search ? 'Try a different search term' : 'Create your first segment to get started'}\r\n          </p>\r\n          {!search && (\r\n            <button\r\n              onClick={() => setShowBuilder(true)}\r\n              className=\"px-4 py-2 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90\"\r\n            >\r\n              Create Segment\r\n            </button>\r\n          )}\r\n        </div>\r\n      ) : (\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\r\n          {filteredSegments.map((segment) => (\r\n            <SegmentCard\r\n              key={segment.id}\r\n              segment={segment}\r\n              onEdit={() => setEditingSegment(segment)}\r\n              onCompute={() => handleCompute(segment.id)}\r\n              onDelete={() => setDeleteConfirm(segment.id)}\r\n            />\r\n          ))}\r\n        </div>\r\n      )}\r\n\r\n      {/* Create/Edit Modal */}\r\n      {(showBuilder || editingSegment) && (\r\n        <SegmentBuilderModal\r\n          segment={editingSegment}\r\n          onClose={() => {\r\n            setShowBuilder(false);\r\n            setEditingSegment(undefined);\r\n          }}\r\n          onSave={editingSegment ? handleUpdate : handleCreate}\r\n        />\r\n      )}\r\n\r\n      {/* Delete Confirmation */}\r\n      {deleteConfirm && (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50\">\r\n          <div className=\"bg-card rounded-xl border p-6 max-w-md mx-4\">\r\n            <div className=\"flex items-center gap-3 mb-4\">\r\n              <div className=\"h-10 w-10 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center\">\r\n                <ExclamationTriangleIcon className=\"h-5 w-5 text-red-500\" />\r\n              </div>\r\n              <div>\r\n                <h3 className=\"font-semibold\">Delete Segment</h3>\r\n                <p className=\"text-sm text-muted-foreground\">This action cannot be undone</p>\r\n              </div>\r\n            </div>\r\n            <div className=\"flex items-center justify-end gap-3\">\r\n              <button\r\n                onClick={() => setDeleteConfirm(null)}\r\n                className=\"px-4 py-2 text-sm font-medium hover:bg-muted rounded-lg\"\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                onClick={() => handleDelete(deleteConfirm)}\r\n                disabled={deleteMutation.isPending}\r\n                className=\"px-4 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600 disabled:opacity-50\"\r\n              >\r\n                {deleteMutation.isPending ? 'Deleting...' : 'Delete'}\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["StatusBadge","status","config","jsx","cn","ConditionRow","condition","onChange","onRemove","isLast","fieldOptions","operatorOptions","operators","jsxs","e","opt","TrashIcon","SegmentBuilderModal","segment","onClose","onSave","name","setName","useState","description","setDescription","logic","setLogic","conditions","setConditions","_a","autoRefresh","setAutoRefresh","refreshInterval","setRefreshInterval","previewMutation","usePreviewSegment","handlePreview","error","handleSave","addCondition","updateCondition","index","updated","removeCondition","_","i","XMarkIcon","c","PlusIcon","UserGroupIcon","p","CheckIcon","SegmentCard","onEdit","onCompute","onDelete","TagIcon","tag","ArrowPathIcon","PlayIcon","PencilIcon","CDPSegments","search","setSearch","showBuilder","setShowBuilder","editingSegment","setEditingSegment","deleteConfirm","setDeleteConfirm","data","isLoading","refetch","useSegments","createMutation","useCreateSegment","updateMutation","useUpdateSegment","deleteMutation","useDeleteSegment","computeMutation","useComputeSegment","filteredSegments","s","handleCreate","segmentData","handleUpdate","handleDelete","segmentId","handleCompute","MagnifyingGlassIcon","ExclamationTriangleIcon"],"mappings":"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"}