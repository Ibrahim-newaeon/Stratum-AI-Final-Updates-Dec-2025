import{j as e}from"./vendor-ui-B0DL0VNC.js";import{f as $,r as N}from"./vendor-react-Dz7uKsMg.js";import{h as A,f as D,c as l,a7 as v,cX as E}from"./index-BQex3859.js";import{a as c,u as r,b as M,c as O,d as _}from"./campaignBuilder-B-MzQ-hf.js";import{F as C}from"./XCircleIcon-Dk49lKz_.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-query-BPt-n81V.js";import"./vendor-motion-CR45sdSp.js";const I=[{id:"meta",name:"Meta Ads",logo:"/platforms/meta.svg",status:"connected",connectedAt:"2024-01-15",expiresAt:"2025-01-15",accountCount:3},{id:"google",name:"Google Ads",logo:"/platforms/google.svg",status:"connected",connectedAt:"2024-02-10",expiresAt:"2025-02-10",accountCount:2},{id:"tiktok",name:"TikTok Ads",logo:"/platforms/tiktok.svg",status:"disconnected"},{id:"snapchat",name:"Snapchat Ads",logo:"/platforms/snapchat.svg",status:"disconnected"},{id:"linkedin",name:"LinkedIn Ads",logo:"/platforms/linkedin.svg",status:"disconnected"}],n={meta:{health:"healthy",emqScore:92,lastSync:"2 min ago",dataVolume:"12.4k events/day"},google:{health:"healthy",emqScore:88,lastSync:"5 min ago",dataVolume:"8.2k events/day"},tiktok:{health:"degraded",emqScore:0,lastSync:"Never",dataVolume:"0 events"},snapchat:{health:"unhealthy",emqScore:0,lastSync:"Never",dataVolume:"0 events"},linkedin:{health:"unhealthy",emqScore:0,lastSync:"Never",dataVolume:"0 events"}},L={healthy:"bg-green-500",degraded:"bg-amber-500",unhealthy:"bg-gray-500"},z={connected:{icon:D,color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-50 dark:bg-emerald-950/30",label:"Connected"},disconnected:{icon:C,color:"text-gray-400",bgColor:"bg-gray-50 dark:bg-gray-900/30",label:"Not Connected"},expired:{icon:A,color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-50 dark:bg-amber-950/30",label:"Token Expired"},error:{icon:C,color:"text-red-600 dark:text-red-400",bgColor:"bg-red-50 dark:bg-red-950/30",label:"Connection Error"}};function U(){const{tenantId:w}=$(),a=parseInt(w||"1",10),[m,u]=N.useState(null),{data:h}=c(a,"meta"),{data:x}=c(a,"google"),{data:g}=c(a,"tiktok"),{data:p}=c(a,"snapchat"),{data:f}=r(a,"meta"),{data:j}=r(a,"google"),{data:y}=r(a,"tiktok"),{data:b}=r(a,"snapchat"),S=M(a),F=O(a),R=_(a),T=N.useMemo(()=>{const t={meta:h,google:x,tiktok:g,snapchat:p},s={meta:f,google:j,tiktok:y,snapchat:b};return I.map(o=>{var k;const d=t[o.id],i=s[o.id];return d?{...o,status:d.status,connectedAt:(k=d.connected_at)==null?void 0:k.split("T")[0],accountCount:(i==null?void 0:i.length)??0}:o})},[h,x,g,p,f,j,y,b]),q=async t=>{u(t);try{const s=await S.mutateAsync(t);s.oauth_url&&(window.location.href=s.oauth_url)}catch(s){console.error("Failed to start connection:",s),alert(`OAuth flow would start for ${t}`)}finally{u(null)}},P=async t=>{if(confirm("Are you sure you want to disconnect this platform?"))try{await R.mutateAsync(t)}catch(s){console.error("Failed to disconnect:",s),alert(`Disconnected ${t} (demo mode)`)}},V=async t=>{try{await F.mutateAsync(t),alert("Token refreshed successfully")}catch(s){console.error("Failed to refresh token:",s),alert(`Refreshing token for ${t} (demo mode)`)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Connect Platforms"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect your advertising accounts via OAuth to manage campaigns and access ad accounts"}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-2 flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),e.jsxs("span",{children:["This grants access to ",e.jsx("strong",{children:"ad accounts & campaigns"}),". For server-side conversion tracking (CAPI), go to"," ",e.jsx("a",{href:"/dashboard/capi-setup",className:"text-primary hover:underline",children:"CAPI Setup"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:T.map(t=>{const s=z[t.status],o=s.icon;return e.jsxs("div",{className:l("rounded-xl border p-6 transition-all",t.status==="connected"?"bg-card shadow-card":"bg-muted/30"),children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-12 w-12 rounded-lg bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-700 flex items-center justify-center",children:e.jsx("span",{className:"text-lg font-bold text-gray-600 dark:text-gray-300",children:t.name.charAt(0)})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsxs("div",{className:l("flex items-center gap-1 text-sm",s.color),children:[e.jsx(o,{className:"h-4 w-4"}),e.jsx("span",{children:s.label})]})]})]}),t.status==="connected"&&n[t.id]&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:l("h-2.5 w-2.5 rounded-full",L[n[t.id].health])}),e.jsx("span",{className:"text-xs text-muted-foreground capitalize",children:n[t.id].health}),n[t.id].emqScore>0&&e.jsxs("span",{className:"text-xs font-medium px-1.5 py-0.5 rounded bg-primary/10 text-primary",children:["EMQ ",n[t.id].emqScore,"%"]})]})]}),t.status==="connected"&&e.jsxs("div",{className:"mt-4 pt-4 border-t space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Connected Accounts"}),e.jsx("span",{className:"font-medium",children:t.accountCount})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Connected On"}),e.jsx("span",{className:"font-medium",children:t.connectedAt})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Token Expires"}),e.jsx("span",{className:"font-medium",children:t.expiresAt})]}),n[t.id]&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Sync"}),e.jsx("span",{className:"font-medium",children:n[t.id].lastSync})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Data Volume"}),e.jsx("span",{className:"font-medium",children:n[t.id].dataVolume})]})]})]}),e.jsx("div",{className:"mt-4 flex gap-2",children:t.status==="connected"?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>V(t.id),className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg border hover:bg-accent transition-colors",children:[e.jsx(v,{className:"h-4 w-4"}),"Refresh Token"]}),e.jsx("button",{onClick:()=>P(t.id),className:"flex items-center gap-2 px-3 py-2 text-sm rounded-lg text-red-600 hover:bg-red-50 dark:hover:bg-red-950/30 transition-colors",children:"Disconnect"})]}):e.jsxs("button",{onClick:()=>q(t.id),disabled:m===t.id,className:"flex items-center gap-2 px-4 py-2 text-sm rounded-lg bg-primary text-primary-foreground hover:opacity-90 transition-opacity disabled:opacity-50",children:[m===t.id?e.jsx(v,{className:"h-4 w-4 animate-spin"}):e.jsx(E,{className:"h-4 w-4"}),"Connect ",t.name]})})]},t.id)})}),e.jsxs("div",{className:"rounded-xl border bg-muted/30 p-6",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"About Platform Connections"}),e.jsxs("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[e.jsx("li",{children:"- OAuth tokens are securely stored and automatically refreshed"}),e.jsx("li",{children:"- Connections grant access to view and manage ad accounts"}),e.jsx("li",{children:"- You can disconnect at any time from platform settings"}),e.jsx("li",{children:"- Campaign Builder requires at least one connected platform"})]})]})]})}export{U as default};
//# sourceMappingURL=ConnectPlatforms-CswUcjOk.js.map
