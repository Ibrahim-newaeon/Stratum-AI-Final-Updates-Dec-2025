import{j as e}from"./vendor-ui-B0DL0VNC.js";import{f as C,r as S}from"./vendor-react-Dz7uKsMg.js";import{t as a,a7 as p,c as h,cX as g,ag as k,a8 as D,f as j,h as R}from"./index-BQex3859.js";import"./featureFlagsStore-DvEl_DiZ.js";import{u as l,a as b,b as y}from"./vendor-query-BPt-n81V.js";import{F as $}from"./XCircleIcon-Dk49lKz_.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-motion-CR45sdSp.js";const i={getConnections:async()=>(await a.get("/integrations/crm/connections")).data.data,getConnection:async s=>(await a.get(`/integrations/crm/connections/${s}`)).data.data,connectHubSpot:async s=>(await a.post("/integrations/crm/hubspot/connect",{auth_code:s})).data.data,disconnectCRM:async s=>(await a.delete(`/integrations/crm/connections/${s}`)).data,updateConnectionSettings:async(s,r)=>(await a.patch(`/integrations/crm/connections/${s}`,r)).data.data,triggerSync:async s=>(await a.post(`/integrations/crm/connections/${s}/sync`)).data.data,getSyncStatus:async s=>(await a.get(`/integrations/crm/connections/${s}/sync-status`)).data.data,getContacts:async s=>(await a.get("/integrations/crm/contacts",{params:s})).data.data,getContact:async s=>(await a.get(`/integrations/crm/contacts/${s}`)).data.data,getContactJourney:async s=>(await a.get(`/integrations/crm/contacts/${s}/journey`)).data.data,getDeals:async s=>(await a.get("/integrations/crm/deals",{params:s})).data.data,getDeal:async s=>(await a.get(`/integrations/crm/deals/${s}`)).data.data,getPipelineMetrics:async s=>(await a.get("/integrations/crm/pipeline/metrics",{params:s})).data.data,getPipelineSummary:async()=>(await a.get("/integrations/crm/pipeline/summary")).data.data,getWritebackConfig:async()=>(await a.get("/integrations/crm/writeback/config")).data.data,updateWritebackConfig:async s=>(await a.put("/integrations/crm/writeback/config",s)).data.data,getWritebackHistory:async s=>(await a.get("/integrations/crm/writeback/history",{params:s})).data.data,retryWriteback:async s=>(await a.post(`/integrations/crm/writeback/${s}/retry`)).data.data};function F(){return l({queryKey:["crm","connections"],queryFn:i.getConnections})}function q(){const s=b();return y({mutationFn:i.triggerSync,onSuccess:()=>{s.invalidateQueries({queryKey:["crm"]})}})}function L(s){return l({queryKey:["crm","contacts",s],queryFn:()=>i.getContacts(s)})}function W(s){return l({queryKey:["crm","deals",s],queryFn:()=>i.getDeals(s)})}function M(){return l({queryKey:["crm","pipeline","summary"],queryFn:i.getPipelineSummary})}function A(){return l({queryKey:["crm","writeback","config"],queryFn:i.getWritebackConfig})}function P(){const s=b();return y({mutationFn:i.updateWritebackConfig,onSuccess:()=>{s.invalidateQueries({queryKey:["crm","writeback"]})}})}function O(){C();const[s,r]=S.useState("overview"),{data:o,isLoading:N}=F(),{data:d}=M(),{data:m}=L({limit:10}),{data:x}=W({limit:10}),{data:c}=A(),u=q(),f=P(),n=o==null?void 0:o.find(t=>t.provider==="hubspot"),v=[{id:"overview",label:"Overview"},{id:"contacts",label:"Contacts"},{id:"deals",label:"Deals"},{id:"writeback",label:"Writeback"}],w=t=>{switch(t){case"connected":return e.jsx(j,{className:"h-5 w-5 text-emerald-500"});case"error":return e.jsx($,{className:"h-5 w-5 text-red-500"});case"syncing":return e.jsx(p,{className:"h-5 w-5 text-blue-500 animate-spin"});default:return e.jsx(R,{className:"h-5 w-5 text-amber-500"})}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"CRM Integrations"}),e.jsx("p",{className:"text-muted-foreground",children:"Connect and manage your CRM platforms for enhanced attribution and data sync"})]}),n&&e.jsxs("button",{onClick:()=>u.mutate(n.id),disabled:u.isPending,className:"flex items-center gap-2 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90 disabled:opacity-50",children:[e.jsx(p,{className:h("h-4 w-4",u.isPending&&"animate-spin")}),"Sync Now"]})]}),e.jsx("div",{className:"border-b",children:e.jsx("nav",{className:"flex gap-4",children:v.map(t=>e.jsx("button",{onClick:()=>r(t.id),className:h("px-4 py-2 border-b-2 font-medium text-sm transition-colors",s===t.id?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"),children:t.label},t.id))})}),s==="overview"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Connection Status"}),N?e.jsx("div",{className:"animate-pulse h-20 bg-muted rounded-lg"}):n?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg bg-orange-100 dark:bg-orange-900/20",children:e.jsx(g,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"HubSpot"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Portal: ",n.portalName||n.portalId]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[w(n.status),e.jsx("span",{className:"text-sm capitalize",children:n.status})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(g,{className:"h-12 w-12 mx-auto text-muted-foreground mb-3"}),e.jsx("p",{className:"text-muted-foreground",children:"No CRM connected"}),e.jsx("button",{className:"mt-4 px-4 py-2 rounded-lg bg-primary text-primary-foreground hover:bg-primary/90",children:"Connect HubSpot"})]})]}),n&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/20",children:e.jsx(k,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Contacts"}),e.jsx("p",{className:"text-2xl font-bold",children:n.totalContacts.toLocaleString()})]})]})}),e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/20",children:e.jsx(D,{className:"h-5 w-5 text-emerald-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Deals"}),e.jsx("p",{className:"text-2xl font-bold",children:n.totalDeals.toLocaleString()})]})]})}),e.jsx("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/20",children:e.jsx(p,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Last Sync"}),e.jsx("p",{className:"text-lg font-medium",children:n.lastSyncAt?new Date(n.lastSyncAt).toLocaleString():"Never"})]})]})})]}),d&&e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Pipeline Overview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Value"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",d.totalValue.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Deal Size"}),e.jsxs("p",{className:"text-xl font-bold",children:["$",d.avgDealSize.toLocaleString()]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion Rate"}),e.jsxs("p",{className:"text-xl font-bold",children:[(d.conversionRate*100).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Deals"}),e.jsx("p",{className:"text-xl font-bold",children:d.totalDeals})]})]})]})]}),s==="contacts"&&e.jsx("div",{className:"rounded-xl border bg-card shadow-card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Contact"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Company"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Touchpoints"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Deal Value"})]})}),e.jsx("tbody",{className:"divide-y",children:m==null?void 0:m.items.map(t=>e.jsxs("tr",{className:"hover:bg-muted/30",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:[t.firstName," ",t.lastName]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.email})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.company||"-"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300",children:t.lifecycleStage||"Lead"})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.touchpointCount}),e.jsxs("td",{className:"px-4 py-3 text-right text-sm font-medium",children:["$",t.totalDealValue.toLocaleString()]})]},t.id))})]})}),s==="deals"&&e.jsx("div",{className:"rounded-xl border bg-card shadow-card overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-muted/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Deal"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Stage"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium",children:"Close Date"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium",children:"Amount"})]})}),e.jsx("tbody",{className:"divide-y",children:x==null?void 0:x.items.map(t=>e.jsxs("tr",{className:"hover:bg-muted/30",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("p",{className:"font-medium",children:t.dealName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.pipeline})]}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:h("px-2 py-1 rounded-full text-xs",t.stage==="won"&&"bg-emerald-100 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-300",t.stage==="lost"&&"bg-red-100 dark:bg-red-900/20 text-red-700 dark:text-red-300",!["won","lost"].includes(t.stage)&&"bg-blue-100 dark:bg-blue-900/20 text-blue-700 dark:text-blue-300"),children:t.stage})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.closeDate?new Date(t.closeDate).toLocaleDateString():"-"}),e.jsxs("td",{className:"px-4 py-3 text-right font-medium",children:[t.currency," ",t.amount.toLocaleString()]})]},t.id))})]})}),s==="writeback"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"rounded-xl border bg-card p-6 shadow-card",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold",children:"HubSpot Writeback"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically sync attribution data back to HubSpot properties"})]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:(c==null?void 0:c.enabled)||!1,onChange:t=>f.mutate({enabled:t.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx("span",{className:"text-sm font-medium",children:"Enable Writeback"})]})]}),(c==null?void 0:c.enabled)&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 rounded-lg bg-muted/50",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Property Mappings"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"First Touch Channel"}),e.jsx("span",{children:"stratum_first_touch_channel"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Last Touch Channel"}),e.jsx("span",{children:"stratum_last_touch_channel"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Attributed Revenue"}),e.jsx("span",{children:"stratum_attributed_revenue"})]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-muted/50",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Sync Status"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-emerald-500"}),e.jsxs("span",{className:"text-sm",children:["Last synced:"," ",c.lastSyncAt?new Date(c.lastSyncAt).toLocaleString():"Never"]})]}),c.errorCount>0&&e.jsxs("p",{className:"text-sm text-amber-600 mt-2",children:[c.errorCount," sync errors"]})]})]})]})})]})}export{O as default};
//# sourceMappingURL=Integrations-CXiwf83X.js.map
