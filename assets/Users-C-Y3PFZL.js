import{j as e}from"./vendor-ui-B0DL0VNC.js";import{r as s}from"./vendor-react-Dz7uKsMg.js";import{a as Q,u as T,b}from"./vendor-query-BPt-n81V.js";import{c as K,d5 as z,f as J}from"./index-BQex3859.js";import{F as R}from"./UserIcon-LeInSHgb.js";import{F as O}from"./PlusIcon-ByQcgXHI.js";import{F as H}from"./MagnifyingGlassIcon-3MUvqIvj.js";import{F as B}from"./XCircleIcon-Dk49lKz_.js";import{F as G}from"./PencilIcon-BPYwcoex.js";import{F as W}from"./TrashIcon-DR9paOX4.js";import{F as X}from"./EnvelopeIcon-CWLK6IWu.js";import"./vendor-charts-Cj11RBfc.js";import"./vendor-utils-L2YjCnAZ.js";import"./vendor-motion-CR45sdSp.js";const c=()=>{const l=localStorage.getItem("access_token");return{"Content-Type":"application/json",...l?{Authorization:`Bearer ${l}`}:{}}},Y={superadmin:"bg-purple-600 text-purple-100",admin:"bg-blue-600 text-blue-100",manager:"bg-green-600 text-green-100",analyst:"bg-yellow-600 text-yellow-100",viewer:"bg-neutral-600 text-neutral-100"},Z={superadmin:"Super Admin",admin:"Admin",manager:"Manager",analyst:"Analyst",viewer:"Viewer"};function pe(){const l=Q(),[n,_]=s.useState(""),[u,I]=s.useState(""),[U,x]=s.useState(!1),[L,m]=s.useState(!1),[i,p]=s.useState(null),[o,h]=s.useState(""),[N,w]=s.useState("analyst"),[y,f]=s.useState(""),[S,k]=s.useState(""),[F,A]=s.useState(!0),{data:j,isLoading:$}=T({queryKey:["superadmin-users"],queryFn:async()=>{const t=await fetch("/api/v1/users",{headers:c()});if(!t.ok)throw new Error("Failed to fetch users");return t.json()}}),v=b({mutationFn:async t=>{const a=await fetch("/api/v1/users/invite",{method:"POST",headers:c(),body:JSON.stringify(t)});if(!a.ok)throw new Error("Failed to invite user");return a.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["superadmin-users"]}),x(!1),h(""),w("analyst"),f("")}}),g=b({mutationFn:async({userId:t,data:a})=>{const d=await fetch(`/api/v1/users/${t}`,{method:"PATCH",headers:c(),body:JSON.stringify(a)});if(!d.ok)throw new Error("Failed to update user");return d.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["superadmin-users"]}),m(!1),p(null)}}),M=b({mutationFn:async t=>{const a=await fetch(`/api/v1/users/${t}`,{method:"DELETE",headers:c()});if(!a.ok)throw new Error("Failed to delete user");return a.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["superadmin-users"]})}}),r=(j==null?void 0:j.data)||[],C=r.filter(t=>{var E;const a=!n||t.email.toLowerCase().includes(n.toLowerCase())||((E=t.full_name)==null?void 0:E.toLowerCase().includes(n.toLowerCase())),d=!u||t.role===u;return a&&d}),D=()=>{o&&v.mutate({email:o,role:N,full_name:y||void 0})},q=t=>{p(t),k(t.role),A(t.is_active),m(!0)},P=()=>{i&&g.mutate({userId:i.id,data:{role:S,is_active:F}})},V=t=>{confirm(`Are you sure you want to delete ${t.email}?`)&&M.mutate(t.id)};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[e.jsx(R,{className:"w-7 h-7 text-purple-400"}),"User Management"]}),e.jsx("p",{className:"text-neutral-400 mt-1",children:"Manage users and their permissions"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors",children:[e.jsx(O,{className:"w-5 h-5"}),"Invite User"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(H,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-neutral-500"}),e.jsx("input",{type:"text",placeholder:"Search by email or name...",value:n,onChange:t=>_(t.target.value),className:"w-full pl-10 pr-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-purple-500"})]}),e.jsxs("select",{value:u,onChange:t=>I(t.target.value),className:"px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[e.jsx("option",{value:"",children:"All Roles"}),e.jsx("option",{value:"superadmin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"viewer",children:"Viewer"})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-white",children:r.length}),e.jsx("div",{className:"text-sm text-neutral-400",children:"Total Users"})]}),e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:r.filter(t=>t.is_active).length}),e.jsx("div",{className:"text-sm text-neutral-400",children:"Active"})]}),e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-400",children:r.filter(t=>t.role==="superadmin"||t.role==="admin").length}),e.jsx("div",{className:"text-sm text-neutral-400",children:"Admins"})]}),e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:r.filter(t=>t.is_verified).length}),e.jsx("div",{className:"text-sm text-neutral-400",children:"Verified"})]})]}),e.jsx("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl overflow-hidden",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-neutral-800/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-neutral-400 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-neutral-400 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-neutral-400 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-neutral-400 uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"text-left px-6 py-3 text-xs font-medium text-neutral-400 uppercase tracking-wider",children:"Created"}),e.jsx("th",{className:"text-right px-6 py-3 text-xs font-medium text-neutral-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-neutral-800",children:$?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-neutral-500",children:"Loading users..."})}):C.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-neutral-500",children:"No users found"})}):C.map(t=>e.jsxs("tr",{className:"hover:bg-neutral-800/30 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-neutral-700 flex items-center justify-center",children:e.jsx(R,{className:"w-5 h-5 text-neutral-400"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-white font-medium",children:t.full_name||"No name"}),e.jsx("div",{className:"text-sm text-neutral-400",children:t.email})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:K("px-2 py-1 rounded-full text-xs font-medium",Y[t.role]||"bg-neutral-600"),children:[t.role==="superadmin"&&e.jsx(z,{className:"w-3 h-3 inline mr-1"}),Z[t.role]||t.role]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t.is_active?e.jsxs("span",{className:"flex items-center gap-1 text-green-400 text-sm",children:[e.jsx(J,{className:"w-4 h-4"}),"Active"]}):e.jsxs("span",{className:"flex items-center gap-1 text-red-400 text-sm",children:[e.jsx(B,{className:"w-4 h-4"}),"Inactive"]}),t.is_verified&&e.jsx("span",{className:"text-blue-400 text-xs",children:"(Verified)"})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-neutral-400",children:t.last_login_at?new Date(t.last_login_at).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 text-sm text-neutral-400",children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>q(t),className:"p-2 text-neutral-400 hover:text-white hover:bg-neutral-700 rounded-lg transition-colors",title:"Edit user",children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(t),className:"p-2 text-neutral-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",title:"Delete user",children:e.jsx(W,{className:"w-4 h-4"})})]})})]},t.id))})]})}),U&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl p-6 w-full max-w-md",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-purple-400"}),"Invite New User"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-300 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:o,onChange:t=>h(t.target.value),placeholder:"user@example.com",className:"w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-300 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:y,onChange:t=>f(t.target.value),placeholder:"John Doe",className:"w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-300 mb-1",children:"Role *"}),e.jsxs("select",{value:N,onChange:t=>w(t.target.value),className:"w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[e.jsx("option",{value:"viewer",children:"Viewer"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"superadmin",children:"Super Admin"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{x(!1),h(""),f("")},className:"px-4 py-2 text-neutral-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:D,disabled:!o||v.isPending,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg disabled:opacity-50 transition-colors",children:v.isPending?"Inviting...":"Send Invite"})]})]})}),L&&i&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-neutral-900 border border-neutral-800 rounded-xl p-6 w-full max-w-md",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Edit User"}),e.jsx("p",{className:"text-neutral-400 text-sm mb-4",children:i.email}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-neutral-300 mb-1",children:"Role"}),e.jsxs("select",{value:S,onChange:t=>k(t.target.value),className:"w-full px-4 py-2 bg-neutral-800 border border-neutral-700 rounded-lg text-white focus:outline-none focus:border-purple-500",children:[e.jsx("option",{value:"viewer",children:"Viewer"}),e.jsx("option",{value:"analyst",children:"Analyst"}),e.jsx("option",{value:"manager",children:"Manager"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"superadmin",children:"Super Admin"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",id:"editActive",checked:F,onChange:t=>A(t.target.checked),className:"w-4 h-4 rounded border-neutral-600 text-purple-600 focus:ring-purple-500"}),e.jsx("label",{htmlFor:"editActive",className:"text-sm text-neutral-300",children:"Active"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>{m(!1),p(null)},className:"px-4 py-2 text-neutral-400 hover:text-white transition-colors",children:"Cancel"}),e.jsx("button",{onClick:P,disabled:g.isPending,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg disabled:opacity-50 transition-colors",children:g.isPending?"Saving...":"Save Changes"})]})]})})]})}export{pe as default};
//# sourceMappingURL=Users-C-Y3PFZL.js.map
