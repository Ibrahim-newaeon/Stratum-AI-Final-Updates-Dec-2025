# =============================================================================
# Stratum AI - MyPy Configuration
# =============================================================================
# Type checking for Python codebase
# Documentation: https://mypy.readthedocs.io/

[mypy]
# Python version
python_version = 3.11

# Paths
mypy_path = .
files = app/**/*.py

# Strictness settings
strict = false
warn_return_any = false
warn_unused_ignores = true
warn_unused_configs = true
warn_redundant_casts = true
disallow_untyped_defs = false
disallow_incomplete_defs = false
check_untyped_defs = false
no_implicit_optional = false
strict_equality = true

# Error output
show_error_codes = true
show_column_numbers = true
pretty = true

# Incremental mode
incremental = true
cache_dir = .mypy_cache

# Plugins for Pydantic and SQLAlchemy
plugins =
    pydantic.mypy,
    sqlalchemy.ext.mypy.plugin

# Exclude patterns
exclude = (migrations/|alembic/|tests/|__pycache__/|\.venv/|venv/)

# =============================================================================
# Application module overrides
# =============================================================================
# Core modules — stricter checking (business-critical logic)
[mypy-app.core.*]
disallow_incomplete_defs = true
check_untyped_defs = true

[mypy-app.middleware.*]
disallow_incomplete_defs = true
check_untyped_defs = true

[mypy-app.auth.*]
disallow_incomplete_defs = true
check_untyped_defs = true

# SQLAlchemy models — Column[X] vs X type mismatches are expected
[mypy-app.models.*]
ignore_errors = true

[mypy-app.base_models]
ignore_errors = true

[mypy-app.db.*]
ignore_errors = true

# API endpoints — heavy SQLAlchemy ORM usage, Column type noise
[mypy-app.api.v1.endpoints.*]
ignore_errors = true

# Services — mixed SQLAlchemy and business logic
[mypy-app.services.*]
ignore_errors = true

# Workers and tasks — async + SQLAlchemy
[mypy-app.workers.*]
ignore_errors = true

[mypy-app.tasks.*]
ignore_errors = true

# Stratum platform adapters — third-party API integrations
[mypy-app.stratum.*]
ignore_errors = true

# ML modules — numpy/sklearn untyped
[mypy-app.ml.*]
ignore_errors = true

# Autopilot — SQLAlchemy dependent
[mypy-app.autopilot.*]
ignore_errors = true

# Domain logic
[mypy-app.domain.*]
ignore_errors = true

# Analytics
[mypy-app.analytics.*]
ignore_errors = true

# Monitoring — numpy/matplotlib untyped
[mypy-app.monitoring.*]
ignore_errors = true

# Schemas — Pydantic models, handled by plugin
[mypy-app.schemas.*]
ignore_errors = true

# Tenancy
[mypy-app.tenancy.*]
ignore_errors = true

# Quality
[mypy-app.quality.*]
ignore_errors = true

# =============================================================================
# Third-party libraries without type stubs
# =============================================================================
[mypy-celery.*]
ignore_missing_imports = true

[mypy-redis.*]
ignore_missing_imports = true

[mypy-httpx.*]
ignore_missing_imports = true

[mypy-boto3.*]
ignore_missing_imports = true

[mypy-botocore.*]
ignore_missing_imports = true

[mypy-stripe.*]
ignore_missing_imports = true

[mypy-openai.*]
ignore_missing_imports = true

[mypy-anthropic.*]
ignore_missing_imports = true

[mypy-google.*]
ignore_missing_imports = true

[mypy-facebook_business.*]
ignore_missing_imports = true

[mypy-snapchat_marketing_api.*]
ignore_missing_imports = true

[mypy-tiktok_business_api.*]
ignore_missing_imports = true

[mypy-jose.*]
ignore_missing_imports = true

[mypy-passlib.*]
ignore_missing_imports = true

[mypy-bcrypt.*]
ignore_missing_imports = true

[mypy-PIL.*]
ignore_missing_imports = true

[mypy-jinja2.*]
ignore_missing_imports = true

[mypy-prometheus_client.*]
ignore_missing_imports = true

[mypy-sentry_sdk.*]
ignore_missing_imports = true

[mypy-alembic.*]
ignore_missing_imports = true

[mypy-numpy.*]
ignore_missing_imports = true

[mypy-pandas.*]
ignore_missing_imports = true

[mypy-scipy.*]
ignore_missing_imports = true

[mypy-sklearn.*]
ignore_missing_imports = true

[mypy-lightgbm.*]
ignore_missing_imports = true

[mypy-xgboost.*]
ignore_missing_imports = true

[mypy-structlog.*]
ignore_missing_imports = true

[mypy-sse_starlette.*]
ignore_missing_imports = true

[mypy-orjson.*]
ignore_missing_imports = true

[mypy-prometheus_fastapi_instrumentator.*]
ignore_missing_imports = true

[mypy-psutil.*]
ignore_missing_imports = true

[mypy-matplotlib.*]
ignore_missing_imports = true

[mypy-aiosmtplib.*]
ignore_missing_imports = true

# =============================================================================
# Pydantic plugin configuration
# =============================================================================
[pydantic-mypy]
init_forbid_extra = true
init_typed = true
warn_required_dynamic_aliases = true
