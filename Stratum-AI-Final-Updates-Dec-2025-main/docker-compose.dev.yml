# =============================================================================
# Stratum AI - Development Docker Compose (Frontend Only)
# Run with: docker compose -f docker-compose.dev.yml up --build
# =============================================================================

services:
  # ===========================================================================
  # React Frontend (Vite) - Port 5175
  # ===========================================================================
  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
      target: development
    container_name: stratum_frontend_dev
    restart: unless-stopped
    environment:
      - DOCKER_ENV=true
      - VITE_API_BASE_URL=${VITE_API_BASE_URL:-http://localhost:8000}
      - VITE_WS_URL=${VITE_WS_URL:-ws://localhost:8000}
      - VITE_DEFAULT_LOCALE=${VITE_DEFAULT_LOCALE:-en}
      - VITE_SENTRY_DSN=${VITE_SENTRY_DSN:-}
    extra_hosts:
      - "api:host-gateway"
      - "host.docker.internal:host-gateway"
    volumes:
      - ./frontend:/app
      - frontend_node_modules:/app/node_modules
    ports:
      - "5173:5173"
    networks:
      - stratum_dev_network
    command: sh -c "npm install --legacy-peer-deps && npm run dev -- --host 0.0.0.0"
    stdin_open: true
    tty: true

# =============================================================================
# Networks
# =============================================================================
networks:
  stratum_dev_network:
    driver: bridge

# =============================================================================
# Volumes
# =============================================================================
volumes:
  frontend_node_modules:
