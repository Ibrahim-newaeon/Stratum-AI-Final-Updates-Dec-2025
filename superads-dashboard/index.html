<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stratum AI - SuperAds Dashboard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Space+Grotesk:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="shared/styles.css">
</head>
<body>
    <svg style="position: absolute; width: 0; height: 0;">
        <defs>
            <linearGradient id="trustGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#10b981"/>
                <stop offset="100%" style="stop-color:#34d399"/>
            </linearGradient>
            <linearGradient id="primaryGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                <stop offset="0%" style="stop-color:#3b82f6"/>
                <stop offset="50%" style="stop-color:#8b5cf6"/>
                <stop offset="100%" style="stop-color:#ec4899"/>
            </linearGradient>
        </defs>
        <!-- Icon Definitions -->
        <symbol id="icon-chart" viewBox="0 0 24 24"><path d="M3 3v18h18M9 17V9m4 8v-5m4 5V6"/></symbol>
        <symbol id="icon-trending-up" viewBox="0 0 24 24"><path d="M23 6l-9.5 9.5-5-5L1 18"/><path d="M17 6h6v6"/></symbol>
        <symbol id="icon-target" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></symbol>
        <symbol id="icon-signal" viewBox="0 0 24 24"><path d="M2 20h.01M7 20v-4m5 4v-8m5 8V8m5 12V4"/></symbol>
        <symbol id="icon-megaphone" viewBox="0 0 24 24"><path d="M3 11l18-5v12L3 13v-2z"/><path d="M11.6 16.8a3 3 0 11-5.8-1.6"/></symbol>
        <symbol id="icon-cpu" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" rx="2"/><path d="M9 9h6v6H9zM9 1v3M15 1v3M9 20v3M15 20v3M20 9h3M20 14h3M1 9h3M1 14h3"/></symbol>
        <symbol id="icon-dollar" viewBox="0 0 24 24"><path d="M12 1v22M17 5H9.5a3.5 3.5 0 000 7h5a3.5 3.5 0 010 7H6"/></symbol>
        <symbol id="icon-message" viewBox="0 0 24 24"><path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"/></symbol>
        <symbol id="icon-plug" viewBox="0 0 24 24"><path d="M12 22v-5M9 8V2m6 6V2M7 8h10a2 2 0 012 2v4a7 7 0 01-14 0v-4a2 2 0 012-2z"/></symbol>
        <symbol id="icon-users" viewBox="0 0 24 24"><path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/></symbol>
        <symbol id="icon-clipboard" viewBox="0 0 24 24"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/></symbol>
        <symbol id="icon-settings" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/></symbol>
        <symbol id="icon-search" viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/></symbol>
        <symbol id="icon-bell" viewBox="0 0 24 24"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/></symbol>
        <symbol id="icon-refresh" viewBox="0 0 24 24"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></symbol>
        <symbol id="icon-menu" viewBox="0 0 24 24"><path d="M3 12h18M3 6h18M3 18h18"/></symbol>
        <symbol id="icon-moon" viewBox="0 0 24 24"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></symbol>
        <symbol id="icon-sun" viewBox="0 0 24 24"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></symbol>
        <symbol id="icon-alert-circle" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M12 8v4M12 16h.01"/></symbol>
        <symbol id="icon-alert-triangle" viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 001.71 3h16.94a2 2 0 001.71-3L13.71 3.86a2 2 0 00-3.42 0zM12 9v4M12 17h.01"/></symbol>
        <symbol id="icon-check-circle" viewBox="0 0 24 24"><path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><path d="M22 4L12 14.01l-3-3"/></symbol>
        <symbol id="icon-building" viewBox="0 0 24 24"><path d="M6 22V4a2 2 0 012-2h8a2 2 0 012 2v18zM6 12H4a2 2 0 00-2 2v6a2 2 0 002 2h2M18 9h2a2 2 0 012 2v9a2 2 0 01-2 2h-2M10 6h4M10 10h4M10 14h4M10 18h4"/></symbol>
        <symbol id="icon-shield" viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></symbol>
        <symbol id="icon-database" viewBox="0 0 24 24"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></symbol>
        <symbol id="icon-git-branch" viewBox="0 0 24 24"><path d="M6 3v12M18 9a3 3 0 100-6 3 3 0 000 6zM6 21a3 3 0 100-6 3 3 0 000 6zM18 9a9 9 0 01-9 9"/></symbol>
        <symbol id="icon-zap" viewBox="0 0 24 24"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></symbol>
        <symbol id="icon-mail" viewBox="0 0 24 24"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><path d="M22 6l-10 7L2 6"/></symbol>
        <symbol id="icon-lightbulb" viewBox="0 0 24 24"><path d="M9 18h6M10 22h4M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0018 8 6 6 0 006 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 018.91 14"/></symbol>
        <symbol id="icon-more-vertical" viewBox="0 0 24 24"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></symbol>
        <symbol id="icon-log-out" viewBox="0 0 24 24"><path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9"/></symbol>
        <symbol id="icon-arrow-up" viewBox="0 0 24 24"><path d="M12 19V5M5 12l7-7 7 7"/></symbol>
        <symbol id="icon-arrow-down" viewBox="0 0 24 24"><path d="M12 5v14M19 12l-7 7-7-7"/></symbol>
        <symbol id="icon-wifi" viewBox="0 0 24 24"><path d="M5 12.55a11 11 0 0114.08 0M1.42 9a16 16 0 0121.16 0M8.53 16.11a6 6 0 016.95 0M12 20h.01"/></symbol>
        <symbol id="icon-grid" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></symbol>
    </svg>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">S</div>
                    STRATUM AI
                </div>
                <span class="badge superads">SuperAds</span>
            </div>

            <nav class="sidebar-nav" id="sidebarNav">
                <div class="nav-section">
                    <div class="nav-section-title">Core</div>
                    <a href="index.html" class="nav-item active" data-page="overview">
                        <span class="nav-icon"><svg><use href="#icon-chart"/></svg></span>
                        Overview
                    </a>
                    <a href="pages/insights.html" class="nav-item" data-page="insights">
                        <span class="nav-icon"><svg><use href="#icon-trending-up"/></svg></span>
                        Insights
                    </a>
                    <a href="pages/attribution.html" class="nav-item" data-page="attribution">
                        <span class="nav-icon"><svg><use href="#icon-target"/></svg></span>
                        Attribution
                    </a>
                    <a href="pages/signal-quality.html" class="nav-item" data-page="signal-quality">
                        <span class="nav-icon"><svg><use href="#icon-signal"/></svg></span>
                        Signal Quality
                        <span class="nav-badge warning" id="emqAlerts">2</span>
                    </a>
                    <a href="pages/campaigns.html" class="nav-item" data-page="campaigns">
                        <span class="nav-icon"><svg><use href="#icon-megaphone"/></svg></span>
                        Campaigns
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Intelligence</div>
                    <a href="pages/predictions.html" class="nav-item" data-page="predictions">
                        <span class="nav-icon"><svg><use href="#icon-cpu"/></svg></span>
                        ML Predictions
                    </a>
                    <a href="pages/profit.html" class="nav-item" data-page="profit">
                        <span class="nav-icon"><svg><use href="#icon-dollar"/></svg></span>
                        Profit Center
                    </a>
                    <a href="pages/whatsapp.html" class="nav-item" data-page="whatsapp">
                        <span class="nav-icon"><svg><use href="#icon-message"/></svg></span>
                        WhatsApp
                        <span class="nav-badge success" id="waMessages">5</span>
                    </a>
                </div>

                <div class="nav-section">
                    <div class="nav-section-title">Admin</div>
                    <a href="pages/connectors.html" class="nav-item" data-page="connectors">
                        <span class="nav-icon"><svg><use href="#icon-plug"/></svg></span>
                        Connectors
                    </a>
                    <a href="pages/users.html" class="nav-item" data-page="users">
                        <span class="nav-icon"><svg><use href="#icon-users"/></svg></span>
                        Users & RBAC
                    </a>
                    <a href="pages/audit-log.html" class="nav-item" data-page="audit-log">
                        <span class="nav-icon"><svg><use href="#icon-clipboard"/></svg></span>
                        Audit Log
                    </a>
                    <a href="pages/settings.html" class="nav-item" data-page="settings">
                        <span class="nav-icon"><svg><use href="#icon-settings"/></svg></span>
                        Settings
                    </a>
                </div>
            </nav>

            <div class="sidebar-footer">
                <div class="connection-status" id="connectionStatus">
                    <span class="status-indicator connected"></span>
                    <span>API Connected</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">SA</div>
                    <div class="user-details">
                        <div class="user-name" id="userName">Super Admin</div>
                        <div class="user-role" id="userRole">Platform Administrator</div>
                    </div>
                    <button class="user-menu-btn" id="userMenuBtn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><use href="#icon-more-vertical"/></svg>
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <div class="header-left">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-menu"/></svg>
                    </button>
                    <h1 class="page-title">Revenue Intelligence Dashboard</h1>
                    <div class="date-range-picker" id="dateRangePicker">
                        <button class="date-btn active" data-period="7d">7D</button>
                        <button class="date-btn" data-period="30d">30D</button>
                        <button class="date-btn" data-period="90d">90D</button>
                        <button class="date-btn" data-period="custom">Custom</button>
                    </div>
                </div>
                <div class="header-right">
                    <div class="search-box">
                        <span class="search-icon"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-search"/></svg></span>
                        <input type="text" placeholder="Search campaigns, metrics..." id="globalSearch">
                    </div>
                    <div class="theme-toggle" id="themeToggle">
                        <div class="theme-toggle-slider" id="themeIcon"></div>
                    </div>
                    <button class="header-btn" id="notificationsBtn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-bell"/></svg>
                        <span class="notification-dot" id="notificationDot"></span>
                    </button>
                    <button class="header-btn" id="refreshBtn" title="Refresh Data">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-refresh"/></svg>
                    </button>
                </div>
            </header>

            <div class="dashboard" id="dashboardContent">
                <!-- Loading State -->
                <div class="loading-overlay" id="loadingOverlay">
                    <div class="loading-spinner"></div>
                    <p>Loading dashboard data...</p>
                </div>

                <!-- Trust Score Banner -->
                <div class="trust-banner animate-fade-up" id="trustBanner">
                    <div class="trust-content">
                        <div class="trust-score-ring">
                            <svg width="80" height="80" viewBox="0 0 80 80">
                                <circle class="bg" cx="40" cy="40" r="36"/>
                                <circle class="progress" id="trustProgress" cx="40" cy="40" r="36"/>
                            </svg>
                            <div class="trust-score-value" id="trustScoreValue">--</div>
                        </div>
                        <div class="trust-info">
                            <h3>Data Trust Score</h3>
                            <p id="trustMessage">Loading trust metrics...</p>
                        </div>
                    </div>
                    <div class="trust-drivers" id="trustDrivers">
                        <div class="trust-driver">
                            <div class="trust-driver-value" id="eventMatchRate">--%</div>
                            <div class="trust-driver-label">Event Match</div>
                        </div>
                        <div class="trust-driver">
                            <div class="trust-driver-value" id="pixelCoverage">--%</div>
                            <div class="trust-driver-label">Pixel Coverage</div>
                        </div>
                        <div class="trust-driver">
                            <div class="trust-driver-value" id="dataFreshness">--h</div>
                            <div class="trust-driver-label">Data Freshness</div>
                        </div>
                        <div class="trust-driver">
                            <div class="trust-driver-value" id="attrAccuracy">--%</div>
                            <div class="trust-driver-label">Attribution</div>
                        </div>
                    </div>
                    <a href="pages/signal-quality.html" class="trust-action-btn">View Details</a>
                </div>

                <!-- Metrics Grid -->
                <div class="metrics-grid" id="metricsGrid">
                    <div class="metric-card animate-fade-up stagger-1" style="--metric-color: var(--gradient-success)" data-metric="revenue">
                        <div class="metric-header">
                            <div class="metric-icon green"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-dollar"/></svg></div>
                            <div class="metric-trend" id="revenueTrend">
                                <span class="trend-arrow"></span>
                                <span class="trend-value">--%</span>
                            </div>
                        </div>
                        <div class="metric-value">$<span id="totalRevenue">--</span></div>
                        <div class="metric-label">Total Revenue</div>
                        <div class="metric-sparkline" id="revenueSparkline"></div>
                    </div>

                    <div class="metric-card animate-fade-up stagger-2" style="--metric-color: var(--gradient-primary)" data-metric="roas">
                        <div class="metric-header">
                            <div class="metric-icon purple"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-trending-up"/></svg></div>
                            <div class="metric-trend" id="roasTrend">
                                <span class="trend-arrow"></span>
                                <span class="trend-value">--</span>
                            </div>
                        </div>
                        <div class="metric-value"><span id="profitRoas">--</span>x</div>
                        <div class="metric-label">Profit ROAS</div>
                        <div class="metric-sparkline" id="roasSparkline"></div>
                    </div>

                    <div class="metric-card animate-fade-up stagger-3" style="--metric-color: linear-gradient(135deg, #06b6d4, #3b82f6)" data-metric="conversions">
                        <div class="metric-header">
                            <div class="metric-icon cyan"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-target"/></svg></div>
                            <div class="metric-trend" id="conversionsTrend">
                                <span class="trend-arrow"></span>
                                <span class="trend-value">--%</span>
                            </div>
                        </div>
                        <div class="metric-value"><span id="totalConversions">--</span></div>
                        <div class="metric-label">Conversions</div>
                        <div class="metric-sparkline" id="conversionsSparkline"></div>
                    </div>

                    <div class="metric-card animate-fade-up stagger-4" style="--metric-color: var(--gradient-warning)" data-metric="cpa">
                        <div class="metric-header">
                            <div class="metric-icon orange"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-dollar"/></svg></div>
                            <div class="metric-trend" id="cpaTrend">
                                <span class="trend-arrow"></span>
                                <span class="trend-value">--%</span>
                            </div>
                        </div>
                        <div class="metric-value">$<span id="avgCpa">--</span></div>
                        <div class="metric-label">Avg. CPA</div>
                        <div class="metric-sparkline" id="cpaSparkline"></div>
                    </div>
                </div>

                <!-- Main Grid -->
                <div class="grid-2">
                    <!-- Platform Connections -->
                    <div class="panel animate-fade-up stagger-1" id="platformPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-plug"/></svg></span>
                                Platform Connections
                            </div>
                            <span class="panel-badge live">Live</span>
                        </div>
                        <div class="panel-content">
                            <div class="platform-list" id="platformList"></div>
                            <a href="pages/connectors.html" class="panel-action">Manage Connectors</a>
                        </div>
                    </div>

                    <!-- EMQ Drivers -->
                    <div class="panel animate-fade-up stagger-2" id="emqPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-signal"/></svg></span>
                                Signal Quality (EMQ)
                            </div>
                            <span class="panel-badge" id="emqScoreBadge">Score: --</span>
                        </div>
                        <div class="panel-content">
                            <div class="emq-drivers" id="emqDrivers"></div>
                            <a href="pages/signal-quality.html" class="panel-action">View EMQ Details</a>
                        </div>
                    </div>
                </div>

                <!-- Second Row -->
                <div class="grid-3">
                    <!-- Attribution -->
                    <div class="panel animate-fade-up stagger-3" id="attributionPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-target"/></svg></span>
                                Multi-Touch Attribution
                            </div>
                        </div>
                        <div class="panel-content">
                            <div class="attribution-channels" id="attributionChannels"></div>
                            <div class="attribution-legend">
                                <div class="legend-item">
                                    <div class="legend-color" style="background: var(--accent-blue);"></div>
                                    First Touch
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: var(--accent-purple);"></div>
                                    Assist
                                </div>
                                <div class="legend-item">
                                    <div class="legend-color" style="background: var(--accent-green);"></div>
                                    Last Touch
                                </div>
                            </div>
                            <a href="pages/attribution.html" class="panel-action">View Full Attribution</a>
                        </div>
                    </div>

                    <!-- ML Predictions -->
                    <div class="panel animate-fade-up stagger-4" id="predictionsPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-cpu"/></svg></span>
                                AI Predictions
                            </div>
                        </div>
                        <div class="panel-content">
                            <div class="prediction-cards" id="predictionCards"></div>
                            <div class="recommendation-box" id="recommendationBox">
                                <div class="recommendation-icon"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-lightbulb"/></svg></div>
                                <div class="recommendation-text">Loading recommendations...</div>
                            </div>
                            <a href="pages/predictions.html" class="panel-action">View All Predictions</a>
                        </div>
                    </div>

                    <!-- Alerts -->
                    <div class="panel animate-fade-up stagger-5" id="alertsPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-bell"/></svg></span>
                                Active Alerts
                            </div>
                            <span class="panel-badge" id="alertCount" style="background: rgba(239, 68, 68, 0.15); color: var(--accent-red);">--</span>
                        </div>
                        <div class="panel-content">
                            <div class="alerts-list" id="alertsList"></div>
                        </div>
                    </div>
                </div>

                <!-- Third Row -->
                <div class="grid-2">
                    <!-- Profit Center -->
                    <div class="panel animate-fade-up stagger-5" id="profitPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-dollar"/></svg></span>
                                Profit Intelligence
                            </div>
                        </div>
                        <div class="panel-content">
                            <div class="profit-summary" id="profitSummary">
                                <div class="profit-item">
                                    <div class="profit-item-value positive" id="netProfit">$--</div>
                                    <div class="profit-item-label">Net Profit (MTD)</div>
                                </div>
                                <div class="profit-item">
                                    <div class="profit-item-value" id="profitMargin">--%</div>
                                    <div class="profit-item-label">Profit Margin</div>
                                </div>
                            </div>
                            <div class="profit-breakdown" id="profitBreakdown"></div>
                            <a href="pages/profit.html" class="panel-action">View Full P&L</a>
                        </div>
                    </div>

                    <!-- WhatsApp -->
                    <div class="panel animate-fade-up stagger-6" id="whatsappPanel">
                        <div class="panel-header">
                            <div class="panel-title">
                                <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-message"/></svg></span>
                                WhatsApp Alerts
                            </div>
                            <span class="panel-badge success">Active</span>
                        </div>
                        <div class="panel-content">
                            <div class="whatsapp-stats" id="whatsappStats">
                                <div class="wa-stat">
                                    <div class="wa-stat-value" id="waContacts">--</div>
                                    <div class="wa-stat-label">Contacts</div>
                                </div>
                                <div class="wa-stat">
                                    <div class="wa-stat-value" id="waSent">--</div>
                                    <div class="wa-stat-label">Sent (MTD)</div>
                                </div>
                                <div class="wa-stat">
                                    <div class="wa-stat-value" id="waDelivered">--%</div>
                                    <div class="wa-stat-label">Delivered</div>
                                </div>
                            </div>
                            <div class="recent-messages" id="recentMessages"></div>
                            <a href="pages/whatsapp.html" class="panel-action">Manage WhatsApp</a>
                        </div>
                    </div>
                </div>

                <!-- Feature Grid -->
                <div class="panel animate-fade-up" style="margin-top: 1.5rem;" id="featuresPanel">
                    <div class="panel-header">
                        <div class="panel-title">
                            <span class="panel-title-icon"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-grid"/></svg></span>
                            Platform Capabilities
                        </div>
                        <span class="platform-stats" id="platformStats">Loading...</span>
                    </div>
                    <div class="panel-content">
                        <div class="feature-grid" id="featureGrid"></div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Notification Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- User Menu Dropdown -->
    <div class="user-menu-dropdown" id="userMenuDropdown">
        <a href="pages/settings.html" class="menu-item"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;"><use href="#icon-settings"/></svg> Settings</a>
        <a href="#" class="menu-item" id="logoutBtn"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin-right: 8px;"><use href="#icon-log-out"/></svg> Logout</a>
    </div>

    <script src="shared/api.js"></script>
    <script src="shared/utils.js"></script>
    <script>
        // =====================================================================
        // Dashboard State
        // =====================================================================
        const state = {
            period: '30d',
            isLoading: true,
            data: {},
            refreshInterval: null
        };

        // Icon SVG templates
        const icons = {
            building: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-building"/></svg>',
            shield: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-shield"/></svg>',
            database: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-database"/></svg>',
            target: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-target"/></svg>',
            trendingUp: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-trending-up"/></svg>',
            dollar: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-dollar"/></svg>',
            zap: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-zap"/></svg>',
            clipboard: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-clipboard"/></svg>',
            wifi: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-wifi"/></svg>',
            cpu: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-cpu"/></svg>',
            message: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-message"/></svg>',
            mail: '<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-mail"/></svg>',
            alertCircle: '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-alert-circle"/></svg>',
            alertTriangle: '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-alert-triangle"/></svg>',
            chart: '<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-chart"/></svg>',
            lightbulb: '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-lightbulb"/></svg>'
        };

        // =====================================================================
        // Initialize Dashboard
        // =====================================================================
        document.addEventListener('DOMContentLoaded', async () => {
            initTheme();
            initEventListeners();
            await loadDashboardData();
            startAutoRefresh();
        });

        // =====================================================================
        // Theme Management
        // =====================================================================
        function initTheme() {
            const savedTheme = localStorage.getItem('stratum-theme') || 'dark';
            document.documentElement.setAttribute('data-theme', savedTheme);
            updateThemeIcon(savedTheme);
        }

        function updateThemeIcon(theme) {
            const iconEl = document.getElementById('themeIcon');
            if (theme === 'dark') {
                iconEl.innerHTML = '<svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><use href="#icon-moon"/></svg>';
            } else {
                iconEl.innerHTML = '<svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><use href="#icon-sun"/></svg>';
            }
        }

        // =====================================================================
        // Event Listeners
        // =====================================================================
        function initEventListeners() {
            // Theme toggle
            document.getElementById('themeToggle').addEventListener('click', () => {
                const html = document.documentElement;
                const currentTheme = html.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('stratum-theme', newTheme);
                updateThemeIcon(newTheme);
            });

            // Date range picker
            document.querySelectorAll('.date-btn').forEach(btn => {
                btn.addEventListener('click', async (e) => {
                    document.querySelectorAll('.date-btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    state.period = e.target.dataset.period;
                    await loadDashboardData();
                });
            });

            // Refresh button
            document.getElementById('refreshBtn').addEventListener('click', async () => {
                await loadDashboardData(true);
                showToast('Dashboard refreshed', 'success');
            });

            // Mobile menu
            document.getElementById('mobileMenuBtn')?.addEventListener('click', () => {
                document.getElementById('sidebar').classList.toggle('open');
            });

            // User menu
            document.getElementById('userMenuBtn').addEventListener('click', (e) => {
                e.stopPropagation();
                document.getElementById('userMenuDropdown').classList.toggle('show');
            });

            document.addEventListener('click', () => {
                document.getElementById('userMenuDropdown').classList.remove('show');
            });

            // Global search
            document.getElementById('globalSearch').addEventListener('input', debounce((e) => {
                const query = e.target.value;
                if (query.length > 2) {
                    console.log('Searching:', query);
                }
            }, 300));

            // Metric cards click navigation
            document.querySelectorAll('.metric-card').forEach(card => {
                card.addEventListener('click', () => {
                    const metric = card.dataset.metric;
                    window.location.href = `pages/insights.html?metric=${metric}`;
                });
            });

            // Feature items click navigation
            document.getElementById('featureGrid').addEventListener('click', (e) => {
                const featureItem = e.target.closest('.feature-item');
                if (featureItem) {
                    const page = featureItem.dataset.page;
                    if (page) {
                        window.location.href = page;
                    }
                }
            });
        }

        // =====================================================================
        // Data Loading
        // =====================================================================
        async function loadDashboardData(forceRefresh = false) {
            showLoading(true);

            try {
                const [kpis, platforms, emq, predictions, alerts, profit, whatsapp] = await Promise.all([
                    API.getKPIs(state.period),
                    API.getPlatformStatus(),
                    API.getEMQScore(),
                    API.getPredictions(),
                    API.getAlerts(),
                    API.getProfitSummary(state.period),
                    API.getWhatsAppStats()
                ]);

                state.data = { kpis, platforms, emq, predictions, alerts, profit, whatsapp };

                renderKPIs(kpis);
                renderTrustBanner(emq);
                renderPlatforms(platforms);
                renderEMQ(emq);
                renderAttribution();
                renderPredictions(predictions);
                renderAlerts(alerts);
                renderProfit(profit);
                renderWhatsApp(whatsapp);
                renderFeatures();

                updateConnectionStatus(true);
            } catch (error) {
                console.error('Failed to load dashboard data:', error);
                updateConnectionStatus(false);
                showToast('Failed to load data. Using cached values.', 'error');
                renderMockData();
            } finally {
                showLoading(false);
            }
        }

        // =====================================================================
        // Render Functions
        // =====================================================================
        function renderKPIs(data) {
            const kpis = data?.data || getMockKPIs();

            const revenue = kpis.find(k => k.metric === 'revenue') || {};
            const roas = kpis.find(k => k.metric === 'roas') || {};
            const conversions = kpis.find(k => k.metric === 'conversions') || {};
            const spend = kpis.find(k => k.metric === 'spend') || {};

            animateValue('totalRevenue', formatCurrency(revenue.value || 2400000, true));
            animateValue('profitRoas', (roas.value || 4.2).toFixed(1));
            animateValue('totalConversions', formatNumber(conversions.value || 8547));

            const cpa = spend.value && conversions.value ? (spend.value / conversions.value) : 28.50;
            animateValue('avgCpa', cpa.toFixed(2));

            updateTrend('revenueTrend', revenue.change_percent || 23);
            updateTrend('roasTrend', roas.change_percent || 0.4, 'x');
            updateTrend('conversionsTrend', conversions.change_percent || 12);
            updateTrend('cpaTrend', -8, '%', true);
        }

        function renderTrustBanner(emq) {
            const score = emq?.data?.score || 87;
            const drivers = emq?.data?.drivers || getMockEMQDrivers();

            const trustProgress = document.getElementById('trustProgress');
            const circumference = 226;
            const offset = circumference - (score / 100) * circumference;

            setTimeout(() => {
                trustProgress.style.strokeDashoffset = offset;
                animateValue('trustScoreValue', score, '', 0, true);
            }, 300);

            const trustMessage = document.getElementById('trustMessage');
            if (score >= 80) {
                trustMessage.textContent = 'Excellent data quality - confident decision-making enabled';
            } else if (score >= 60) {
                trustMessage.textContent = 'Good data quality - some optimization opportunities';
            } else {
                trustMessage.textContent = 'Data quality needs attention - review EMQ drivers';
            }

            const eventMatch = drivers.find(d => d.name === 'Event Match Rate')?.value || 92;
            const pixelCov = drivers.find(d => d.name === 'Pixel Coverage')?.value || 88;
            const freshness = drivers.find(d => d.name === 'Data Freshness')?.value || 95;
            const accuracy = drivers.find(d => d.name === 'Attribution Accuracy')?.value || 85;

            setTimeout(() => {
                document.getElementById('eventMatchRate').textContent = eventMatch + '%';
                document.getElementById('eventMatchRate').className = 'trust-driver-value ' + getStatusClass(eventMatch);

                document.getElementById('pixelCoverage').textContent = pixelCov + '%';
                document.getElementById('pixelCoverage').className = 'trust-driver-value ' + getStatusClass(pixelCov);

                document.getElementById('dataFreshness').textContent = freshness >= 90 ? '2h' : freshness >= 70 ? '6h' : '24h';
                document.getElementById('dataFreshness').className = 'trust-driver-value ' + getStatusClass(freshness);

                document.getElementById('attrAccuracy').textContent = accuracy + '%';
                document.getElementById('attrAccuracy').className = 'trust-driver-value ' + getStatusClass(accuracy);
            }, 500);
        }

        function renderPlatforms(data) {
            const platforms = data?.data || getMockPlatforms();
            const container = document.getElementById('platformList');

            container.innerHTML = platforms.map(p => `
                <div class="platform-item" onclick="window.location.href='pages/connectors.html?platform=${p.id}'">
                    <div class="platform-icon ${p.id}">${p.icon}</div>
                    <div class="platform-info">
                        <div class="platform-name">${p.name}</div>
                        <div class="platform-sync">${p.lastSync}</div>
                    </div>
                    <div class="platform-status">
                        <span class="status-dot ${p.status}"></span>
                        <span class="status-text ${p.status}">${capitalize(p.status)}</span>
                    </div>
                </div>
            `).join('');
        }

        function renderEMQ(data) {
            const emqData = data?.data || getMockEMQ();
            const drivers = emqData.drivers || getMockEMQDrivers();

            document.getElementById('emqScoreBadge').textContent = `Score: ${emqData.score || 87}`;
            document.getElementById('emqScoreBadge').style.background = 'rgba(16, 185, 129, 0.15)';
            document.getElementById('emqScoreBadge').style.color = 'var(--accent-green)';

            const container = document.getElementById('emqDrivers');
            container.innerHTML = drivers.map(d => `
                <div class="emq-driver">
                    <div class="emq-driver-info">
                        <div class="emq-driver-name">${d.name}</div>
                        <div class="emq-driver-weight">Weight: ${d.weight}%</div>
                    </div>
                    <div class="emq-driver-bar">
                        <div class="emq-driver-fill ${getStatusClass(d.value)}" style="width: ${d.value}%"></div>
                    </div>
                    <div class="emq-driver-value">${d.value}%</div>
                </div>
            `).join('');
        }

        function renderAttribution() {
            const channels = getMockAttribution();
            const container = document.getElementById('attributionChannels');

            container.innerHTML = channels.map(c => `
                <div class="attribution-channel" onclick="window.location.href='pages/attribution.html?channel=${c.name.toLowerCase()}'">
                    <div class="channel-name">${c.name}</div>
                    <div class="channel-bar-container">
                        <div class="channel-bar-segment segment-first" style="width: ${c.first}%">${c.first}%</div>
                        <div class="channel-bar-segment segment-assist" style="width: ${c.assist}%">${c.assist}%</div>
                        <div class="channel-bar-segment segment-last" style="width: ${c.last}%">${c.last}%</div>
                    </div>
                    <div class="channel-value">${c.value}</div>
                </div>
            `).join('');
        }

        function renderPredictions(data) {
            const container = document.getElementById('predictionCards');

            const cards = [
                { label: 'ROAS Forecast', value: '4.5x', confidence: 'medium', r2: 0.36 },
                { label: 'Conv. Prediction', value: '9,240', confidence: 'high', r2: 0.57 },
                { label: 'Budget Impact', value: '+18%', confidence: 'medium', r2: 0.36 }
            ];

            container.innerHTML = cards.map(c => `
                <div class="prediction-card" onclick="window.location.href='pages/predictions.html'">
                    <div class="prediction-model">${c.label}</div>
                    <div class="prediction-value" style="color: var(--accent-${c.confidence === 'high' ? 'green' : c.confidence === 'medium' ? 'blue' : 'orange'})">${c.value}</div>
                    <span class="prediction-confidence ${c.confidence}">RÂ² ${c.r2}</span>
                </div>
            `).join('');

            const recBox = document.getElementById('recommendationBox');
            recBox.innerHTML = `
                <div class="recommendation-icon">${icons.lightbulb}</div>
                <div class="recommendation-text">
                    Shift $15K from Snapchat to Meta for projected +12% ROAS improvement
                </div>
            `;
        }

        function renderAlerts(data) {
            const alerts = data?.data?.alerts || getMockAlerts();
            const container = document.getElementById('alertsList');

            document.getElementById('alertCount').textContent = alerts.length;

            const alertIcons = {
                critical: icons.alertCircle,
                warning: icons.alertTriangle,
                info: icons.chart
            };

            container.innerHTML = alerts.slice(0, 3).map(a => `
                <div class="alert-item ${a.severity}">
                    <span class="alert-icon">${alertIcons[a.severity]}</span>
                    <div class="alert-content">
                        <div class="alert-title">${a.title}</div>
                        <div class="alert-desc">${a.description}</div>
                    </div>
                    <div class="alert-time">${a.time}</div>
                </div>
            `).join('');
        }

        function renderProfit(data) {
            const profit = data?.data || getMockProfit();

            document.getElementById('netProfit').textContent = formatCurrency(profit.netProfit || 486972);
            document.getElementById('profitMargin').textContent = (profit.margin || 31.2) + '%';

            const breakdown = document.getElementById('profitBreakdown');
            breakdown.innerHTML = `
                <div class="profit-row">
                    <span>Gross Revenue</span>
                    <span>${formatCurrency(profit.revenue || 2400000)}</span>
                </div>
                <div class="profit-row">
                    <span>COGS (${profit.cogsPercent || 42}%)</span>
                    <span style="color: var(--accent-red);">-${formatCurrency(profit.cogs || 1008000)}</span>
                </div>
                <div class="profit-row">
                    <span>Ad Spend</span>
                    <span style="color: var(--accent-red);">-${formatCurrency(profit.adSpend || 571428)}</span>
                </div>
                <div class="profit-row">
                    <span>Overhead (${profit.overheadPercent || 14}%)</span>
                    <span style="color: var(--accent-red);">-${formatCurrency(profit.overhead || 333600)}</span>
                </div>
                <div class="profit-row total">
                    <span>True Profit</span>
                    <span>${formatCurrency(profit.netProfit || 486972)}</span>
                </div>
            `;
        }

        function renderWhatsApp(data) {
            const wa = data?.data || getMockWhatsApp();

            document.getElementById('waContacts').textContent = formatNumber(wa.contacts || 247);
            document.getElementById('waSent').textContent = formatNumber(wa.sent || 1842);
            document.getElementById('waDelivered').textContent = (wa.deliveredRate || 94) + '%';

            const messages = wa.recentMessages || [
                { status: 'delivered', text: 'Daily digest sent to Marketing Team', time: '9:00 AM' },
                { status: 'delivered', text: 'ROAS alert sent to John Doe', time: '8:45 AM' },
                { status: 'sent', text: 'Budget alert queued', time: '8:30 AM' }
            ];

            document.getElementById('recentMessages').innerHTML = messages.map(m => `
                <div class="message-item">
                    <span class="message-status ${m.status}"></span>
                    <span style="flex: 1;">${m.text}</span>
                    <span style="font-size: 0.7rem; color: var(--text-muted);">${m.time}</span>
                </div>
            `).join('');
        }

        function renderFeatures() {
            const features = [
                { icon: icons.building, name: 'Multi-Tenancy', status: 'active', page: 'pages/users.html' },
                { icon: icons.shield, name: 'RBAC', status: 'active', page: 'pages/users.html' },
                { icon: icons.database, name: 'Data Warehouse', status: 'active', page: 'pages/insights.html' },
                { icon: icons.target, name: 'Markov Attribution', status: 'active', page: 'pages/attribution.html' },
                { icon: icons.trendingUp, name: 'Shapley Values', status: 'active', page: 'pages/attribution.html' },
                { icon: icons.dollar, name: 'COGS Tracking', status: 'active', page: 'pages/profit.html' },
                { icon: icons.zap, name: 'Auto Actions', status: 'active', page: 'pages/settings.html' },
                { icon: icons.clipboard, name: 'Audit Logging', status: 'active', page: 'pages/audit-log.html' },
                { icon: icons.wifi, name: 'CAPI Integration', status: 'partial', page: 'pages/connectors.html' },
                { icon: icons.cpu, name: 'ML Predictions', status: 'active', page: 'pages/predictions.html' },
                { icon: icons.message, name: 'WhatsApp', status: 'active', page: 'pages/whatsapp.html' },
                { icon: icons.mail, name: 'Scheduled Reports', status: 'active', page: 'pages/settings.html' }
            ];

            document.getElementById('platformStats').textContent = '67+ Tables | 310+ Endpoints | 48 Pages';

            document.getElementById('featureGrid').innerHTML = features.map(f => `
                <div class="feature-item" data-page="${f.page}">
                    <div class="feature-icon">${f.icon}</div>
                    <div class="feature-name">${f.name}</div>
                    <span class="feature-status ${f.status}">${capitalize(f.status)}</span>
                </div>
            `).join('');
        }

        // =====================================================================
        // Helper Functions
        // =====================================================================
        function showLoading(show) {
            document.getElementById('loadingOverlay').style.display = show ? 'flex' : 'none';
            state.isLoading = show;
        }

        function updateConnectionStatus(connected) {
            const indicator = document.querySelector('#connectionStatus .status-indicator');
            const text = document.querySelector('#connectionStatus span:last-child');

            if (connected) {
                indicator.className = 'status-indicator connected';
                text.textContent = 'API Connected';
            } else {
                indicator.className = 'status-indicator error';
                text.textContent = 'API Offline';
            }
        }

        function updateTrend(elementId, value, suffix = '%', inverse = false) {
            const el = document.getElementById(elementId);
            const isPositive = inverse ? value < 0 : value > 0;

            el.querySelector('.trend-arrow').innerHTML = isPositive
                ? '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><use href="#icon-arrow-up"/></svg>'
                : '<svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><use href="#icon-arrow-down"/></svg>';
            el.querySelector('.trend-value').textContent = Math.abs(value).toFixed(1) + suffix;
            el.className = 'metric-trend ' + (isPositive ? 'up' : 'down');
        }

        function getStatusClass(value) {
            if (value >= 80) return 'good';
            if (value >= 60) return 'warning';
            return 'danger';
        }

        function startAutoRefresh() {
            state.refreshInterval = setInterval(() => {
                loadDashboardData();
            }, 5 * 60 * 1000);
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;

            const iconMap = {
                success: '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-check-circle"/></svg>',
                error: '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-alert-circle"/></svg>',
                info: '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-alert-circle"/></svg>'
            };

            toast.innerHTML = `
                <span class="toast-icon">${iconMap[type]}</span>
                <span class="toast-message">${message}</span>
            `;
            container.appendChild(toast);

            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        function renderMockData() {
            renderKPIs(null);
            renderTrustBanner(null);
            renderPlatforms(null);
            renderEMQ(null);
            renderAttribution();
            renderPredictions(null);
            renderAlerts(null);
            renderProfit(null);
            renderWhatsApp(null);
            renderFeatures();
        }

        // =====================================================================
        // Mock Data Functions
        // =====================================================================
        function getMockKPIs() {
            // Return different data based on selected period
            const periodData = {
                '7d': [
                    { metric: 'revenue', value: 584000, change_percent: 18 },
                    { metric: 'roas', value: 3.8, change_percent: 0.3 },
                    { metric: 'conversions', value: 2124, change_percent: 9 },
                    { metric: 'spend', value: 153684, change_percent: 12 }
                ],
                '30d': [
                    { metric: 'revenue', value: 2400000, change_percent: 23 },
                    { metric: 'roas', value: 4.2, change_percent: 0.4 },
                    { metric: 'conversions', value: 8547, change_percent: 12 },
                    { metric: 'spend', value: 571428, change_percent: 15 }
                ],
                '90d': [
                    { metric: 'revenue', value: 7850000, change_percent: 31 },
                    { metric: 'roas', value: 4.5, change_percent: 0.6 },
                    { metric: 'conversions', value: 27420, change_percent: 19 },
                    { metric: 'spend', value: 1744444, change_percent: 22 }
                ],
                'custom': [
                    { metric: 'revenue', value: 1200000, change_percent: 15 },
                    { metric: 'roas', value: 4.0, change_percent: 0.2 },
                    { metric: 'conversions', value: 4280, change_percent: 8 },
                    { metric: 'spend', value: 300000, change_percent: 10 }
                ]
            };
            return periodData[state.period] || periodData['30d'];
        }

        function getMockPlatforms() {
            return [
                { id: 'meta', name: 'Meta Ads', icon: 'META', status: 'connected', lastSync: 'Last sync: 2 min ago' },
                { id: 'google', name: 'Google Ads', icon: 'G', status: 'connected', lastSync: 'Last sync: 5 min ago' },
                { id: 'tiktok', name: 'TikTok Ads', icon: 'TT', status: 'connected', lastSync: 'Last sync: 8 min ago' },
                { id: 'snap', name: 'Snapchat', icon: 'SC', status: 'partial', lastSync: 'Missing: Conversion API' },
                { id: 'linkedin', name: 'LinkedIn', icon: 'in', status: 'connected', lastSync: 'Last sync: 15 min ago' }
            ];
        }

        function getMockEMQ() {
            return { score: 87, drivers: getMockEMQDrivers() };
        }

        function getMockEMQDrivers() {
            return [
                { name: 'Event Match Rate', value: 92, weight: 30 },
                { name: 'Pixel Coverage', value: 88, weight: 25 },
                { name: 'Conversion Latency', value: 74, weight: 20 },
                { name: 'Attribution Accuracy', value: 85, weight: 15 },
                { name: 'Data Freshness', value: 95, weight: 10 }
            ];
        }

        function getMockAttribution() {
            return [
                { name: 'Meta', first: 25, assist: 35, last: 40, value: '$890K' },
                { name: 'Google', first: 30, assist: 25, last: 45, value: '$720K' },
                { name: 'TikTok', first: 40, assist: 35, last: 25, value: '$450K' },
                { name: 'Snapchat', first: 35, assist: 40, last: 25, value: '$210K' }
            ];
        }

        function getMockPredictions() {
            return {
                portfolio: { portfolio_roas: 4.5 },
                campaigns: []
            };
        }

        function getMockAlerts() {
            return [
                { severity: 'critical', title: 'ROAS Drop Detected', description: 'Campaign "Summer Sale" down 32%', time: '2m ago' },
                { severity: 'warning', title: 'Budget Pacing Alert', description: 'Meta overspending by 15%', time: '15m ago' },
                { severity: 'info', title: 'EMQ Score Improved', description: 'Google Ads EMQ now at 92', time: '1h ago' }
            ];
        }

        function getMockProfit() {
            return {
                netProfit: 486972,
                margin: 31.2,
                revenue: 2400000,
                cogs: 1008000,
                cogsPercent: 42,
                adSpend: 571428,
                overhead: 333600,
                overheadPercent: 14
            };
        }

        function getMockWhatsApp() {
            return {
                contacts: 247,
                sent: 1842,
                deliveredRate: 94,
                recentMessages: [
                    { status: 'delivered', text: 'Daily digest sent to Marketing Team', time: '9:00 AM' },
                    { status: 'delivered', text: 'ROAS alert sent to John Doe', time: '8:45 AM' },
                    { status: 'sent', text: 'Budget alert queued', time: '8:30 AM' }
                ]
            };
        }
    </script>
</body>
</html>
